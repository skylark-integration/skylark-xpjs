{"version":3,"sources":["utils/serviceUtils/storageUtil.tsx","utils/fileUtils/xmlUtil.tsx","utils/readUtils/linkUtil.tsx","model/Note.ts","components/popups/popupNote/component.tsx","components/popups/popupNote/index.tsx","components/colorOption/component.tsx","components/colorOption/index.tsx","constants/popupList.tsx","components/popups/popupOption/component.tsx","components/popups/popupOption/index.tsx","constants/translationList.tsx","components/popups/popupTrans/component.tsx","components/popups/popupTrans/index.tsx","components/popups/popupMenu/component.tsx","components/popups/popupMenu/index.tsx","components/dialogs/deletePopup/component.tsx","components/dialogs/deletePopup/index.tsx","utils/serviceUtils/langUtil.tsx","utils/readUtils/recordLocation.tsx","utils/fileUtils/bookUtil.tsx","utils/serviceUtils/mouseEvent.tsx","model/Book.ts","containers/htmlViewer/component.tsx","constants/mimetype.tsx","utils/readUtils/recordRecent.tsx","utils/fileUtils/rtfUtil.tsx","components/background/component.tsx","components/background/index.tsx","components/imageViewer/component.tsx","components/imageViewer/index.tsx","utils/serviceUtils/docUtil.tsx","store/actions/manager.tsx","store/actions/book.tsx","store/actions/backupPage.tsx","store/actions/progressPanel.tsx","store/actions/reader.tsx","store/actions/sidebar.tsx","store/actions/viewArea.tsx","utils/readUtils/addTrash.tsx","utils/readUtils/sortUtil.tsx","utils/serviceUtils/urlUtil.tsx","utils/syncUtils/common.tsx","i18n.tsx","store/reducers/book.tsx","store/reducers/manager.tsx","store/reducers/progressPanel.tsx","store/reducers/reader.tsx","store/reducers/viewArea.tsx","store/reducers/sidebar.tsx","store/reducers/backupPage.tsx","store/index.tsx","constants/sideMenu.tsx","containers/sidebar/component.tsx","containers/sidebar/index.tsx","utils/serviceUtils/searchUtil.tsx","components/searchBox/component.tsx","components/searchBox/index.tsx","utils/fileUtils/md5Util.tsx","utils/fileUtils/fileUtil.tsx","components/importLocal/component.tsx","components/importLocal/index.tsx","components/dialogs/updateDialog/component.tsx","components/dialogs/updateDialog/index.tsx","utils/syncUtils/backupUtil.tsx","containers/header/component.tsx","containers/header/index.tsx","utils/readUtils/deleteUtil.tsx","utils/readUtils/shelfUtil.tsx","utils/readUtils/addFavorite.tsx","components/dialogs/deleteDialog/component.tsx","components/dialogs/deleteDialog/index.tsx","components/dialogs/editDialog/component.tsx","components/dialogs/editDialog/index.tsx","components/dialogs/addDialog/component.tsx","components/dialogs/addDialog/index.tsx","components/dialogs/sortDialog/component.tsx","components/dialogs/sortDialog/index.tsx","components/dialogs/aboutDialog/component.tsx","components/dialogs/aboutDialog/index.tsx","constants/driveList.tsx","utils/syncUtils/dropbox.tsx","utils/syncUtils/webdav.tsx","components/dialogs/tokenDialog/component.tsx","components/dialogs/tokenDialog/index.tsx","components/dialogs/backupDialog/component.tsx","components/dialogs/backupDialog/index.tsx","constants/dropdownList.tsx","constants/settingList.tsx","constants/themeList.tsx","components/dialogs/settingDialog/component.tsx","components/dialogs/settingDialog/index.tsx","components/dialogs/actionDialog/component.tsx","components/dialogs/actionDialog/index.tsx","components/emptyCover/index.tsx","components/bookCardItem/component.tsx","components/bookCardItem/index.tsx","components/bookListItem/component.tsx","components/bookListItem/index.tsx","components/bookCoverItem/component.tsx","components/bookCoverItem/index.tsx","constants/emptyList.tsx","containers/emptyPage/component.tsx","containers/emptyPage/index.tsx","constants/viewMode.tsx","components/viewMode/component.tsx","components/viewMode/index.tsx","components/selectBook/component.tsx","components/selectBook/index.tsx","components/shelfSelector/component.tsx","components/shelfSelector/index.tsx","containers/lists/bookList/component.tsx","containers/lists/bookList/index.tsx","containers/lists/deletedBookList/component.tsx","containers/lists/deletedBookList/index.tsx","containers/lists/cardList/component.tsx","containers/lists/cardList/index.tsx","containers/lists/noteList/component.tsx","containers/lists/noteList/index.tsx","containers/lists/digestList/component.tsx","containers/lists/digestList/index.tsx","containers/loadingPage/component.tsx","containers/loadingPage/index.tsx","router/routes.tsx","components/arrow/index.tsx","components/dialogs/loadingDialog/index.tsx","components/dialogs/TipDialog/component.tsx","components/dialogs/TipDialog/index.tsx","pages/manager/component.tsx","pages/manager/index.tsx","containers/pageWidget/component.tsx","containers/pageWidget/index.tsx","utils/readUtils/themeUtil.tsx","components/readerSettings/themeList/component.tsx","components/readerSettings/themeList/index.tsx","components/readerSettings/sliderList/component.tsx","components/readerSettings/sliderList/index.tsx","components/readerSettings/dropdownList/component.tsx","components/readerSettings/dropdownList/index.tsx","components/readerSettings/modeControl/component.tsx","components/readerSettings/modeControl/index.tsx","utils/commonUtil.tsx","components/textToSpeech/component.tsx","components/textToSpeech/index.tsx","components/readerSettings/settingSwitch/component.tsx","components/readerSettings/settingSwitch/index.tsx","containers/panels/settingPanel/component.tsx","containers/panels/settingPanel/index.tsx","containers/lists/contentList/component.tsx","containers/lists/contentList/index.tsx","containers/lists/navList/component.tsx","containers/lists/navList/index.tsx","containers/panels/navigationPanel/component.tsx","containers/panels/navigationPanel/index.tsx","model/Bookmark.ts","containers/panels/operationPanel/component.tsx","containers/panels/operationPanel/index.tsx","containers/panels/progressPanel/component.tsx","containers/panels/progressPanel/index.tsx","containers/htmlViewer/index.tsx","pages/htmlReader/component.tsx","pages/htmlReader/index.tsx","components/backToMain/index.tsx","pages/djvuReader/component.tsx","pages/djvuReader/index.tsx","pages/pdfReader/component.tsx","pages/pdfReader/index.tsx","pages/redirect/component.tsx","pages/redirect/index.tsx","router/index.tsx","utils/serviceUtils/analytics.tsx","utils/serviceUtils/launchUtil.tsx","index.tsx","utils/syncUtils/restoreUtil.tsx","utils/readUtils/styleUtil.tsx","utils/readUtils/tagUtil.tsx","components/noteTag/component.tsx","components/noteTag/index.tsx","utils/readUtils/readingTime.tsx","utils/fileUtils/pdfUtil.tsx","components/deleteIcon/component.tsx","components/deleteIcon/index.tsx"],"names":["StorageUtil","key","JSON","parse","localStorage","getItem","value","readerConfig","setItem","stringify","kookitConfig","xmlMetadata","xml","Promise","resolve","reject","objBook","xml2js","Parser","parseString","err","result","console","log","fictionBook","FictionBook","bookDesc","description","name","author","binary","cover","xmlBookParser","bookString","bookStart","match","bookBody","slice","search","length","replace","xmlImageHandler","strArr","split","i","j","startsWith","id","join","handleLinkJump","event","href","target","parentNode","innerText","indexOf","src","openExternalUrl","Note","bookKey","chapter","chapterIndex","text","cfi","range","notes","percentage","color","tag","date","this","Date","getTime","year","getFullYear","month","getMonth","day","getDate","classes","PopupNote","props","handleTag","setState","removePDFHighlight","selected","colorCode","noteKey","iWin","getPDFIframeDoc","pageIndex","page","PDFViewerApplication","pdfViewer","getPageView","div","textLayer","textLayerDiv","querySelectorAll","forEach","item","getAttribute","removeChild","handleClose","note","noteIndex","index","splice","localforage","then","handleOpenMenu","handleMenuMode","currentBook","format","toast","success","t","handleFetchNotes","handleNoteKey","state","textArea","document","querySelector","focus","RecordLocation","getPDFLocation","md5","getHtmlLocation","pageArea","getElementById","iframe","getElementsByTagName","charRange","doc","contentDocument","window","rangy","getSelection","saveCharacterRanges","body","getHightlightCoords","toString","noteArr","push","className","style","position","bottom","height","onClick","Trans","createNote","React","Component","actionCreator","connect","book","reader","withTranslation","ColorOption","handleChangeOption","isLine","map","backgroundColor","border","handleColor","setReaderConfig","borderBottom","handleSelection","About","popupList","title","icon","PopupOption","handleNote","handleChangeDirection","handleEdge","offsetLeft","clientWidth","popupMenu","posX","left","posY","top","parseInt","substr","rightEdge","pageWidth","setAttribute","handleCopy","copy","getIframeDoc","empty","handleTrans","isElectron","handleOriginalText","handleDigest","digest","handleJump","url","handleSearchInternet","getReaderConfig","navigator","language","handleSearchBook","leftPanel","clickEvent","MouseEvent","view","bubbles","cancelable","dispatchEvent","focusEvent","searchBox","searchIcon","keyEvent","KeyboardEvent","keyCode","handleSpeak","msg","SpeechSynthesisUtterance","voice","speechSynthesis","getVoices","speak","trigger","selection","viewArea","googleTransList","auto","af","sq","am","ar","hy","az","eu","be","bn","bs","bg","ca","ceb","ny","co","hr","cs","da","nl","en","eo","et","tl","fi","fr","fy","gl","ka","de","el","gu","ht","ha","haw","he","iw","hi","hmn","hu","is","ig","ga","it","ja","jw","kn","kk","km","ko","ku","ky","lo","la","lv","lt","lb","mk","mg","ms","ml","mt","mi","mr","mn","my","ne","no","ps","fa","pl","pt","pa","ro","ru","sm","gd","sr","st","sn","sd","si","sk","sl","so","es","su","sw","sv","tg","ta","te","th","tr","uk","ur","uz","vi","cy","xh","yi","yo","zu","bingTransList","as","ba","yue","lzh","prs","dv","fo","fj","fil","mww","ikt","iu","kmr","nb","or","otq","ty","tt","bo","ti","to","tk","hsb","ug","yua","PopupTrans","translate","require","res","translatedText","translation","catch","originalText","display","width","marginLeft","onChange","targetLang","Object","keys","values","colors","lines","PopupMenu","highlighter","timer","mode","showNote","isFirstShow","rect","handleRenderHighlight","getHighlighter","renderHighlighters","addEventListener","openMenu","setTimeout","createHighlighter","config","ignoreWhiteSpace","elementTagName","elementProperties","onclick","handleNoteClick","onElementCreate","element","dataset","applier","createClassApplier","addClassApplier","sel","getRangeAt","removeAllRanges","addRange","getBoundingClientRect","showMenu","handleClickHighlighter","currentTarget","stopPropagation","handlePDFClick","showPDFHighlight","pageElement","viewport","coords","bounds","convertToViewportRectangle","createElement","Math","min","abs","appendChild","dialog","filter","handleShowDelete","deleteKey","x","y","pageHeight","menuMode","highlighters","highlightersByChapter","contentWindow","defaultView","removeAllHighlights","temp","restoreCharacterRanges","highlightSelection","e","warn","isOpenMenu","isCollapsed","rendition","on","handleRenderNoteFunc","nextProps","handleHighlight","PopupProps","isChangeDirection","digests","DeletePopup","handleCancel","handleDeletePopup","handleComfirm","handleDeleteOpearion","handleFetchBooks","tsTransform","innerHTML","Chinese","s2t","t2s","json","obj","chapterTitle","count","location","fingerprint","arr","files","_","findLastIndex","_obj","Kookit","MobiRender","Azw3Render","EpubRender","BookUtil","buffer","fs","path","dataPath","ipcRenderer","sendSync","FileReader","readAsArrayBuffer","Blob","onload","existsSync","mkdirSync","writeFileSync","Buffer","from","onerror","fs_extra","remove","removeItem","bookPath","_bookPath","isArrayBuffer","data","readFileSync","blobTemp","fileTemp","File","lastModified","type","Uint8Array","isBookExist","error","ref","toLowerCase","invoke","isMergeWord","isFullscreen","isPreventSleep","open","__dirname","pdfLocation","URL","platform","bookName","extension","size","file_content","publisher","charset","getPDFCover","epubRendition","getMetadata","metadata","creator","compression","chardet","detect","fb2Str","iconv","decode","fb2Obj","toUpperCase","BookModel","Hammer","sleep","throttleTime","trim","lock","arrowKeys","preventDefault","prev","next","handleShortcut","mouseChrome","deltaY","gesture","handleLocation","getPosition","recordHtmlLocation","bindHtmlEvent","readerMode","record","deltaX","mc","HtmlMouseEvent","pdfMouseEvent","djvuMouseEvent","Book","TxtRender","StrRender","ComicRender","Unrar","JSZip","Viewer","handlePageWidth","handleRenderBook","handleHtmlBook","removeContent","init","fetchBook","handleMobi","handleAzw3","handleEpub","handleTxt","handleMD","handleFb2","handleRtf","handleDocx","handleHtml","handleCbr","handleCbt","handleCbz","handleReadingState","RecentBooks","setRecent","handleRest","getChapter","chapters","flattenChapters","flatChapter","getPageSize","StyleUtil","addDefaultCss","setStyle","getCustomCss","bookLocation","goToPosition","isFirst","htmlBook","label","handleCurrentChapter","handleCurrentChapterIndex","handleFetchPercentage","handleBindGesture","handleLeaveReader","unrar","entries","getEntries","renderTo","getElementsByClassName","zip","loadAsync","contents","sort","untar","extractedFiles","extractedFile","handleCharset","books","handleReadingBook","blob","evt","docStr","marked","readAsText","rtfToHTML","fromString","html","removeExtraQuestionMark","mammoth","convertToHtml","arrayBuffer","bookObj","mimetype","toLocaleLowerCase","cfiRange","scale","margin","extraMargin","handleFetchBookmarks","handleRenderBookFunc","substring","renderNoteFunc","ab","buf","alloc","byteLength","right","parseFloat","overflowY","overflowX","isShow","handleEnterReader","withRouter","svg","png","jpg","jpeg","gif","webp","rar","tar","htm","xhtml","RecordRecent","bookArr","unshift","replaceAll","Background","isSingle","background","boxShadow","ImageViewer","showImage","isShowImage","zoomIndex","rotateIndex","imageRatio","img","Image","direction","naturalWidth","naturalHeight","image","hideImage","handleZoomIn","marginTop","handleZoomOut","handleSave","fetch","r","FileSaver","saveAs","toLocaleDateString","handleClock","transform","handleCounterClock","alt","handleBooks","payload","handleDeletedBooks","deletedBooks","handleSearchResults","searchResults","handleSearch","isSearch","handleTipDialog","isTipDialog","handleTip","tip","handleSetting","isSettingOpen","handleAbout","isAboutOpen","handleSortDisplay","isSortDisplay","handleLoadingDialog","isShowLoading","handleNewDialog","isShowNew","handleSelectBook","isSelectBook","handleSelectedBooks","selectedBooks","handleNewWarning","isNewWarning","handleBookSort","isBookSort","handleNoteSort","isNoteSort","handleBookSortCode","bookSortCode","handleNoteSortCode","noteSortCode","isTrash","dispatch","keyArr","AddTrash","getAllTrash","handleKeyFilter","handleKeyRemove","handleFetchBookSortCode","SortUtil","getBookSortCode","handleFetchNoteSortCode","getNoteSortCode","handleFetchList","viewMode","items","itemArr","handleEditDialog","handleDeleteDialog","handleAddDialog","renderBookFunc","handleActionDialog","handleDragItem","handleBackupDialog","handleTokenDialog","handlePercentage","handleBookmarks","bookmarks","currentChapter","currentChapterIndex","bookmarkArr","handleShelfIndex","shelfIndex","handleCollapse","handleMode","handleShowBookmark","isShowBookmark","getBookName","getAuthorName","getBookKey","getBookIndex","nameArr","oldNameArr","indexArr","concat","oldRecentArr","recentArr","getAllRecent","order","reverse","durationKeys","durationObj","ReadingTime","getAllTime","sortable","a","b","getDurationArr","bookKeys","union","oldAuthorArr","authorArr","percentagenKeys","locationObj","getAllCfi","getPercentageArr","clone","dateArr","uniq","noteObj","sortCode","orderCode","open_url","configArr","getParamsFromUrl","hashParams","q","hash","exec","decodeURIComponent","changePath","oldPath","newPath","readdir","isConfiged","file","emptyDirSync","syncData","isSync","AdmZip","extractAllTo","deleteBooks","all","zipBook","bookZip","folder","results","unzipConfig","zipEntries","zipEntry","getData","toArrayBuffer","ArrayBuffer","unzipBook","addBook","zipConfig","resources","translationEN","zh","translationCN","cht","translationTW","translationRO","translationPL","translationCS","jp","translationJP","translationKO","translationDE","translationRU","translationFR","ptBR","i18n","use","initReactI18next","lng","fallbackLng","keySeparator","interpolation","escapeValue","initState","isOpenEditDialog","isOpenDeleteDialog","isOpenAddDialog","isOpenActionDialog","isReading","dragItem","message","locations","isBackup","isOpenTokenDialog","rootReducer","combineReducers","action","isRedirect","manager","section","progressPanel","isOpenHighlight","dialogLocation","sidebar","backupPage","store","createStore","compose","applyMiddleware","thunk","devToolsExtension","f","sideMenu","Sidebar","handleSidebar","history","handleHover","hoverIndex","distance","onMouseEnter","onMouseLeave","SearchUtil","arr1","arr2","_arr","flag","list","keyWord","keyword","bookNameArr","AuthorNameArr","bookResults","fuzzyQuery","authorResults","MergeArray","textArr","noteResults","textResults","SearchBox","handleMouse","refs","isNavSearch","handleSearchState","tabMode","MouseNoteSearch","MouseSearch","handleKey","KeyNoteSearch","KeySearch","doSearch","searchList","handleSearchList","excerpt","onKeyDown","onFocus","placeholder","paddingRight","onCompositionStart","onCompositionEnd","pdfjsLib","fetchMD5","getFileMD5","fileReader","ev","getDocument","promise","pdfDoc","_pdfInfo","blobSlice","prototype","mozSlice","webkitSlice","chunkSize","chunks","ceil","currentChunk","spark","SparkMD5","Error","appendBinary","loadNext","end","start","readAsBinaryString","call","fetchFileFromPath","filePath","readFile","clickFilePath","ImportLocal","handleFilePath","isRepeat","repeatBook","isOpenFile","getMd5WithBrowser","getBookUrl","RedirectBook","handleAddBook","handleBook","duplicated_key","generateBook","_filePath","onDrop","acceptedFiles","handleDrag","accept","multiple","getRootProps","getInputProps","fontSize","fontWeight","on_import_click","newOptions","loop","autoplay","animationData","animationNew","rendererSettings","preserveAspectRatio","successOptions","animationSuccess","UpdateInfo","renderList","updateLog","isUpdated","axios","get","newVersion","version","localeCompare","options","marginBottom","new","fix","backup","generateAsync","Header","syncFromLocation","storageLocation","sourcePath","outPath","restore","isdataChange","lastSyncTime","handleSync","syncToLocation","timestamp","isOnlyLocal","isNewVersion","dirPath","DeleteUtil","defaultShelf","New","Study","Work","Entertainment","ShelfUtil","shelfTitle","undefined","currentShelfTitle","shelfList","AddFavorite","DeleteDialog","handleDeleteOther","deleteBookmarks","deleteNotes","clearShelf","deleteBook","setTrash","clear","deletefromAllShelf","i18nKey","EditDialog","isCheck","nameBox","authorBox","AddDialog","inputElement","isNaN","getShelf","shelfTitles","isNew","hasOwnProperty","setShelf","handleChange","renderShelfList","disabled","SortDialog","handleSort","code","isNote","setNoteSortCode","setBookSortCode","handleOrder","opacity","AboutDialog","callback_url","token_url","dropbox_client_id","googledrive_client_id","onedrive_client_id","driveList","Dropbox","DropboxUtil","ACCESS_TOKEN","dbx","accessToken","filesUpload","response","filesListFolder","folderArr","filesDownload","fileBlob","lastModifiedDate","WebdavUtil","UploadFile","createClient","username","password","client","wfs","exists","createDirectory","writeFile","copyFile","DownloadFile","request","downloadLink","getFileDownloadLink","stream","createWriteStream","pipe","TokenDialog","handleTokenComfirm","token","driveName","handleDavComfirm","BackupDialog","handleFinish","currentStep","showMessage","handleRestoreToLocal","handleDrive","currentDrive","dialogProps","lineHeight","dropdownList","option","speedList","settingList","desc","propName","langList","skinList","readerSettingList","backgroundList","textList","themeList","SettingDialog","bool","changeLanguage","changeSearch","searchEngine","changeSkin","skin","reload","changeFont","font","stateName","handleChangeLocation","filePaths","handleTheme","currentThemeIndex","handleMergeWord","isOpenInMain","handleOpenInMain","isTouch","isImportPath","isPreventTrigger","isAutoFullscreen","isPreventAdd","isOpenBook","isExpandContent","isDisableUpdate","appSkin","isDisableAnalytics","isUseBuiltIn","isPDFCover","children","transition","ActionDialog","handleDeleteBook","handleEditBook","handleAddShelf","handleRestoreBook","toFixed","toLocaleString","getBookPosition","emptyCover","BookCardItem","handleMoreAction","clientX","clientHeight","clientY","handleLoveBook","setFavorite","isFavorite","handleCancelLoveBook","getAllFavorite","handleConfig","isOpenConfig","isSelected","actionProps","onMouseOver","onContextMenu","onLoad","floor","BookListItem","isDeleteDialog","export_book","round","handleExportBook","BookCoverItem","emptyList","main","sub","subsub","EmptyPage","visibility","ViewMode","SelectBook","isOpenDelete","favoriteBooks","ShelfChooser","handleShelfItem","handleDeleteShelf","removeShelf","deletePopupProps","BookList","subItem","handleIndexFilter","renderBookList","handleShelf","sortBooks","zIndex","currentShelfList","CardList","handleBookName","recordPDFLocation","cards","sortNotes","cardProps","itemKey","overflow","isCard","NoteList","handleFilter","filterTag","noteProps","DigestList","LoadingPage","routes","component","DeletedBookList","Arrow","xmlns","viewBox","fill","stroke","strokeWidth","cx","y2","strokeLinecap","d","defaultOptions","LoadingDialog","downloadOptions","TipDialog","Manager","isDrag","totalBooks","isAuthed","isError","isCopied","maxTouchPoints","isMobile","onDragEnter","ele","render","prevPage","nextPage","isHideFooter","isHideHeader","handlePageNum","getProgress","pageInfo","currentPage","ThemeUtil","themeName","themeArr","ThemeList","handleChangeBgColor","currentBackgroundIndex","handleChooseBgColor","handleColorTextPicker","isShowTextPicker","getAllThemes","findIndex","setThemes","handleColorBgPicker","isShowBgPicker","handleChooseTextColor","currentTextIndex","enableAlpha","animation","SliderList","onValueChange","letterSpacing","paraSpacing","brightness","onValueInput","handleMinus","step","handleAdd","defaultValue","onBlur","minLabel","max","maxValue","minValue","onInput","onMouseUp","maxLabel","DropdownList","currentFontFamilyIndex","currentLineHeightIndex","currentTextAlignIndex","chineseConversionIndex","getFonts","disableQuoting","handleView","ModeControl","handleChangeMode","time","TextToSpeech","handleChangeAudio","isAudioOn","cancel","synth","setInterval","clearInterval","isSupported","voices","handleAudio","visibleText","handleSpeech","voiceIndex","speed","rate","onend","SettingSwitch","_handleRest","_handleChange","isBold","isIndent","isSliding","isUnderline","isShadow","isItalic","isInvert","isHideBackground","isHidePageButton","isHideMenuButton","SettingPanel","handleLock","isSettingLocked","float","ContentList","currentIndex","bind","newChapter","subitems","goToChapter","renderContentList","level","NavList","deleteIndex","currentData","currentTab","bookmarkProps","cursor","NavigationPanel","handleChangeTab","isNavLocked","renderSearchList","renderSearchPage","startIndex","pageList","total","searchProps","Bookmark","OperationPanel","timeStamp","handleAddBookmark","bookmark","isBookmark","currentPercentage","timeLeft","now","pageProgress","totalPage","storageUtil","handleFullScreen","handleExitFullScreen","setTime","documentElement","requestFullscreen","fullscreenElement","exitFullscreen","handleExit","close","handleScreen","ProgressPanel","onProgressChange","nextChapter","prevChapter","handleJumpChapter","onTouchEnd","Reader","messageTimer","tickTimer","isOpenRightPanel","isOpenLeftPanel","isOpenTopPanel","isOpenBottomPanel","hoverPanel","renditionProps","handleDjvu","ViewerInstance","DjVu","loadDocument","loading","getPDFUrl","scrollWidth","scrollHeight","status","callback","Redirect","alert","params","access_token","Router","useEffect","DjvuReader","HtmlReader","PDFReader","_Redirect","Analytics","clientId","GA","debug","process","set","pkg","one","mac","getClientId","pageview","evCategory","evAction","clientID","exDesc","exFatal","exception","elem","rel","isNight","matchMedia","matches","head","initTheme","ReactDOM","evLabel","removeScript","applyTheme","styleUtil","css","getDefaultCss","textContent","isJSON","isScroll","padding","addStyle","TagUtil","tagName","tagArr","NoteTag","tagToIndex","getAllTags","indextoTag","tagIndex","handleChangeTag","indexResult","handleAddTag","isInput","setTags","handleInput","handleShowTags","isShowTags","offsetTop","currentPageNumber","pageRect","canvas","getClientRects","selectionRects","tempRect","convertToPdfPoint","fileSize","getPage","getViewport","context","getContext","canvasContext","toDataURL","DeleteIcon","handleDelete","deleteItems","deleteFunc"],"mappings":"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","file":"static/js/main.588b597d.chunk.js","sourcesContent":["class StorageUtil {\n  static getReaderConfig(key: string) {\n    let readerConfig = JSON.parse(localStorage.getItem(\"readerConfig\")!) || {};\n    return readerConfig[key];\n  }\n\n  static setReaderConfig(key: string, value: string) {\n    let readerConfig = JSON.parse(localStorage.getItem(\"readerConfig\")!) || {};\n    readerConfig[key] = value;\n    localStorage.setItem(\"readerConfig\", JSON.stringify(readerConfig));\n  }\n  static getKookitConfig(key: string) {\n    let kookitConfig = JSON.parse(localStorage.getItem(\"kookitConfig\")!) || {};\n    return kookitConfig[key];\n  }\n\n  static setKookitConfig(key: string, value: string) {\n    let kookitConfig = JSON.parse(localStorage.getItem(\"kookitConfig\")!) || {};\n    kookitConfig[key] = value;\n    localStorage.setItem(\"kookitConfig\", JSON.stringify(kookitConfig));\n  }\n}\n\nexport default StorageUtil;\n","import xml2js from \"xml2js\";\nexport const xmlMetadata = (xml: string) => {\n  return new Promise<object>((resolve, reject) => {\n    var objBook: any = {};\n    let parser = new xml2js.Parser();\n    parser.parseString(xml, function (err, result) {\n      if (err) {\n        console.log(\"Error with parsing xml\" + err);\n        resolve({});\n      }\n      var fictionBook = result.FictionBook;\n      var bookDesc = fictionBook.description[0][\"title-info\"][0];\n      objBook.name = bookDesc[\"book-title\"][0];\n\n      if (bookDesc[\"author\"] && bookDesc[\"author\"][0][\"first-name\"]) {\n        objBook.author = bookDesc[\"author\"][0][\"first-name\"][0];\n\n        if (bookDesc[\"author\"][0][\"last-name\"]) {\n          objBook.author += \" \" + bookDesc[\"author\"][0][\"last-name\"][0];\n        }\n      }\n      if (fictionBook.binary) {\n        objBook.cover = \"data:image/jpeg;base64,\" + fictionBook.binary[0][\"_\"];\n      }\n      resolve(objBook);\n    });\n  });\n};\n\nexport const xmlBookParser = (xml: any, bookString: string) => {\n  var regExpTagDelete = /<epigraph>|<\\/epigraph>|<empty-line\\/>|/gi;\n  var regExpTitleOpen = /<title>/gi;\n  var regExpTitleClose = /<\\/title>/gi;\n  var bookStart = bookString.match(/<body.*?>/i) || [\"\"];\n  var bookBody = bookString.slice(\n    bookString.search(/<body.*?>/i) + bookStart[0].length,\n    bookString.search(/<\\/body>/i)\n  );\n\n  bookBody = bookBody.replace(regExpTagDelete, \"\");\n  bookBody = bookBody.replace(regExpTitleOpen, \"<h3>\");\n  bookBody = bookBody.replace(regExpTitleClose, \"</h3>\");\n\n  return xmlImageHandler(xml, bookBody);\n};\n\nexport const xmlImageHandler = (xml: any, bookString: string) => {\n  let parser = new xml2js.Parser();\n  parser.parseString(xml, function (err, result) {\n    if (err) {\n      console.log(\"Error with parsing xml\" + err);\n      return \"\";\n    }\n\n    var fictionBook = result.FictionBook;\n    if (fictionBook.binary) {\n      let strArr = bookString.split(`<image xlink:href=\"#`);\n\n      for (let i = 0; i < strArr.length; i++) {\n        for (let j = 0; j < fictionBook.binary.length; j++) {\n          if (strArr[i].startsWith(fictionBook.binary[j][\"$\"].id)) {\n            strArr[i] =\n              '<img alt=\"poster\" style=\"max-width: 100%; max-height: 100%\" src=\"' +\n              \"data:image/jpeg;base64,\" +\n              fictionBook.binary[j][\"_\"] +\n              strArr[i].slice(fictionBook.binary[j][\"$\"].id.length);\n          }\n        }\n      }\n\n      bookString = strArr.join(\"\");\n    }\n  });\n\n  return bookString;\n};\n","import { openExternalUrl } from \"../serviceUtils/urlUtil\";\n\nexport const handleLinkJump = (event: any) => {\n  let href;\n\n  if (\n    event.target &&\n    event.target.parentNode &&\n    event.target.parentNode.parentNode\n  ) {\n    href =\n      (event.target.innerText.indexOf(\"http\") > -1 && event.target.innerText) ||\n      event.target.src ||\n      event.target.href ||\n      event.target.parentNode.href ||\n      event.target.parentNode.parentNode.href ||\n      \"\";\n  }\n  if (\n    href &&\n    href.indexOf(\"../\") === -1 &&\n    href.indexOf(\"http\") === 0 &&\n    href.indexOf(\"OEBPF\") === -1 &&\n    href.indexOf(\"OEBPS\") === -1 &&\n    href.indexOf(\"footnote\") === -1 &&\n    href.indexOf(\"blob\") === -1 &&\n    href.indexOf(\"data:application\") === -1 &&\n    href.indexOf(\".htm\") === -1\n  ) {\n    openExternalUrl(href);\n  }\n};\n","class Note {\n  key: string;\n  bookKey: string;\n  date: { year: number; month: number; day: number };\n  chapter: string;\n  chapterIndex: number;\n  text: string;\n  cfi: string;\n  range: string;\n  notes: string;\n  percentage: number;\n  color: number;\n  tag: string[];\n  constructor(\n    bookKey: string,\n    chapter: string,\n    chapterIndex: number,\n    text: string,\n    cfi: string,\n    range: string,\n    notes: string,\n    percentage: number,\n    color: number,\n    tag: string[]\n  ) {\n    this.key = new Date().getTime() + \"\"; //笔记的键值\n    this.bookKey = bookKey; //笔记的所在书的键值\n    this.date = {\n      year: new Date().getFullYear(),\n      month: new Date().getMonth() + 1,\n      day: new Date().getDate(),\n    }; //笔记的添加日期\n    this.chapter = chapter; //笔记的所在章节\n    this.chapterIndex = chapterIndex; //笔记的所在章节\n    this.text = text; //笔记对应的书本的内容\n    this.cfi = cfi; //添加笔记的位置\n    this.range = range; // Rangy.js产生的将Range对象序列化后的字符串\n    this.notes = notes || \"\"; //笔记的内容\n    this.percentage = percentage; //笔记在文中的进度\n    this.color = color; //笔记高亮的颜色\n    this.tag = tag; //笔记高亮的颜色\n  }\n}\n\nexport default Note;\n","//添加笔记的弹窗\nimport React from \"react\";\nimport \"./popupNote.css\";\nimport Note from \"../../../model/Note\";\nimport localforage from \"localforage\";\nimport { PopupNoteProps, PopupNoteState } from \"./interface\";\nimport RecordLocation from \"../../../utils/readUtils/recordLocation\";\nimport NoteTag from \"../../noteTag\";\nimport NoteModel from \"../../../model/Note\";\nimport { Trans } from \"react-i18next\";\nimport toast from \"react-hot-toast\";\nimport { getHightlightCoords } from \"../../../utils/fileUtils/pdfUtil\";\nimport { getPDFIframeDoc } from \"../../../utils/serviceUtils/docUtil\";\ndeclare var window: any;\nlet classes = [\n  \"color-0\",\n  \"color-1\",\n  \"color-2\",\n  \"color-3\",\n  \"line-0\",\n  \"line-1\",\n  \"line-2\",\n  \"line-3\",\n];\nclass PopupNote extends React.Component<PopupNoteProps, PopupNoteState> {\n  constructor(props: PopupNoteProps) {\n    super(props);\n    this.state = { tag: [] };\n  }\n  componentDidMount() {\n    let textArea: any = document.querySelector(\".editor-box\");\n    textArea && textArea.focus();\n  }\n  handleTag = (tag: string[]) => {\n    this.setState({ tag });\n  };\n  removePDFHighlight = (selected: any, colorCode: string, noteKey: string) => {\n    let iWin = getPDFIframeDoc();\n    if (!iWin) return;\n    var pageIndex = selected.page;\n    if (!iWin.PDFViewerApplication.pdfViewer) return;\n    var page = iWin.PDFViewerApplication.pdfViewer.getPageView(pageIndex);\n    if (page && page.div && page.textLayer && page.textLayer.textLayerDiv) {\n      var pageElement =\n        colorCode.indexOf(\"color\") > -1\n          ? page.textLayer.textLayerDiv\n          : page.div;\n      let noteElements = pageElement.querySelectorAll(\".pdf-note\");\n      noteElements.forEach((item: Element) => {\n        if (item.getAttribute(\"key\") === noteKey) {\n          item.parentNode?.removeChild(item);\n        }\n      });\n    }\n  };\n  createNote() {\n    let notes = (document.querySelector(\".editor-box\") as HTMLInputElement)\n      .value;\n    if (this.props.noteKey) {\n      //编辑笔记\n      this.props.notes.forEach((item) => {\n        if (item.key === this.props.noteKey) {\n          item.notes = notes;\n          item.tag = this.state.tag;\n        }\n      });\n      localforage.setItem(\"notes\", this.props.notes).then(() => {\n        this.props.handleOpenMenu(false);\n        toast.success(this.props.t(\"Add Successfully\"));\n        this.props.handleFetchNotes();\n        this.props.handleMenuMode(\"highlight\");\n        this.props.handleNoteKey(\"\");\n      });\n    } else {\n      //创建笔记\n      let bookKey = this.props.currentBook.key;\n      let cfi = \"\";\n      if (this.props.currentBook.format === \"PDF\") {\n        cfi = JSON.stringify(\n          RecordLocation.getPDFLocation(\n            this.props.currentBook.md5.split(\"-\")[0]\n          )\n        );\n      } else {\n        cfi = JSON.stringify(\n          RecordLocation.getHtmlLocation(this.props.currentBook.key)\n        );\n      }\n\n      let pageArea = document.getElementById(\"page-area\");\n      if (!pageArea) return;\n      let iframe = pageArea.getElementsByTagName(\"iframe\")[0];\n      if (!iframe) return;\n      let doc = iframe.contentDocument;\n      if (!doc) {\n        return;\n      }\n      let charRange;\n      if (this.props.currentBook.format !== \"PDF\") {\n        charRange = window.rangy\n          .getSelection(iframe)\n          .saveCharacterRanges(doc.body)[0];\n      }\n\n      let range =\n        this.props.currentBook.format === \"PDF\"\n          ? JSON.stringify(getHightlightCoords())\n          : JSON.stringify(charRange);\n      let text = doc.getSelection()?.toString();\n      if (!text) {\n        return;\n      }\n      text = text.replace(/\\s\\s/g, \"\");\n      text = text.replace(/\\r/g, \"\");\n      text = text.replace(/\\n/g, \"\");\n      text = text.replace(/\\t/g, \"\");\n      text = text.replace(/\\f/g, \"\");\n      let percentage = 0;\n\n      let color = this.props.color || 0;\n      let tag = this.state.tag;\n\n      let note = new Note(\n        bookKey,\n        this.props.chapter,\n        this.props.chapterIndex,\n        text,\n        cfi,\n        range,\n        notes,\n        percentage,\n        color,\n        tag\n      );\n\n      let noteArr = this.props.notes;\n      noteArr.push(note);\n      localforage.setItem(\"notes\", noteArr).then(() => {\n        this.props.handleOpenMenu(false);\n        toast.success(this.props.t(\"Add Successfully\"));\n        this.props.handleFetchNotes();\n        this.props.handleMenuMode(\"highlight\");\n      });\n    }\n  }\n  handleClose = () => {\n    let noteIndex = -1;\n    let note: NoteModel;\n    if (this.props.noteKey) {\n      this.props.notes.forEach((item, index) => {\n        if (item.key === this.props.noteKey) {\n          noteIndex = index;\n          note = item;\n        }\n      });\n      if (noteIndex > -1) {\n        this.props.notes.splice(noteIndex, 1);\n        localforage.setItem(\"notes\", this.props.notes).then(() => {\n          this.props.handleOpenMenu(false);\n          this.props.handleMenuMode(\"menu\");\n          if (this.props.currentBook.format === \"PDF\") {\n            this.removePDFHighlight(\n              JSON.parse(note.range),\n              classes[note.color],\n              note.key\n            );\n          }\n\n          toast.success(this.props.t(\"Delete Successfully\"));\n          this.props.handleMenuMode(\"highlight\");\n          this.props.handleFetchNotes();\n          this.props.handleNoteKey(\"\");\n        });\n      }\n    } else {\n      this.props.handleOpenMenu(false);\n      this.props.handleMenuMode(\"menu\");\n      this.props.handleNoteKey(\"\");\n    }\n  };\n\n  render() {\n    let note: NoteModel;\n    if (this.props.noteKey) {\n      this.props.notes.forEach((item) => {\n        if (item.key === this.props.noteKey) {\n          note = item;\n        }\n      });\n    }\n\n    const renderNoteEditor = () => {\n      return (\n        <div className=\"note-editor\">\n          <div className=\"editor-box-parent\">\n            <textarea className=\"editor-box\" />\n          </div>\n          <div\n            className=\"note-tags\"\n            style={{ position: \"absolute\", bottom: \"0px\", height: \"70px\" }}\n          >\n            <NoteTag\n              {...{\n                handleTag: this.handleTag,\n                tag: this.props.noteKey && note ? note.tag : [],\n              }}\n            />\n          </div>\n\n          <div className=\"note-button-container\">\n            <span\n              className=\"book-manage-title\"\n              onClick={() => {\n                this.handleClose();\n              }}\n            >\n              {this.props.noteKey ? (\n                <Trans>Delete</Trans>\n              ) : (\n                <Trans>Cancel</Trans>\n              )}\n            </span>\n            <span\n              className=\"book-manage-title\"\n              onClick={() => {\n                this.createNote();\n              }}\n            >\n              <Trans>Confirm</Trans>\n            </span>\n          </div>\n        </div>\n      );\n    };\n    return renderNoteEditor();\n  }\n}\nexport default PopupNote;\n","import { connect } from \"react-redux\";\nimport {\n  handleOpenMenu,\n  handleMenuMode,\n  handleNoteKey,\n  handleFetchNotes,\n} from \"../../../store/actions\";\nimport { stateType } from \"../../../store\";\nimport { withTranslation } from \"react-i18next\";\nimport PopupNote from \"./component\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentBook: state.book.currentBook,\n    notes: state.reader.notes,\n    color: state.reader.color,\n    noteKey: state.reader.noteKey,\n  };\n};\nconst actionCreator = {\n  handleOpenMenu,\n  handleMenuMode,\n  handleNoteKey,\n  handleFetchNotes,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(PopupNote as any));\n","import React from \"react\";\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\nimport \"./colorOption.css\";\nimport { ColorProps, ColorStates } from \"./interface\";\n\nclass ColorOption extends React.Component<ColorProps, ColorStates> {\n  constructor(props: ColorProps) {\n    super(props);\n    this.state = {\n      isLine: this.props.color > 3 ? true : false,\n    };\n  }\n  handleChangeOption = () => {\n    this.setState({ isLine: !this.state.isLine });\n  };\n  render() {\n    const renderLine = () => {\n      return [\"#FF0000\", \"#000080\", \"#0000FF\", \"#2EFF2E\"].map((item, index) => {\n        return (\n          <div\n            className=\"line-option\"\n            style={{\n              border: `${this.props.color === index + 4 ? \"\" : \"2px\"}`,\n            }}\n            key={item}\n            onClick={() => {\n              this.props.handleColor(index + 4);\n              StorageUtil.setReaderConfig(\n                \"highlightIndex\",\n                (index + 4).toString()\n              );\n            }}\n          >\n            <div\n              className=\"demo-line\"\n              style={{ borderBottom: `solid 2px ${item}` }}\n            ></div>\n          </div>\n        );\n      });\n    };\n    const renderColor = () => {\n      return [\"#FBF1D1\", \"#EFEEB0\", \"#CAEFC9\", \"#76BEE9\"].map((item, index) => {\n        return (\n          <div\n            className=\"color-option\"\n            style={{\n              backgroundColor: item,\n              border: `${this.props.color === index ? \"\" : \"0px\"}`,\n            }}\n            key={item}\n            onClick={() => {\n              this.props.handleColor(index);\n              StorageUtil.setReaderConfig(\"highlightIndex\", index.toString());\n            }}\n          ></div>\n        );\n      });\n    };\n    return (\n      <div className=\"color-option-container\">\n        {!this.state.isLine && renderColor()}\n        <span\n          className=\"icon-sort popup-color-more\"\n          onClick={() => {\n            this.handleChangeOption();\n          }}\n        ></span>\n        {this.state.isLine && renderLine()}\n      </div>\n    );\n  }\n}\n\nexport default ColorOption;\n","import { connect } from \"react-redux\";\nimport { handleColor, handleSelection } from \"../../store/actions\";\nimport { stateType } from \"../../store\";\nimport About from \"./component\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    color: state.reader.color,\n    currentBook: state.book.currentBook,\n  };\n};\nconst actionCreator = {\n  handleColor,\n  handleSelection,\n};\nexport default connect(mapStateToProps, actionCreator)(About as any);\n","export const popupList = [\n  { name: \"note\", title: \"Take Note\", icon: \"note\" },\n  { name: \"digest\", title: \"Highlight\", icon: \"highlight\" },\n  { name: \"translation\", title: \"Translate\", icon: \"translation\" },\n  { name: \"copy\", title: \"Copy\", icon: \"copy\" },\n  { name: \"search-book\", title: \"Search in the book\", icon: \"search-book\" },\n  { name: \"google\", title: \"Search on the internet\", icon: \"google\" },\n  { name: \"speaker\", title: \"Speak the text\", icon: \"Speaker\" },\n];\n","import React from \"react\";\nimport \"./popupOption.css\";\nimport localforage from \"localforage\";\nimport Note from \"../../../model/Note\";\nimport { PopupOptionProps } from \"./interface\";\nimport ColorOption from \"../../colorOption\";\nimport RecordLocation from \"../../../utils/readUtils/recordLocation\";\nimport { Tooltip } from \"react-tippy\";\nimport { popupList } from \"../../../constants/popupList\";\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\nimport toast from \"react-hot-toast\";\nimport { getSelection } from \"../../../utils/serviceUtils/mouseEvent\";\nimport copy from \"copy-text-to-clipboard\";\nimport { getHightlightCoords } from \"../../../utils/fileUtils/pdfUtil\";\nimport { getIframeDoc } from \"../../../utils/serviceUtils/docUtil\";\nimport { openExternalUrl } from \"../../../utils/serviceUtils/urlUtil\";\nimport { isElectron } from \"react-device-detect\";\n\ndeclare var window: any;\n\nclass PopupOption extends React.Component<PopupOptionProps> {\n  handleNote = () => {\n    this.props.handleChangeDirection(false);\n    this.props.handleMenuMode(\"note\");\n    this.handleEdge();\n  };\n  handleEdge = () => {\n    let page: any = { offsetLeft: 0 };\n    if (this.props.currentBook.format !== \"PDF\") {\n      page = document.getElementById(\"page-area\");\n      if (!page.clientWidth) return;\n    }\n    let popupMenu: any = document.querySelector(\".popup-menu-container\");\n    let posX = popupMenu?.style.left;\n    let posY = popupMenu?.style.top;\n    posX = parseInt(posX.substr(0, posX.length - 2));\n    posY = parseInt(posY.substr(0, posY.length - 2));\n    let rightEdge = this.props.pageWidth - 310 + page.offsetLeft * 2;\n\n    if (posX > rightEdge) {\n      popupMenu?.setAttribute(\"style\", `left:${rightEdge}px;top:${posY}px`);\n    }\n  };\n  handleCopy = () => {\n    let text = getSelection();\n    if (!text) return;\n    copy(text);\n    this.props.handleOpenMenu(false);\n    let doc = getIframeDoc();\n    if (!doc) return;\n    doc.getSelection()?.empty();\n    toast.success(this.props.t(\"Copy Successfully\"));\n  };\n  handleTrans = () => {\n    if (!isElectron) {\n      toast(\n        this.props.t(\n          \"Koodo Reader's web version are limited by the browser, for more powerful features, please download the desktop version.\"\n        )\n      );\n      return;\n    }\n    this.props.handleMenuMode(\"trans\");\n    this.props.handleOriginalText(getSelection() || \"\");\n    this.handleEdge();\n  };\n  handleDigest = () => {\n    let bookKey = this.props.currentBook.key;\n    let cfi = \"\";\n    if (this.props.currentBook.format === \"PDF\") {\n      cfi = JSON.stringify(\n        RecordLocation.getPDFLocation(this.props.currentBook.md5.split(\"-\")[0])\n      );\n    } else {\n      cfi = JSON.stringify(\n        RecordLocation.getHtmlLocation(this.props.currentBook.key)\n      );\n    }\n    let percentage = RecordLocation.getHtmlLocation(this.props.currentBook.key)\n      .percentage\n      ? RecordLocation.getHtmlLocation(this.props.currentBook.key).percentage\n      : 0;\n    let color = this.props.color;\n    let notes = \"\";\n    let pageArea = document.getElementById(\"page-area\");\n    if (!pageArea) return;\n    let iframe = pageArea.getElementsByTagName(\"iframe\")[0];\n    if (!iframe) return;\n    let doc = iframe.contentDocument;\n    if (!doc) return;\n    let charRange;\n    if (this.props.currentBook.format !== \"PDF\") {\n      charRange = window.rangy\n        .getSelection(iframe)\n        .saveCharacterRanges(doc.body)[0];\n    }\n    let range =\n      this.props.currentBook.format === \"PDF\"\n        ? JSON.stringify(getHightlightCoords())\n        : JSON.stringify(charRange);\n    let text = doc.getSelection()?.toString();\n    if (!text) return;\n    text = text.replace(/\\s\\s/g, \"\");\n    text = text.replace(/\\r/g, \"\");\n    text = text.replace(/\\n/g, \"\");\n    text = text.replace(/\\t/g, \"\");\n    text = text.replace(/\\f/g, \"\");\n    let digest = new Note(\n      bookKey,\n      this.props.chapter,\n      this.props.chapterIndex,\n      text,\n      cfi,\n      range,\n      notes,\n      percentage,\n      color,\n      []\n    );\n    let noteArr = this.props.notes;\n    noteArr.push(digest);\n    localforage.setItem(\"notes\", noteArr).then(() => {\n      this.props.handleOpenMenu(false);\n      toast.success(this.props.t(\"Add Successfully\"));\n      this.props.handleFetchNotes();\n      this.props.handleMenuMode(\"highlight\");\n    });\n  };\n  handleJump = (url: string) => {\n    openExternalUrl(url);\n  };\n  handleSearchInternet = () => {\n    switch (StorageUtil.getReaderConfig(\"searchEngine\")) {\n      case \"google\":\n        this.handleJump(\"https://www.google.com/search?q=\" + getSelection());\n        break;\n      case \"baidu\":\n        this.handleJump(\"https://www.baidu.com/s?wd=\" + getSelection());\n        break;\n      case \"bing\":\n        this.handleJump(\"https://www.bing.com/search?q=\" + getSelection());\n        break;\n      case \"duckduckgo\":\n        this.handleJump(\"https://duckduckgo.com/?q=\" + getSelection());\n        break;\n      case \"yandex\":\n        this.handleJump(\"https://yandex.com/search/?text=\" + getSelection());\n        break;\n      case \"yahoo\":\n        this.handleJump(\"https://search.yahoo.com/search?p=\" + getSelection());\n        break;\n      case \"naver\":\n        this.handleJump(\n          \"https://search.naver.com/search.naver?where=nexearch&sm=top_hty&fbm=1&ie=utf8&query=\" +\n            getSelection()\n        );\n        break;\n      case \"baike\":\n        this.handleJump(\"https://baike.baidu.com/item/\" + getSelection());\n        break;\n      case \"wiki\":\n        this.handleJump(\"https://en.wikipedia.org/wiki/\" + getSelection());\n        break;\n      default:\n        this.handleJump(\n          navigator.language === \"zh-CN\"\n            ? \"https://www.baidu.com/s?wd=\" + getSelection()\n            : \"https://www.google.com/search?q=\" + getSelection()\n        );\n        break;\n    }\n  };\n  handleSearchBook = () => {\n    let leftPanel = document.querySelector(\".left-panel\");\n    const clickEvent = new MouseEvent(\"click\", {\n      view: window,\n      bubbles: true,\n      cancelable: true,\n    });\n    if (!leftPanel) return;\n    leftPanel.dispatchEvent(clickEvent);\n    const focusEvent = new MouseEvent(\"focus\", {\n      view: window,\n      bubbles: true,\n      cancelable: true,\n    });\n    let searchBox: any = document.querySelector(\".header-search-box\");\n    searchBox.dispatchEvent(focusEvent);\n    let searchIcon = document.querySelector(\".header-search-icon\");\n    searchIcon?.dispatchEvent(clickEvent);\n    searchBox.value = getSelection() || \"\";\n    const keyEvent: any = new KeyboardEvent(\"keydown\", {\n      bubbles: true,\n      cancelable: true,\n      keyCode: 13,\n    } as any);\n    searchBox.dispatchEvent(keyEvent);\n    this.props.handleOpenMenu(false);\n  };\n\n  handleSpeak = () => {\n    var msg = new SpeechSynthesisUtterance();\n    msg.text = getSelection() || \"\";\n    msg.voice = window.speechSynthesis.getVoices()[0];\n    window.speechSynthesis.speak(msg);\n  };\n  render() {\n    const renderMenuList = () => {\n      return (\n        <>\n          <div className=\"menu-list\">\n            {popupList.map((item, index) => {\n              return (\n                <div\n                  key={item.name}\n                  className={item.name + \"-option\"}\n                  onClick={() => {\n                    switch (index) {\n                      case 0:\n                        this.handleNote();\n                        break;\n                      case 1:\n                        this.handleDigest();\n                        break;\n                      case 2:\n                        this.handleTrans();\n                        break;\n                      case 3:\n                        this.handleCopy();\n                        break;\n                      case 4:\n                        this.handleSearchBook();\n                        break;\n                      case 5:\n                        this.handleSearchInternet();\n                        break;\n                      case 6:\n                        this.handleSpeak();\n                        break;\n\n                      default:\n                        break;\n                    }\n                  }}\n                >\n                  <Tooltip\n                    title={this.props.t(item.title)}\n                    position=\"top\"\n                    trigger=\"mouseenter\"\n                  >\n                    <span\n                      className={`icon-${item.icon} ${item.name}-icon`}\n                    ></span>\n                  </Tooltip>\n                </div>\n              );\n            })}\n          </div>\n          <ColorOption />\n        </>\n      );\n    };\n    return renderMenuList();\n  }\n}\n\nexport default PopupOption;\n","import { connect } from \"react-redux\";\nimport {\n  handleOpenMenu,\n  handleMenuMode,\n  handleChangeDirection,\n} from \"../../../store/actions\";\nimport { handleFetchNotes, handleOriginalText } from \"../../../store/actions\";\nimport { stateType } from \"../../../store\";\nimport { withTranslation } from \"react-i18next\";\nimport PopupOption from \"./component\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentBook: state.book.currentBook,\n    selection: state.viewArea.selection,\n    notes: state.reader.notes,\n    color: state.reader.color,\n  };\n};\nconst actionCreator = {\n  handleOpenMenu,\n  handleMenuMode,\n  handleFetchNotes,\n  handleOriginalText,\n  handleChangeDirection,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(PopupOption as any));\n","export const googleTransList = {\n  auto: \"Automatic\",\n  af: \"Afrikaans\",\n  sq: \"Albanian\",\n  am: \"Amharic\",\n  ar: \"Arabic\",\n  hy: \"Armenian\",\n  az: \"Azerbaijani\",\n  eu: \"Basque\",\n  be: \"Belarusian\",\n  bn: \"Bengali\",\n  bs: \"Bosnian\",\n  bg: \"Bulgarian\",\n  ca: \"Catalan\",\n  ceb: \"Cebuano\",\n  ny: \"Chichewa\",\n  \"zh-CN\": \"Chinese (Simplified)\",\n  \"zh-TW\": \"Chinese (Traditional)\",\n  co: \"Corsican\",\n  hr: \"Croatian\",\n  cs: \"Czech\",\n  da: \"Danish\",\n  nl: \"Dutch\",\n  en: \"English\",\n  eo: \"Esperanto\",\n  et: \"Estonian\",\n  tl: \"Filipino\",\n  fi: \"Finnish\",\n  fr: \"French\",\n  fy: \"Frisian\",\n  gl: \"Galician\",\n  ka: \"Georgian\",\n  de: \"German\",\n  el: \"Greek\",\n  gu: \"Gujarati\",\n  ht: \"Haitian Creole\",\n  ha: \"Hausa\",\n  haw: \"Hawaiian\",\n  he: \"Hebrew\",\n  iw: \"Hebrew\",\n  hi: \"Hindi\",\n  hmn: \"Hmong\",\n  hu: \"Hungarian\",\n  is: \"Icelandic\",\n  ig: \"Igbo\",\n  id: \"Indonesian\",\n  ga: \"Irish\",\n  it: \"Italian\",\n  ja: \"Japanese\",\n  jw: \"Javanese\",\n  kn: \"Kannada\",\n  kk: \"Kazakh\",\n  km: \"Khmer\",\n  ko: \"Korean\",\n  ku: \"Kurdish (Kurmanji)\",\n  ky: \"Kyrgyz\",\n  lo: \"Lao\",\n  la: \"Latin\",\n  lv: \"Latvian\",\n  lt: \"Lithuanian\",\n  lb: \"Luxembourgish\",\n  mk: \"Macedonian\",\n  mg: \"Malagasy\",\n  ms: \"Malay\",\n  ml: \"Malayalam\",\n  mt: \"Maltese\",\n  mi: \"Maori\",\n  mr: \"Marathi\",\n  mn: \"Mongolian\",\n  my: \"Myanmar (Burmese)\",\n  ne: \"Nepali\",\n  no: \"Norwegian\",\n  ps: \"Pashto\",\n  fa: \"Persian\",\n  pl: \"Polish\",\n  pt: \"Portuguese\",\n  pa: \"Punjabi\",\n  ro: \"Romanian\",\n  ru: \"Russian\",\n  sm: \"Samoan\",\n  gd: \"Scots Gaelic\",\n  sr: \"Serbian\",\n  st: \"Sesotho\",\n  sn: \"Shona\",\n  sd: \"Sindhi\",\n  si: \"Sinhala\",\n  sk: \"Slovak\",\n  sl: \"Slovenian\",\n  so: \"Somali\",\n  es: \"Spanish\",\n  su: \"Sundanese\",\n  sw: \"Swahili\",\n  sv: \"Swedish\",\n  tg: \"Tajik\",\n  ta: \"Tamil\",\n  te: \"Telugu\",\n  th: \"Thai\",\n  tr: \"Turkish\",\n  uk: \"Ukrainian\",\n  ur: \"Urdu\",\n  uz: \"Uzbek\",\n  vi: \"Vietnamese\",\n  cy: \"Welsh\",\n  xh: \"Xhosa\",\n  yi: \"Yiddish\",\n  yo: \"Yoruba\",\n  zu: \"Zulu\",\n};\nexport const bingTransList = {\n  af: \"Afrikaans\",\n  sq: \"Albanian\",\n  am: \"Amharic\",\n  ar: \"Arabic\",\n  hy: \"Armenian\",\n  as: \"Assamese\",\n  az: \"Azerbaijani\",\n  bn: \"Bangla\",\n  ba: \"Bashkir\",\n  eu: \"Basque\",\n  bs: \"Bosnian\",\n  bg: \"Bulgarian\",\n  yue: \"Cantonese (Traditional)\",\n  ca: \"Catalan\",\n  lzh: \"Chinese (Literary)\",\n  \"zh-Hans\": \"Chinese Simplified\",\n  \"zh-Hant\": \"Chinese Traditional\",\n  hr: \"Croatian\",\n  cs: \"Czech\",\n  da: \"Danish\",\n  prs: \"Dari\",\n  dv: \"Divehi\",\n  nl: \"Dutch\",\n  en: \"English\",\n  et: \"Estonian\",\n  fo: \"Faroese\",\n  fj: \"Fijian\",\n  fil: \"Filipino\",\n  fi: \"Finnish\",\n  fr: \"French\",\n  \"fr-CA\": \"French (Canada)\",\n  gl: \"Galician\",\n  ka: \"Georgian\",\n  de: \"German\",\n  el: \"Greek\",\n  gu: \"Gujarati\",\n  ht: \"Haitian Creole\",\n  he: \"Hebrew\",\n  hi: \"Hindi\",\n  mww: \"Hmong Daw\",\n  hu: \"Hungarian\",\n  is: \"Icelandic\",\n  id: \"Indonesian\",\n  ikt: \"Inuinnaqtun\",\n  iu: \"Inuktitut\",\n  \"iu-Latn\": \"Inuktitut (Latin)\",\n  ga: \"Irish\",\n  it: \"Italian\",\n  ja: \"Japanese\",\n  kn: \"Kannada\",\n  kk: \"Kazakh\",\n  km: \"Khmer\",\n  \"tlh-Latn\": \"Klingon (Latin)\",\n  ko: \"Korean\",\n  ku: \"Kurdish (Central)\",\n  kmr: \"Kurdish (Northern)\",\n  ky: \"Kyrgyz\",\n  lo: \"Lao\",\n  lv: \"Latvian\",\n  lt: \"Lithuanian\",\n  mk: \"Macedonian\",\n  mg: \"Malagasy\",\n  ms: \"Malay\",\n  ml: \"Malayalam\",\n  mt: \"Maltese\",\n  mi: \"Māori\",\n  mr: \"Marathi\",\n  \"mn-Cyrl\": \"Mongolian (Cyrillic)\",\n  \"mn-Mong\": \"Mongolian (Traditional)\",\n  my: \"Myanmar (Burmese)\",\n  ne: \"Nepali\",\n  nb: \"Norwegian\",\n  or: \"Odia\",\n  ps: \"Pashto\",\n  fa: \"Persian\",\n  pl: \"Polish\",\n  pt: \"Portuguese (Brazil)\",\n  \"pt-PT\": \"Portuguese (Portugal)\",\n  pa: \"Punjabi\",\n  otq: \"Querétaro Otomi\",\n  ro: \"Romanian\",\n  ru: \"Russian\",\n  sm: \"Samoan\",\n  \"sr-Cyrl\": \"Serbian (Cyrillic)\",\n  \"sr-Latn\": \"Serbian (Latin)\",\n  sk: \"Slovak\",\n  sl: \"Slovenian\",\n  so: \"Somali\",\n  es: \"Spanish\",\n  sw: \"Swahili\",\n  sv: \"Swedish\",\n  ty: \"Tahitian\",\n  ta: \"Tamil\",\n  tt: \"Tatar\",\n  te: \"Telugu\",\n  th: \"Thai\",\n  bo: \"Tibetan\",\n  ti: \"Tigrinya\",\n  to: \"Tongan\",\n  tr: \"Turkish\",\n  tk: \"Turkmen\",\n  uk: \"Ukrainian\",\n  hsb: \"Upper Sorbian\",\n  ur: \"Urdu\",\n  ug: \"Uyghur\",\n  uz: \"Uzbek (Latin)\",\n  vi: \"Vietnamese\",\n  cy: \"Welsh\",\n  yua: \"Yucatec Maya\",\n  zu: \"Zulu\",\n};\n","import React from \"react\";\nimport \"./popupTrans.css\";\nimport { PopupTransProps, PopupTransState } from \"./interface\";\nimport { Trans } from \"react-i18next\";\nimport {\n  googleTransList,\n  bingTransList,\n} from \"../../../constants/translationList\";\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\nclass PopupTrans extends React.Component<PopupTransProps, PopupTransState> {\n  constructor(props: PopupTransProps) {\n    super(props);\n    this.state = {\n      translatedText: \"\",\n    };\n  }\n  componentDidMount() {\n    let originalText = this.props.originalText.replace(/(\\r\\n|\\n|\\r)/gm, \"\");\n    this.handleTrans(originalText);\n  }\n  handleTrans = (text: string) => {\n    if (StorageUtil.getReaderConfig(\"transService\") === \"Bing\") {\n      const { translate } = window.require(\"bing-translate-api\");\n      translate(\n        text,\n        null,\n        StorageUtil.getReaderConfig(\"transTarget\") || \"en\",\n        false\n      )\n        .then((res) => {\n          this.setState({\n            translatedText: res.translation,\n          });\n        })\n        .catch((err) => {\n          this.setState({\n            translatedText: this.props.t(\"Error happens\"),\n          });\n        });\n    } else {\n      const translate = window.require(\"@vitalets/google-translate-api\");\n      translate(text, {\n        to: StorageUtil.getReaderConfig(\"transTarget\") || \"en\",\n      })\n        .then((res) => {\n          this.setState({\n            translatedText: res.text,\n          });\n        })\n        .catch((err) => {\n          this.setState({\n            translatedText: this.props.t(\"Error happens\"),\n          });\n        });\n    }\n  };\n  render() {\n    const renderNoteEditor = () => {\n      return (\n        <div className=\"trans-container\">\n          <div className=\"trans-text-box\">{this.state.translatedText}</div>\n          <div className=\"target-lang-container\">\n            <p className=\"general-setting-title\" style={{ display: \"inline\" }}>\n              <Trans>Select</Trans>\n            </p>\n            <select\n              className=\"booklist-shelf-list\"\n              style={{ width: \"75px\", marginLeft: \"10px\" }}\n              onChange={(event: React.ChangeEvent<HTMLSelectElement>) => {\n                StorageUtil.setReaderConfig(\"transService\", event.target.value);\n                StorageUtil.setReaderConfig(\"transTarget\", \"en\");\n                this.handleTrans(\n                  this.props.originalText.replace(/(\\r\\n|\\n|\\r)/gm, \"\")\n                );\n              }}\n            >\n              {[\"Google\", \"Bing\"].map((item, index) => {\n                return (\n                  <option\n                    value={item}\n                    key={index}\n                    className=\"add-dialog-shelf-list-option\"\n                    selected={\n                      StorageUtil.getReaderConfig(\"transService\") === item\n                        ? true\n                        : false\n                    }\n                  >\n                    {item}\n                  </option>\n                );\n              })}\n            </select>\n            <select\n              className=\"booklist-shelf-list\"\n              style={{ width: \"75px\", marginLeft: \"10px\" }}\n              onChange={(event: React.ChangeEvent<HTMLSelectElement>) => {\n                let targetLang = event.target.value;\n                StorageUtil.setReaderConfig(\"transTarget\", targetLang);\n                this.handleTrans(\n                  this.props.originalText.replace(/(\\r\\n|\\n|\\r)/gm, \"\")\n                );\n              }}\n            >\n              {(StorageUtil.getReaderConfig(\"transService\") === \"Google\"\n                ? Object.keys(googleTransList)\n                : Object.keys(bingTransList)\n              ).map((item, index) => {\n                return (\n                  <option\n                    value={item}\n                    key={index}\n                    className=\"add-dialog-shelf-list-option\"\n                    selected={\n                      StorageUtil.getReaderConfig(\"transTarget\") === item\n                        ? true\n                        : false\n                    }\n                  >\n                    {\n                      (StorageUtil.getReaderConfig(\"transService\") === \"Google\"\n                        ? Object.values(googleTransList)\n                        : Object.values(bingTransList))[index]\n                    }\n                  </option>\n                );\n              })}\n            </select>\n          </div>\n        </div>\n      );\n    };\n    return renderNoteEditor();\n  }\n}\nexport default PopupTrans;\n","import { connect } from \"react-redux\";\nimport { handleOpenMenu, handleMenuMode } from \"../../../store/actions\";\nimport { stateType } from \"../../../store\";\nimport { withTranslation } from \"react-i18next\";\nimport PopupTrans from \"./component\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    originalText: state.reader.originalText,\n  };\n};\nconst actionCreator = {\n  handleOpenMenu,\n  handleMenuMode,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(PopupTrans as any));\n","import React from \"react\";\nimport \"./popupMenu.css\";\nimport PopupNote from \"../popupNote\";\nimport PopupOption from \"../popupOption\";\nimport PopupTrans from \"../popupTrans\";\nimport { PopupMenuProps, PopupMenuStates } from \"./interface\";\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\nimport {\n  getIframeDoc,\n  getPDFIframeDoc,\n} from \"../../../utils/serviceUtils/docUtil\";\nlet colors = [\"#fac106\", \"#ebe702\", \"#0be603\", \"#0493e6\"];\nlet lines = [\"#FF0000\", \"#000080\", \"#0000FF\", \"#2EFF2E\"];\n\ndeclare var window: any;\n\nclass PopupMenu extends React.Component<PopupMenuProps, PopupMenuStates> {\n  highlighter: any;\n  timer!: NodeJS.Timeout;\n  key: any;\n  mode: string;\n  showNote: boolean;\n  isFirstShow: boolean;\n  rect: any;\n  constructor(props: PopupMenuProps) {\n    super(props);\n    this.showNote = false;\n    this.isFirstShow = false;\n    this.highlighter = null;\n    this.mode = \"\";\n    this.state = {\n      deleteKey: \"\",\n      rect: this.props.rect,\n    };\n  }\n\n  componentDidMount() {\n    this.props.rendition.on(\"rendered\", () => {\n      setTimeout(() => {\n        this.handleRenderHighlight();\n        this.props.handleRenderNoteFunc(this.handleRenderHighlight);\n      }, 500);\n    });\n  }\n  UNSAFE_componentWillReceiveProps(nextProps: PopupMenuProps) {\n    if (nextProps.rect !== this.props.rect) {\n      this.setState(\n        {\n          rect: nextProps.rect,\n        },\n        () => {\n          this.openMenu();\n        }\n      );\n    }\n  }\n  handleRenderHighlight = () => {\n    new Promise<void>((resolve, reject) => {\n      this.getHighlighter();\n      resolve();\n    }).then(() => {\n      this.renderHighlighters();\n    });\n    let doc = getIframeDoc();\n    if (!doc) return;\n    doc.addEventListener(\"mousedown\", this.openMenu);\n    doc.addEventListener(\"touchend\", this.openMenu);\n    if (this.props.currentBook.format === \"PDF\") {\n      setTimeout(() => {\n        this.renderHighlighters();\n      }, 1000);\n\n      doc.addEventListener(\"wheel\", () => {\n        this.renderHighlighters();\n      });\n    }\n  };\n  //新建高亮\n  getHighlighter = () => {\n    let doc = getIframeDoc();\n    if (!doc) return;\n    this.highlighter = window.rangy.createHighlighter(doc);\n    let classes = [\n      \"color-0\",\n      \"color-1\",\n      \"color-2\",\n      \"color-3\",\n      \"line-0\",\n      \"line-1\",\n      \"line-2\",\n      \"line-3\",\n    ];\n    classes.forEach((item) => {\n      let config = {\n        ignoreWhiteSpace: true,\n        elementTagName: \"span\",\n        elementProperties: {\n          onclick: this.handleNoteClick,\n        },\n        onElementCreate: (element: any) => {\n          element.dataset.key =\n            this.key || this.props.notes[this.props.notes.length - 1].key;\n        },\n      };\n      let applier = window.rangy.createClassApplier(item, config);\n      this.highlighter.addClassApplier(applier);\n    });\n  };\n  handleNoteClick = (event: any) => {\n    let doc = getIframeDoc();\n    if (!doc) return;\n    this.props.handleMenuMode(\"note\");\n    let sel = doc.getSelection();\n    if (!sel) return;\n    let range = sel.getRangeAt(0);\n    sel.removeAllRanges();\n    sel.addRange(range);\n    this.setState({ rect: range.getBoundingClientRect() }, () => {\n      this.showMenu();\n      this.handleClickHighlighter(event.currentTarget.dataset.key);\n      event.stopPropagation();\n    });\n  };\n  handlePDFClick = (event: any) => {\n    this.props.handleMenuMode(\"note\");\n    this.setState({ rect: event.currentTarget.getBoundingClientRect() }, () => {\n      this.showMenu();\n      this.handleClickHighlighter(event.currentTarget.getAttribute(\"key\"));\n      event.stopPropagation();\n    });\n  };\n\n  showPDFHighlight = (selected: any, colorCode: string, noteKey: string) => {\n    let iWin = getPDFIframeDoc();\n    if (!iWin) return;\n    var pageIndex = selected.page;\n    if (!iWin.PDFViewerApplication.pdfViewer) return;\n    var page = iWin.PDFViewerApplication.pdfViewer.getPageView(pageIndex);\n    if (page && page.div && page.textLayer && page.textLayer.textLayerDiv) {\n      var pageElement =\n        colorCode.indexOf(\"color\") > -1\n          ? page.textLayer.textLayerDiv\n          : page.div;\n\n      var viewport = page.viewport;\n      selected.coords.forEach((rect) => {\n        var bounds = viewport.convertToViewportRectangle(rect);\n        var el = iWin.document.createElement(\"div\");\n\n        el?.setAttribute(\n          \"style\",\n          \"position: absolute;\" +\n            (colorCode.indexOf(\"color\") > -1\n              ? \"background-color: \"\n              : \"border-bottom: \") +\n            (colorCode.indexOf(\"color\") > -1\n              ? colors[colorCode.split(\"-\")[1]]\n              : `2px solid ${lines[colorCode.split(\"-\")[1]]}`) +\n            \"; left:\" +\n            Math.min(bounds[0], bounds[2]) +\n            \"px; top:\" +\n            Math.min(bounds[1], bounds[3]) +\n            \"px;\" +\n            \"width:\" +\n            Math.abs(bounds[0] - bounds[2]) +\n            \"px; height:\" +\n            Math.abs(bounds[1] - bounds[3]) +\n            \"px; z-index:0;\"\n        );\n        el?.setAttribute(\"key\", noteKey);\n        el?.setAttribute(\"class\", \"pdf-note\");\n        el?.addEventListener(\"click\", (event: any) => {\n          this.handlePDFClick(event);\n        });\n\n        pageElement.appendChild(el);\n      });\n    }\n  };\n\n  handleClickHighlighter = (key: string) => {\n    let dialog: HTMLInputElement | null = document.querySelector(\".editor-box\");\n    if (!dialog) return;\n    let note = this.props.notes.filter((item) => item.key === key)[0];\n    if (note && note.notes) {\n      dialog.value = note.notes;\n    }\n    dialog?.focus();\n    this.props.handleNoteKey(key);\n  };\n  handleShowDelete = (deleteKey: string) => {\n    this.setState({ deleteKey });\n  };\n  showMenu = () => {\n    let rect = this.state.rect;\n    if (!rect) return;\n    this.props.handleChangeDirection(false);\n    let page: any = { offsetLeft: 0 };\n    if (this.props.currentBook.format !== \"PDF\") {\n      page = document.getElementById(\"page-area\");\n      if (!page.clientWidth) return;\n    }\n\n    let height = 200;\n    let x =\n      this.props.currentBook.format === \"PDF\"\n        ? rect.left\n        : StorageUtil.getReaderConfig(\"readerMode\") === \"single\"\n        ? (rect.x % this.props.pageWidth) + page.offsetLeft\n        : StorageUtil.getReaderConfig(\"readerMode\") === \"scroll\"\n        ? rect.left + page.offsetLeft\n        : rect.x % this.props.pageWidth;\n    let y = rect.y % this.props.pageHeight;\n    let posX = x + rect.width / 2 - 20;\n    //防止menu超出图书\n    let rightEdge =\n      this.props.menuMode === \"note\" || this.props.menuMode === \"trans\"\n        ? this.props.pageWidth - 310 + page.offsetLeft * 2\n        : this.props.pageWidth - 200 + page.offsetLeft * 2;\n    let posY: number;\n    //控制menu方向\n    if (y < height) {\n      this.props.handleChangeDirection(true);\n      posY = y + 67;\n    } else {\n      posY = y - height / 2 - 57;\n    }\n    posX = posX > rightEdge ? rightEdge : posX;\n    this.props.handleOpenMenu(true);\n    let popupMenu = document.querySelector(\".popup-menu-container\");\n    popupMenu?.setAttribute(\"style\", `left:${posX}px;top:${posY}px`);\n    this.setState({ rect: null });\n  };\n  //渲染高亮\n  renderHighlighters = async () => {\n    let highlighters: any = this.props.notes;\n    if (!highlighters) return;\n    let highlightersByChapter = highlighters.filter((item: any) => {\n      return (\n        (item.chapterIndex === this.props.chapterIndex ||\n          item.chapter === this.props.chapter) &&\n        item.bookKey === this.props.currentBook.key\n      );\n    });\n    let pageArea = document.getElementById(\"page-area\");\n    if (!pageArea) return;\n    let iframe = pageArea.getElementsByTagName(\"iframe\")[0];\n    if (!iframe || !iframe.contentWindow) return;\n    let iWin = iframe.contentWindow || iframe.contentDocument?.defaultView;\n    this.highlighter && this.highlighter.removeAllHighlights(); // 为了避免下次反序列化失败，必须先清除已有的高亮\n    let classes = [\n      \"color-0\",\n      \"color-1\",\n      \"color-2\",\n      \"color-3\",\n      \"line-0\",\n      \"line-1\",\n      \"line-2\",\n      \"line-3\",\n    ];\n    highlightersByChapter &&\n      highlightersByChapter.forEach((item: any) => {\n        this.key = item.key;\n        //控制渲染指定图书的指定高亮\n        if (item.bookKey === this.props.currentBook.key) {\n          try {\n            if (this.props.currentBook.format === \"PDF\") {\n              this.showPDFHighlight(\n                JSON.parse(item.range),\n                classes[item.color],\n                item.key\n              );\n            } else {\n              let temp = JSON.parse(item.range);\n              temp = [temp];\n              let doc = iframe.contentDocument;\n              window.rangy\n                .getSelection(iframe)\n                .restoreCharacterRanges(doc, temp);\n              this.highlighter.highlightSelection(classes[item.color]);\n            }\n          } catch (e) {\n            console.warn(\n              e,\n              \"Exception has been caught when restore character ranges.\"\n            );\n            return;\n          }\n        }\n      });\n    this.key = \"\";\n    if (!iWin || !iWin.getSelection()) return;\n    iWin.getSelection()?.empty(); // 清除文本选取\n    // this.props.isOpenMenu &&\n    //   window.rangy.deserializeSelection(serial, null, iWin); // （为了选取文本后不被上一行代码清除掉）恢复原本的文本选取\n  };\n  //控制弹窗\n  openMenu = () => {\n    this.setState({ deleteKey: \"\" });\n    let pageArea = document.getElementById(\"page-area\");\n    if (!pageArea) return;\n    let iframe = pageArea.getElementsByTagName(\"iframe\")[0];\n    if (!iframe) return;\n    let doc = iframe.contentDocument;\n    if (!doc) return;\n    let sel = doc.getSelection();\n    this.props.handleChangeDirection(false);\n    // 如果 popmenu正在被展示，则隐藏\n    if (this.props.isOpenMenu) {\n      this.props.handleMenuMode(\"menu\");\n      this.props.handleOpenMenu(false);\n      this.props.handleNoteKey(\"\");\n    }\n    if (!sel) return;\n    // 使弹出菜单更加灵活可控;\n    if (sel.isCollapsed) {\n      this.props.isOpenMenu && this.props.handleOpenMenu(false);\n      this.props.handleMenuMode(\"menu\");\n      this.props.handleNoteKey(\"\");\n      return;\n    }\n    this.showMenu();\n    this.props.handleMenuMode(\"menu\");\n  };\n  //添加高亮\n  handleHighlight() {\n    let pageArea = document.getElementById(\"page-area\");\n    if (!pageArea) return;\n    let iframe = pageArea.getElementsByTagName(\"iframe\")[0];\n    if (!iframe) return;\n    let doc = iframe.contentDocument;\n    if (!doc) return;\n    let color = this.props.color;\n    let classes = [\n      \"color-0\",\n      \"color-1\",\n      \"color-2\",\n      \"color-3\",\n      \"line-0\",\n      \"line-1\",\n      \"line-2\",\n      \"line-3\",\n    ];\n    if (!this.highlighter) return;\n    this.highlighter.highlightSelection(classes[color]);\n    this.props.handleMenuMode(\"menu\");\n    this.props.handleOpenMenu(false);\n\n    doc.getSelection()?.empty();\n    this.props.handleMenuMode(\"menu\");\n    this.highlighter && this.highlighter.removeAllHighlights();\n    new Promise<void>((resolve) => {\n      this.getHighlighter();\n      resolve();\n    }).then(() => {\n      this.renderHighlighters();\n    });\n  }\n  render() {\n    if (this.props.menuMode === \"highlight\") {\n      // this.getHighlighter();\n      this.handleHighlight();\n    }\n    const PopupProps = {\n      pageWidth: this.props.pageWidth,\n      pageHeight: this.props.pageHeight,\n      chapterIndex: this.props.chapterIndex,\n      chapter: this.props.chapter,\n    };\n    return (\n      <div>\n        <div\n          className=\"popup-menu-container\"\n          style={this.props.isOpenMenu ? {} : { display: \"none\" }}\n        >\n          <div className=\"popup-menu-box\">\n            {this.props.menuMode === \"menu\" ? (\n              <PopupOption {...PopupProps} />\n            ) : this.props.menuMode === \"note\" ? (\n              <PopupNote {...PopupProps} />\n            ) : this.props.menuMode === \"trans\" ? (\n              <PopupTrans {...PopupProps} />\n            ) : null}\n            <span\n              className=\"icon-close popup-close\"\n              onClick={() => {\n                this.props.handleOpenMenu(false);\n              }}\n              style={this.props.isChangeDirection ? { top: \"180px\" } : {}}\n            ></span>\n          </div>\n          {this.props.isChangeDirection ? (\n            <span\n              className=\"icon-popup popup-menu-triangle-up\"\n              style={\n                this.props.menuMode === \"highlight\" ? { bottom: \"110px\" } : {}\n              }\n            ></span>\n          ) : (\n            <span className=\"icon-popup popup-menu-triangle-down\"></span>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default PopupMenu;\n","import {\n  handleSelection,\n  handleOpenMenu,\n  handleMenuMode,\n  handleChangeDirection,\n  handleNoteKey,\n  handleRenderNoteFunc,\n} from \"../../../store/actions\";\nimport { connect } from \"react-redux\";\nimport { stateType } from \"../../../store\";\nimport PopupMenu from \"./component\";\nimport { withTranslation } from \"react-i18next\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    digests: state.reader.digests,\n    notes: state.reader.notes,\n    noteKey: state.reader.noteKey,\n    currentBook: state.book.currentBook,\n    isOpenMenu: state.viewArea.isOpenMenu,\n    menuMode: state.viewArea.menuMode,\n    color: state.reader.color,\n    isChangeDirection: state.viewArea.isChangeDirection,\n  };\n};\nconst actionCreator = {\n  handleSelection,\n  handleOpenMenu,\n  handleMenuMode,\n  handleChangeDirection,\n  handleNoteKey,\n  handleRenderNoteFunc,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(PopupMenu));\n","import React from \"react\";\nimport { Trans } from \"react-i18next\";\nimport { DeletePopupProps } from \"./interface\";\nimport toast from \"react-hot-toast\";\nclass DeletePopup extends React.Component<DeletePopupProps> {\n  handleCancel = () => {\n    this.props.handleDeletePopup(false);\n  };\n  handleComfirm = () => {\n    //从列表删除和从图书库删除判断\n    this.props.handleDeletePopup(false);\n    this.props.handleDeleteOpearion();\n    toast.success(this.props.t(\"Delete Successfully\"));\n  };\n  render() {\n    return (\n      <div className=\"delete-dialog-container\">\n        <div className=\"delete-dialog-title\">\n          <Trans>{this.props.title}</Trans>\n        </div>\n\n        <div className=\"delete-dialog-book\">\n          <div className=\"delete-dialog-book-title\">{this.props.name}</div>\n        </div>\n\n        <div className=\"delete-dialog-other-option\">\n          <Trans>{this.props.description}</Trans>\n        </div>\n\n        <div\n          className=\"delete-dialog-cancel\"\n          onClick={() => {\n            this.handleCancel();\n          }}\n        >\n          <Trans>Cancel</Trans>\n        </div>\n        <div\n          className=\"delete-dialog-comfirm\"\n          onClick={() => {\n            this.handleComfirm();\n          }}\n        >\n          <Trans>Delete</Trans>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default DeletePopup;\n","import { connect } from \"react-redux\";\nimport { handleFetchBooks } from \"../../../store/actions\";\nimport { stateType } from \"../../../store\";\nimport { withTranslation } from \"react-i18next\";\nimport DeletePopup from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {};\n};\nconst actionCreator = {\n  handleFetchBooks,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(DeletePopup as any) as any);\n","import StorageUtil from \"./storageUtil\";\nimport Chinese from \"chinese-s2t\";\nimport { getIframeDoc } from \"./docUtil\";\nexport const tsTransform = () => {\n  let doc = getIframeDoc();\n  if (!doc) return;\n  if (\n    StorageUtil.getReaderConfig(\"convertChinese\") &&\n    StorageUtil.getReaderConfig(\"convertChinese\") !== \"Default\"\n  ) {\n    if (\n      StorageUtil.getReaderConfig(\"convertChinese\") ===\n      \"Simplified To Traditional\"\n    ) {\n      doc.querySelectorAll(\"p\").forEach((item) => {\n        item.innerHTML = item.innerHTML\n          .split(\"\")\n          .map((item) => Chinese.s2t(item))\n          .join(\"\");\n        // item.innerHTML = item.innerHTML.replace(\n        //   item.innerText,\n        //   Chinese.s2t(item.innerText)\n        // );\n      });\n    } else {\n      doc.querySelectorAll(\"p\").forEach((item) => {\n        item.innerHTML = item.innerHTML\n          .split(\"\")\n          .map((item) => Chinese.t2s(item))\n          .join(\"\");\n      });\n    }\n  }\n};\n","import _ from \"underscore\";\n\nclass RecordLocation {\n  static recordCfi(bookKey: string, cfi: string, percentage: number) {\n    let json = localStorage.getItem(\"recordLocation\");\n    let obj = JSON.parse(json || \"{}\");\n    obj[bookKey] = { cfi: cfi, percentage: percentage };\n    localStorage.setItem(\"recordLocation\", JSON.stringify(obj));\n  }\n\n  static getCfi(bookKey: string) {\n    let json = localStorage.getItem(\"recordLocation\");\n    let obj = JSON.parse(json || \"{}\");\n    return obj[bookKey] || {};\n  }\n  static recordHtmlLocation(\n    bookKey: string,\n    text: string,\n    chapterTitle: string,\n    count: string,\n    percentage: string,\n    cfi: string = \"\"\n  ) {\n    if (cfi) {\n      let json = localStorage.getItem(\"recordLocation\");\n      let obj = JSON.parse(json || \"{}\");\n      obj[bookKey] = { text, chapterTitle, count, percentage, cfi };\n      localStorage.setItem(\"recordLocation\", JSON.stringify(obj));\n    } else {\n      if (\n        (!text || !chapterTitle || !count || !percentage) &&\n        document.location.href.indexOf(\"/cb\") === -1 //漫画的情况，cbr,cbt,cbz\n      )\n        return;\n      let json = localStorage.getItem(\"recordLocation\");\n      let obj = JSON.parse(json || \"{}\");\n      obj[bookKey] = { text, chapterTitle, count, percentage, cfi };\n      localStorage.setItem(\"recordLocation\", JSON.stringify(obj));\n    }\n  }\n\n  static getHtmlLocation(bookKey: string) {\n    let json = localStorage.getItem(\"recordLocation\");\n    let obj = JSON.parse(json || \"{}\");\n    return obj[bookKey] || {};\n  }\n  static getPDFLocation(fingerprint: string) {\n    let json = localStorage.getItem(\"pdfjs.history\");\n    let arr = JSON.parse(json || \"{}\").files || [];\n    return arr[_.findLastIndex(arr, { fingerprint })] || {};\n  }\n  static recordPDFLocation(fingerprint: string, obj: object) {\n    let json = localStorage.getItem(\"pdfjs.history\");\n    let _obj = JSON.parse(json || \"{}\");\n    _obj.files[_.findLastIndex(_obj.files, { fingerprint })] = obj;\n    localStorage.setItem(\"pdfjs.history\", JSON.stringify(_obj));\n  }\n  static getAllCfi() {\n    let json = localStorage.getItem(\"recordLocation\");\n    let obj = JSON.parse(json || \"{}\");\n    return obj;\n  }\n  static clear(bookKey: string) {\n    let json = localStorage.getItem(\"recordLocation\");\n    let obj = JSON.parse(json || \"{}\");\n    delete obj[bookKey];\n    localStorage.setItem(\"recordLocation\", JSON.stringify(obj));\n  }\n}\n\nexport default RecordLocation;\n","import StorageUtil from \"../serviceUtils/storageUtil\";\nimport { isElectron } from \"react-device-detect\";\nimport localforage from \"localforage\";\nimport BookModel from \"../../model/Book\";\nimport toast from \"react-hot-toast\";\nimport { getPDFCover } from \"./pdfUtil\";\nimport chardet from \"chardet\";\nimport iconv from \"iconv-lite\";\nimport { xmlMetadata } from \"./xmlUtil\";\n// import { base64ArrayBuffer } from \"./coverUtil\";\ndeclare var window: any;\nconst { MobiRender, Azw3Render, EpubRender } = window.Kookit;\n\n// let Unrar = window.Unrar;\nclass BookUtil {\n  static addBook(key: string, buffer: ArrayBuffer) {\n    if (isElectron) {\n      const fs = window.require(\"fs\");\n      const path = window.require(\"path\");\n      const dataPath = localStorage.getItem(\"storageLocation\")\n        ? localStorage.getItem(\"storageLocation\")\n        : window\n            .require(\"electron\")\n            .ipcRenderer.sendSync(\"storage-location\", \"ping\");\n      return new Promise<void>((resolve, reject) => {\n        var reader = new FileReader();\n        reader.readAsArrayBuffer(new Blob([buffer]));\n        reader.onload = async (event) => {\n          if (!event.target) return;\n          try {\n            if (!fs.existsSync(path.join(dataPath, \"book\"))) {\n              fs.mkdirSync(path.join(dataPath, \"book\"));\n            }\n            fs.writeFileSync(\n              path.join(dataPath, \"book\", key),\n              Buffer.from(event.target.result as any)\n            );\n            resolve();\n          } catch (error) {\n            reject();\n            throw error;\n          }\n        };\n        reader.onerror = () => {\n          reject();\n        };\n      });\n    } else {\n      return localforage.setItem(key, buffer);\n    }\n  }\n  static deleteBook(key: string) {\n    if (isElectron) {\n      const fs_extra = window.require(\"fs-extra\");\n      const path = window.require(\"path\");\n      const dataPath = localStorage.getItem(\"storageLocation\")\n        ? localStorage.getItem(\"storageLocation\")\n        : window\n            .require(\"electron\")\n            .ipcRenderer.sendSync(\"storage-location\", \"ping\");\n      return new Promise<void>((resolve, reject) => {\n        try {\n          fs_extra.remove(path.join(dataPath, `book`, key), (err) => {\n            if (err) throw err;\n            resolve();\n          });\n        } catch (e) {\n          reject();\n        }\n      });\n    } else {\n      return localforage.removeItem(key);\n    }\n  }\n  static isBookExist(key: string, bookPath: string = \"\") {\n    return new Promise<boolean>((resolve, reject) => {\n      if (isElectron) {\n        var fs = window.require(\"fs\");\n        var path = window.require(\"path\");\n        let _bookPath = path.join(\n          localStorage.getItem(\"storageLocation\")\n            ? localStorage.getItem(\"storageLocation\")\n            : window\n                .require(\"electron\")\n                .ipcRenderer.sendSync(\"storage-location\", \"ping\"),\n          `book`,\n          key\n        );\n\n        if ((bookPath && fs.existsSync(bookPath)) || fs.existsSync(_bookPath)) {\n          resolve(true);\n        } else {\n          resolve(false);\n        }\n      } else {\n        localforage.getItem(key).then((result) => {\n          if (result) {\n            resolve(true);\n          } else {\n            resolve(false);\n          }\n        });\n      }\n    });\n  }\n  static fetchBook(\n    key: string,\n    isArrayBuffer: boolean = false,\n    bookPath: string = \"\"\n  ) {\n    if (isElectron) {\n      return new Promise<File | ArrayBuffer | boolean>((resolve, reject) => {\n        var fs = window.require(\"fs\");\n        var path = window.require(\"path\");\n        let _bookPath = path.join(\n          localStorage.getItem(\"storageLocation\")\n            ? localStorage.getItem(\"storageLocation\")\n            : window\n                .require(\"electron\")\n                .ipcRenderer.sendSync(\"storage-location\", \"ping\"),\n          `book`,\n          key\n        );\n        var data;\n        if (bookPath && fs.existsSync(bookPath)) {\n          data = fs.readFileSync(bookPath);\n        } else if (fs.existsSync(_bookPath)) {\n          data = fs.readFileSync(_bookPath);\n        } else {\n          resolve(false);\n        }\n\n        let blobTemp = new Blob([data]);\n        let fileTemp = new File([blobTemp], \"data\", {\n          lastModified: new Date().getTime(),\n          type: blobTemp.type,\n        });\n        if (isArrayBuffer) {\n          resolve(new Uint8Array(data).buffer);\n        } else {\n          resolve(fileTemp);\n        }\n      });\n    } else {\n      return localforage.getItem(key);\n    }\n  }\n  static async RedirectBook(book: BookModel) {\n    if (!(await this.isBookExist(book.key, book.path))) {\n      toast.error(\"Book not exist\");\n      return;\n    }\n    let ref = book.format.toLowerCase();\n\n    if (isElectron) {\n      const { ipcRenderer } = window.require(\"electron\");\n      ipcRenderer.invoke(\"open-book\", {\n        url: `${window.location.href.split(\"#\")[0]}#/${ref}/${book.key}`,\n        isMergeWord:\n          book.format === \"PDF\" || book.format === \"DJVU\"\n            ? \"no\"\n            : StorageUtil.getReaderConfig(\"isMergeWord\"),\n        isFullscreen: StorageUtil.getReaderConfig(\"isAutoFullscreen\"),\n        isPreventSleep: StorageUtil.getReaderConfig(\"isPreventSleep\"),\n      });\n    } else {\n      window.open(\n        `${window.location.href.split(\"#\")[0]}#/${ref}/${book.key}?title=${\n          book.name\n        }`\n      );\n    }\n  }\n  static getBookUrl(book: BookModel) {\n    let ref = book.format.toLowerCase();\n    return `/${ref}/${book.key}`;\n  }\n  static getPDFUrl(book: BookModel) {\n    if (isElectron) {\n      const path = window.require(\"path\");\n      const { ipcRenderer } = window.require(\"electron\");\n      localStorage.setItem(\"pdfPath\", book.path);\n      const __dirname = ipcRenderer.sendSync(\"get-dirname\", \"ping\");\n      let pdfLocation =\n        document.URL.indexOf(\"localhost\") > -1\n          ? \"http://localhost:3000/\"\n          : `file://${path.join(\n              __dirname,\n              \"./build\",\n              \"lib\",\n              \"pdf\",\n              \"web\",\n              \"viewer.html\"\n            )}`;\n      let url = `${\n        window.navigator.platform.indexOf(\"Win\") > -1\n          ? \"lib/pdf/web/\"\n          : \"lib\\\\pdf\\\\web\\\\\"\n      }viewer.html?file=${book.key}`;\n      return document.URL.indexOf(\"localhost\") > -1\n        ? pdfLocation + url\n        : `${pdfLocation}?file=${book.key}`;\n    } else {\n      return `./lib/pdf/web/viewer.html?file=${book.key}`;\n    }\n  }\n  static generateBook(\n    bookName: string,\n    extension: string,\n    md5: string,\n    size: number,\n    path: string,\n    file_content: ArrayBuffer\n  ) {\n    return new Promise<BookModel | string>(async (resolve, reject) => {\n      let cover: any = \"\";\n      let key: string,\n        name: string,\n        author: string,\n        publisher: string,\n        description: string,\n        charset: string;\n      [name, author, description, publisher, charset] = [\n        bookName,\n        \"Unknown Author\",\n        \"\",\n        \"\",\n        \"\",\n      ];\n      switch (extension) {\n        case \"pdf\":\n          cover = await getPDFCover(file_content);\n          if (cover.indexOf(\"image\") === -1) {\n            cover = \"\";\n          }\n          break;\n        case \"epub\":\n          let epubRendition = new EpubRender(\n            file_content,\n            \"scroll\",\n            StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\n          );\n          let metadata = await epubRendition.getMetadata();\n          if (metadata === \"timeout_error\") {\n            resolve(\"get_metadata_error\");\n            break;\n          } else if (!metadata.title) {\n            break;\n          }\n\n          [name, author, description, publisher, cover] = [\n            metadata.title,\n            metadata.creator,\n            metadata.description,\n            metadata.publisher,\n            metadata.cover,\n          ];\n          if (cover.indexOf(\"image\") === -1) {\n            cover = \"\";\n          }\n          break;\n        case \"mobi\":\n          let mobiRendition = new MobiRender(\n            file_content,\n            \"scroll\",\n            StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\n          );\n          if (mobiRendition.getMetadata().compression === 17480) {\n            resolve(\"parse_kindle_error\");\n          }\n          break;\n        case \"azw3\":\n          let azw3Rendition = new Azw3Render(\n            file_content,\n            \"scroll\",\n            StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\n          );\n          if (azw3Rendition.getMetadata().compression === 17480) {\n            resolve(\"parse_kindle_error\");\n          }\n          break;\n        case \"fb2\":\n          charset = chardet.detect(Buffer.from(file_content)) || \"\";\n          let fb2Str = iconv.decode(\n            Buffer.from(file_content),\n            charset || \"utf8\"\n          );\n          let fb2Obj: any = await xmlMetadata(fb2Str);\n          cover = fb2Obj.cover;\n          name = fb2Obj.name;\n          author = fb2Obj.author;\n          break;\n        // case \"cbr\":\n        //   let unrar = new Unrar(file_content);\n        //   let buffer = unrar.decompress(\n        //     unrar.getEntries().map((item: any) => item.name)[0]\n        //   );\n        //   cover = base64ArrayBuffer(buffer);\n        //   break;\n\n        default:\n          break;\n      }\n\n      let format = extension.toUpperCase();\n      key = new Date().getTime() + \"\";\n      resolve(\n        new BookModel(\n          key,\n          name,\n          author,\n          description,\n          md5,\n          cover,\n          format,\n          publisher,\n          size,\n          path,\n          charset\n        )\n      );\n    });\n  }\n}\n\nexport default BookUtil;\n","import StorageUtil from \"./storageUtil\";\nimport RecordLocation from \"../readUtils/recordLocation\";\nimport { isElectron } from \"react-device-detect\";\nimport { getIframeDoc } from \"./docUtil\";\nlet Hammer = (window as any).Hammer;\ndeclare var document: any;\nconst sleep = (ms: number) => {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n};\n\nlet throttleTime =\n  StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? 1000 : 100;\nexport const getSelection = () => {\n  let doc = getIframeDoc();\n  if (!doc) return;\n  let sel = doc.getSelection();\n  if (!sel) return;\n  let text = sel.toString();\n  text = text && text.trim();\n  return text || \"\";\n};\nlet lock = false; //prevent from clicking too fasts\nconst arrowKeys = (rendition: any, keyCode: number, event: any) => {\n  if (\n    document.querySelector(\".editor-box\") ||\n    document.querySelector(\".navigation-search-title\")\n  ) {\n    return;\n  }\n\n  if (lock) return;\n  if (keyCode === 37 || keyCode === 38) {\n    event.preventDefault();\n    rendition.prev();\n\n    lock = true;\n    setTimeout(function () {\n      lock = false;\n    }, throttleTime);\n    return false;\n  }\n  if (keyCode === 39 || keyCode === 40 || keyCode === 32) {\n    event.preventDefault();\n    rendition.next();\n    lock = true;\n    setTimeout(function () {\n      lock = false;\n    }, throttleTime);\n    return false;\n  }\n  handleShortcut(event, keyCode);\n};\n\nconst mouseChrome = (rendition: any, deltaY: number) => {\n  if (lock) return;\n  if (deltaY < 0) {\n    rendition.prev();\n    lock = true;\n    setTimeout(function () {\n      lock = false;\n    }, throttleTime);\n    return false;\n  }\n  if (deltaY > 0) {\n    rendition.next();\n    lock = true;\n    setTimeout(function () {\n      lock = false;\n    }, throttleTime);\n    return false;\n  }\n};\n\nconst handleShortcut = (event: any, keyCode: number) => {\n  if (keyCode === 9) {\n    if (isElectron) {\n      event.preventDefault();\n      window.require(\"electron\").ipcRenderer.invoke(\"hide-reader\", \"ping\");\n    }\n  }\n  if (keyCode === 27) {\n    if (isElectron) {\n      StorageUtil.setReaderConfig(\"isFullscreen\", \"no\");\n    }\n  }\n  if (keyCode === 122) {\n    if (isElectron) {\n      event.preventDefault();\n      if (StorageUtil.getReaderConfig(\"isFullscreen\") === \"yes\") {\n        window\n          .require(\"electron\")\n          .ipcRenderer.invoke(\"exit-fullscreen\", \"ping\");\n        StorageUtil.setReaderConfig(\"isFullscreen\", \"no\");\n      } else {\n        window\n          .require(\"electron\")\n          .ipcRenderer.invoke(\"enter-fullscreen\", \"ping\");\n        StorageUtil.setReaderConfig(\"isFullscreen\", \"yes\");\n      }\n    }\n  }\n  if (keyCode === 123) {\n    if (isElectron) {\n      event.preventDefault();\n      StorageUtil.setReaderConfig(\n        \"isMergeWord\",\n        StorageUtil.getReaderConfig(\"isMergeWord\") === \"yes\" ? \"no\" : \"yes\"\n      );\n      window.require(\"electron\").ipcRenderer.invoke(\"switch-moyu\", \"ping\");\n    }\n  }\n  lock = true;\n  setTimeout(function () {\n    lock = false;\n  }, throttleTime);\n  return false;\n};\n\nconst gesture = (rendition: any, type: string) => {\n  if (lock) return;\n  if (type === \"panleft\" || type === \"panup\") {\n    rendition.next();\n    lock = true;\n    setTimeout(function () {\n      lock = false;\n    }, throttleTime);\n    return false;\n  }\n  if (type === \"panright\" || type === \"pandown\") {\n    rendition.prev();\n    lock = true;\n    setTimeout(function () {\n      lock = false;\n    }, throttleTime);\n    return false;\n  }\n};\n\nconst handleLocation = async (key: string, rendition: any) => {\n  let position = await rendition.getPosition();\n  RecordLocation.recordHtmlLocation(\n    key,\n    position.text,\n    position.chapterTitle,\n    position.count,\n    position.percentage,\n    position.cfi\n  );\n};\nexport const bindHtmlEvent = (\n  rendition: any,\n  doc: any,\n  key: string = \"\",\n  readerMode: string = \"\"\n) => {\n  doc.addEventListener(\"keydown\", async (event) => {\n    arrowKeys(rendition, event.keyCode, event);\n    await handleLocation(key, rendition);\n  });\n  //判断是否正在使用笔记本电脑的的触控板\n\n  doc.addEventListener(\n    \"wheel\",\n    async (event) => {\n      if (readerMode === \"scroll\") {\n        await sleep(200);\n        rendition.record();\n      } else {\n        Math.abs(event.deltaX) === 0 && mouseChrome(rendition, event.deltaY);\n      }\n\n      await handleLocation(key, rendition);\n    },\n    false\n  );\n\n  window.addEventListener(\"keydown\", async (event) => {\n    arrowKeys(rendition, event.keyCode, event);\n    //使用Key判断是否是htmlBook\n\n    await handleLocation(key, rendition);\n  });\n\n  if (StorageUtil.getReaderConfig(\"isTouch\") === \"yes\") {\n    const mc = new Hammer(doc);\n    mc.on(\"panleft panright panup pandown\", async (event: any) => {\n      gesture(rendition, event.type);\n\n      await handleLocation(key, rendition);\n    });\n  }\n};\nexport const HtmlMouseEvent = (\n  rendition: any,\n  key: string,\n  readerMode: string\n) => {\n  rendition.on(\"rendered\", () => {\n    let doc = getIframeDoc();\n    if (!doc) return;\n    lock = false;\n    bindHtmlEvent(rendition, doc, key, readerMode);\n  });\n};\nexport const pdfMouseEvent = () => {\n  let pageArea = document.getElementById(\"page-area\");\n  if (!pageArea) return;\n  let iframe = pageArea.getElementsByTagName(\"iframe\")[0];\n  if (!iframe) return;\n  let doc: any = iframe.contentWindow || iframe.contentDocument?.defaultView;\n\n  doc.document.addEventListener(\"keydown\", (event) => {\n    handleShortcut(event, event.keyCode);\n  });\n};\nexport const djvuMouseEvent = () => {\n  document.addEventListener(\"keydown\", (event) => {\n    handleShortcut(event, event.keyCode);\n  });\n};\n","class Book {\n  key: string;\n  name: string;\n  author: string;\n  description: string;\n  md5: string;\n  cover: string;\n  format: string;\n  publisher: string;\n  size: number;\n  path: string;\n  charset: string;\n  constructor(\n    key: string,\n    name: string,\n    author: string,\n    description: string,\n    md5: string,\n    cover: string,\n    format: string,\n    publisher: string,\n    size: number,\n    path: string,\n    charset: string\n  ) {\n    this.key = key; // 数据库的键\n    this.name = name; // 书籍名\n    this.author = author; // 作者\n    this.description = description; // 书籍的描述\n    this.md5 = md5; //epub的md5值，防止重复导入\n    this.cover = cover;\n    this.format = format;\n    this.publisher = publisher;\n    this.size = size;\n    this.path = path;\n    this.charset = charset;\n  }\n}\n\nexport default Book;\n","import React from \"react\";\nimport RecentBooks from \"../../utils/readUtils/recordRecent\";\nimport { ViewerProps, ViewerState } from \"./interface\";\nimport localforage from \"localforage\";\nimport { withRouter } from \"react-router-dom\";\nimport BookUtil from \"../../utils/fileUtils/bookUtil\";\nimport iconv from \"iconv-lite\";\nimport chardet from \"chardet\";\nimport rtfToHTML from \"@iarna/rtf-to-html\";\nimport PopupMenu from \"../../components/popups/popupMenu\";\nimport { xmlBookParser } from \"../../utils/fileUtils/xmlUtil\";\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\nimport RecordLocation from \"../../utils/readUtils/recordLocation\";\nimport { mimetype } from \"../../constants/mimetype\";\nimport Background from \"../../components/background\";\nimport toast from \"react-hot-toast\";\nimport StyleUtil from \"../../utils/readUtils/styleUtil\";\nimport \"./index.css\";\nimport {\n  bindHtmlEvent,\n  HtmlMouseEvent,\n} from \"../../utils/serviceUtils/mouseEvent\";\nimport untar from \"js-untar\";\nimport ImageViewer from \"../../components/imageViewer\";\nimport _ from \"underscore\";\nimport { removeExtraQuestionMark } from \"../../utils/fileUtils/rtfUtil\";\nimport { getIframeDoc } from \"../../utils/serviceUtils/docUtil\";\nimport { tsTransform } from \"../../utils/serviceUtils/langUtil\";\n\ndeclare var window: any;\nlet lock = false; //prevent from clicking too fasts\nconst {\n  MobiRender,\n  Azw3Render,\n  EpubRender,\n  TxtRender,\n  StrRender,\n  ComicRender,\n} = window.Kookit;\nlet Unrar = window.Unrar;\nlet JSZip = window.JSZip;\n\nclass Viewer extends React.Component<ViewerProps, ViewerState> {\n  lock: boolean;\n  constructor(props: ViewerProps) {\n    super(props);\n    this.state = {\n      cfiRange: null,\n      contents: null,\n      rect: null,\n      key: \"\",\n      isFirst: true,\n      scale: StorageUtil.getReaderConfig(\"scale\") || 1,\n      chapterTitle:\n        RecordLocation.getHtmlLocation(this.props.currentBook.key)\n          .chapterTitle || \"\",\n      readerMode: StorageUtil.getReaderConfig(\"readerMode\") || \"double\",\n      margin: parseInt(StorageUtil.getReaderConfig(\"margin\")) || 30,\n      extraMargin:\n        this.props.currentBook.format === \"EPUB\"\n          ? (document.body.clientWidth -\n              2 * (parseInt(StorageUtil.getReaderConfig(\"margin\")) || 30) -\n              20) /\n            24\n          : 0,\n      chapterIndex: 0,\n      chapter: \"\",\n      pageWidth: 0,\n      pageHeight: 0,\n      rendition: null,\n    };\n    this.lock = false;\n  }\n  UNSAFE_componentWillMount() {\n    this.props.handleFetchBookmarks();\n    this.props.handleFetchNotes();\n    this.props.handleFetchBooks();\n  }\n  componentDidMount() {\n    this.handleRenderBook();\n\n    this.props.handleRenderBookFunc(this.handleRenderBook);\n\n    window.addEventListener(\"resize\", () => {\n      if (lock) return;\n      let reader = document.querySelector(\"#page-area\");\n      //解决文字遮挡问题\n      if (\n        reader &&\n        reader.getAttribute(\"style\") &&\n        reader.getAttribute(\"style\")!.indexOf(\"width\") > -1\n      ) {\n        reader.setAttribute(\n          \"style\",\n          reader\n            .getAttribute(\"style\")!\n            .substring(0, reader.getAttribute(\"style\")!.indexOf(\"width\"))\n        );\n        StorageUtil.getReaderConfig(\"readerMode\") !== \"scroll\" &&\n          this.handlePageWidth();\n      }\n      if (this.props.currentBook.format === \"EPUB\") {\n        let doc = getIframeDoc();\n        if (!doc) return;\n        bindHtmlEvent(\n          this.props.htmlBook.rendition,\n          doc,\n          this.props.currentBook.key,\n          this.state.readerMode\n        );\n        this.handleBindGesture();\n        StyleUtil.addDefaultCss();\n        this.props.renderNoteFunc();\n      } else {\n        this.handleRenderBook();\n      }\n\n      lock = true;\n      setTimeout(function () {\n        lock = false;\n      }, 100);\n      return false;\n    });\n  }\n  handlePageWidth = () => {\n    let reader = document.querySelector(\"#page-area\");\n    //解决文字遮挡问题\n    if (reader) {\n      reader.setAttribute(\n        \"style\",\n        reader.getAttribute(\"style\") +\n          \"width:\" +\n          (parseInt(reader.clientWidth + \"\") % 2\n            ? parseInt(reader.clientWidth + \"\") - 1\n            : parseInt(reader.clientWidth + \"\")) +\n          \"px; \"\n      );\n    }\n  };\n  handleRenderBook = () => {\n    if (lock) return;\n    let { key, path, format, name } = this.props.currentBook;\n    this.props.handleHtmlBook(null);\n    let doc = getIframeDoc();\n    if (doc && this.state.rendition) {\n      this.state.rendition.removeContent();\n    }\n\n    StorageUtil.getReaderConfig(\"readerMode\") !== \"scroll\" &&\n      this.handlePageWidth();\n\n    window.rangy.init();\n    BookUtil.fetchBook(key, true, path).then((result) => {\n      if (!result) {\n        toast.error(this.props.t(\"Book not exsits\"));\n        return;\n      }\n\n      if (format === \"MOBI\") {\n        this.handleMobi(result as ArrayBuffer);\n      } else if (format === \"AZW3\") {\n        this.handleAzw3(result as ArrayBuffer);\n      } else if (format === \"EPUB\") {\n        this.handleEpub(result as ArrayBuffer);\n      } else if (format === \"TXT\") {\n        this.handleTxt(result as ArrayBuffer);\n      } else if (format === \"MD\") {\n        this.handleMD(result as ArrayBuffer);\n      } else if (format === \"FB2\") {\n        this.handleFb2(result as ArrayBuffer);\n      } else if (format === \"RTF\") {\n        this.handleRtf(result as ArrayBuffer);\n      } else if (format === \"DOCX\") {\n        this.handleDocx(result as ArrayBuffer);\n      } else if (\n        format === \"HTML\" ||\n        format === \"XHTML\" ||\n        format === \"HTM\" ||\n        format === \"XML\"\n      ) {\n        this.handleHtml(result as ArrayBuffer, format);\n      } else if (format === \"CBR\") {\n        this.handleCbr(result as ArrayBuffer);\n      } else if (format === \"CBT\") {\n        this.handleCbt(result as ArrayBuffer);\n      } else if (format === \"CBZ\") {\n        this.handleCbz(result as ArrayBuffer);\n      }\n      this.props.handleReadingState(true);\n\n      RecentBooks.setRecent(this.props.currentBook.key);\n      document.title = name + \" - Koodo Reader\";\n    });\n  };\n\n  handleRest = async (rendition: any) => {\n    HtmlMouseEvent(\n      rendition,\n      this.props.currentBook.key,\n      this.state.readerMode\n    );\n    let chapters = await rendition.getChapter();\n    let flattenChapters = rendition.flatChapter(chapters);\n    this.props.handleHtmlBook({\n      key: this.props.currentBook.key,\n      chapters,\n      flattenChapters,\n      rendition: rendition,\n    });\n    this.setState({ rendition });\n    this.setState({\n      pageWidth: rendition.getPageSize().width,\n      pageHeight: rendition.getPageSize().height,\n    });\n    StyleUtil.addDefaultCss();\n    tsTransform();\n    rendition.setStyle(\n      StyleUtil.getCustomCss(\n        this.props.currentBook.format === \"EPUB\" ? false : true,\n        StorageUtil.getReaderConfig(\"readerMode\") === \"scroll\"\n      )\n    );\n    if (this.props.currentBook.format !== \"EPUB\") {\n      let bookLocation: {\n        text: string;\n        count: string;\n        chapterTitle: string;\n        percentage: string;\n        cfi: string;\n      } = RecordLocation.getHtmlLocation(this.props.currentBook.key);\n      await rendition.goToPosition(\n        JSON.stringify({\n          text: bookLocation.text,\n          chapterTitle: bookLocation.chapterTitle,\n          count: bookLocation.count,\n          percentage: bookLocation.percentage,\n          cfi: bookLocation.cfi,\n          isFirst: true,\n        })\n      );\n    }\n\n    rendition.on(\"rendered\", async () => {\n      await this.handleLocation();\n      let bookLocation: { text: string; count: string; chapterTitle: string } =\n        RecordLocation.getHtmlLocation(this.props.currentBook.key);\n      if (this.props.currentBook.format.startsWith(\"CB\")) {\n        this.setState({\n          chapter:\n            this.props.htmlBook.flattenChapters[\n              parseInt(bookLocation.count) || 0\n            ].label,\n          chapterIndex: parseInt(bookLocation.count) || 0,\n        });\n      } else {\n        let chapter =\n          bookLocation.chapterTitle ||\n          (this.props.htmlBook\n            ? this.props.htmlBook.flattenChapters[0].label\n            : \"Unknown Chapter\");\n        let chapterIndex =\n          bookLocation.chapterTitle && this.props.htmlBook\n            ? _.findLastIndex(\n                this.props.htmlBook.flattenChapters.map((item) => {\n                  item.label = item.label.trim();\n                  return item;\n                }),\n                {\n                  label: bookLocation.chapterTitle.trim(),\n                }\n              )\n            : 0;\n        this.props.handleCurrentChapter(chapter);\n        this.props.handleCurrentChapterIndex(chapterIndex);\n        this.props.handleFetchPercentage(this.props.currentBook);\n        this.setState({\n          chapter,\n          chapterIndex,\n        });\n      }\n      StyleUtil.addDefaultCss();\n      tsTransform();\n      this.handleBindGesture();\n      lock = true;\n      setTimeout(function () {\n        lock = false;\n      }, 1000);\n      return false;\n    });\n  };\n  handleLocation = async () => {\n    let position = await this.props.htmlBook.rendition.getPosition();\n    RecordLocation.recordHtmlLocation(\n      this.props.currentBook.key,\n      position.text,\n      position.chapterTitle,\n      position.count,\n      position.percentage,\n      position.cfi\n    );\n  };\n  handleBindGesture = () => {\n    let doc = getIframeDoc();\n    if (!doc) return;\n    doc.addEventListener(\"click\", (event) => {\n      this.props.handleLeaveReader(\"left\");\n      this.props.handleLeaveReader(\"right\");\n      this.props.handleLeaveReader(\"top\");\n      this.props.handleLeaveReader(\"bottom\");\n    });\n    doc.addEventListener(\"mouseup\", () => {\n      if (!doc!.getSelection()) return;\n      var rect = doc!.getSelection()!.getRangeAt(0).getBoundingClientRect();\n      this.setState({ rect });\n    });\n  };\n  handleCbr = async (result: ArrayBuffer) => {\n    let unrar = new Unrar(result);\n    var entries = unrar.getEntries();\n    let bookLocation = RecordLocation.getHtmlLocation(\n      this.props.currentBook.key\n    );\n    let rendition = new ComicRender(\n      entries.map((item: any) => item.name),\n      unrar,\n      this.state.readerMode,\n      \"cbr\",\n      StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\n    );\n    await rendition.renderTo(\n      document.getElementsByClassName(\"html-viewer-page\")[0],\n      parseInt(bookLocation.count) || 0\n    );\n    this.handleRest(rendition);\n  };\n  handleCbz = (result: ArrayBuffer) => {\n    let zip = new JSZip();\n    let bookLocation = RecordLocation.getHtmlLocation(\n      this.props.currentBook.key\n    );\n    zip.loadAsync(result).then(async (contents) => {\n      let rendition = new ComicRender(\n        Object.keys(contents.files).sort(),\n        zip,\n        this.state.readerMode,\n        \"cbz\",\n        StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\n      );\n      await rendition.renderTo(\n        document.getElementsByClassName(\"html-viewer-page\")[0],\n        parseInt(bookLocation.count) || 0\n      );\n      this.handleRest(rendition);\n    });\n  };\n  handleCbt = (result: ArrayBuffer) => {\n    let bookLocation = RecordLocation.getHtmlLocation(\n      this.props.currentBook.key\n    );\n    untar(result).then(\n      async (extractedFiles) => {\n        let rendition = new ComicRender(\n          extractedFiles.map((item: any) => item.name),\n          extractedFiles,\n          this.state.readerMode,\n          \"cbt\",\n          StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\n        );\n        await rendition.renderTo(\n          document.getElementsByClassName(\"html-viewer-page\")[0],\n          parseInt(bookLocation.count) || 0\n        );\n        this.handleRest(rendition);\n      },\n      function (err) {\n        // onError\n      },\n      function (extractedFile) {\n        // onProgress\n      }\n    );\n  };\n  handleMobi = async (result: ArrayBuffer) => {\n    let rendition = new MobiRender(\n      result,\n      this.state.readerMode,\n      StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\n    );\n    await rendition.renderTo(\n      document.getElementsByClassName(\"html-viewer-page\")[0]\n    );\n    this.handleRest(rendition);\n  };\n  handleEpub = async (result: ArrayBuffer) => {\n    let rendition = new EpubRender(\n      result,\n      this.state.readerMode,\n      StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\n    );\n    let bookLocation: {\n      text: string;\n      count: string;\n      chapterTitle: string;\n      percentage: string;\n      cfi: string;\n    } = RecordLocation.getHtmlLocation(this.props.currentBook.key);\n    await rendition.renderTo(\n      document.getElementsByClassName(\"html-viewer-page\")[0],\n      bookLocation.cfi\n    );\n    this.handleRest(rendition);\n  };\n  handleAzw3 = async (result: ArrayBuffer) => {\n    let rendition = new Azw3Render(\n      result,\n      this.state.readerMode,\n      StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\n    );\n    await rendition.renderTo(\n      document.getElementsByClassName(\"html-viewer-page\")[0]\n    );\n    this.handleRest(rendition);\n  };\n  handleCharset = (result: ArrayBuffer) => {\n    return new Promise<string>(async (resolve, reject) => {\n      let { books } = this.props;\n      let charset = \"\";\n      books.forEach((item) => {\n        if (item.key === this.props.currentBook.key) {\n          charset = chardet.detect(Buffer.from(result)) || \"\";\n          item.charset = charset;\n          this.props.handleReadingBook(item);\n        }\n      });\n\n      await localforage.setItem(\"books\", books);\n      // this.props.handleFetchBooks();\n      resolve(charset);\n    });\n  };\n  handleTxt = async (result: ArrayBuffer) => {\n    let charset = \"\";\n    if (!this.props.currentBook.charset) {\n      charset = await this.handleCharset(result);\n    }\n    let rendition = new TxtRender(\n      result,\n      this.state.readerMode,\n      this.props.currentBook.charset || charset || \"utf8\",\n      StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\n    );\n    await rendition.renderTo(\n      document.getElementsByClassName(\"html-viewer-page\")[0]\n    );\n    this.handleRest(rendition);\n  };\n  handleMD = (result: ArrayBuffer) => {\n    var blob = new Blob([result], { type: \"text/plain\" });\n    var reader = new FileReader();\n    reader.onload = async (evt) => {\n      let docStr = window.marked(evt.target?.result as any);\n      let rendition = new StrRender(\n        docStr,\n        this.state.readerMode,\n        StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\n      );\n      await rendition.renderTo(\n        document.getElementsByClassName(\"html-viewer-page\")[0]\n      );\n      this.handleRest(rendition);\n    };\n    reader.readAsText(blob, \"UTF-8\");\n  };\n  handleRtf = async (result: ArrayBuffer) => {\n    let charset = \"\";\n    if (!this.props.currentBook.charset) {\n      charset = await this.handleCharset(result);\n    }\n    let text = iconv.decode(\n      Buffer.from(result),\n      this.props.currentBook.charset || charset || \"utf8\"\n    );\n\n    rtfToHTML.fromString(text, async (err: any, html: any) => {\n      let rendition = new StrRender(\n        removeExtraQuestionMark(html),\n        this.state.readerMode,\n        StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\n      );\n      await rendition.renderTo(\n        document.getElementsByClassName(\"html-viewer-page\")[0]\n      );\n      this.handleRest(rendition);\n    });\n  };\n  handleDocx = (result: ArrayBuffer) => {\n    window.mammoth\n      .convertToHtml({ arrayBuffer: result })\n      .then(async (res: any) => {\n        let rendition = new StrRender(\n          res.value,\n          this.state.readerMode,\n          StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\n        );\n        await rendition.renderTo(\n          document.getElementsByClassName(\"html-viewer-page\")[0]\n        );\n        this.handleRest(rendition);\n      });\n  };\n  toBuffer(ab) {\n    const buf = Buffer.alloc(ab.byteLength);\n    const view = new Uint8Array(ab);\n    for (let i = 0; i < buf.length; ++i) {\n      buf[i] = view[i];\n    }\n    return buf;\n  }\n  handleFb2 = async (result: ArrayBuffer) => {\n    let charset = \"\";\n    if (!this.props.currentBook.charset) {\n      charset = await this.handleCharset(result);\n    }\n    let fb2Str = iconv.decode(\n      Buffer.from(result),\n      this.props.currentBook.charset || charset || \"utf8\"\n    );\n    let bookObj = xmlBookParser(Buffer.from(result), fb2Str);\n    let rendition = new StrRender(\n      bookObj,\n      this.state.readerMode,\n      StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\n    );\n    await rendition.renderTo(\n      document.getElementsByClassName(\"html-viewer-page\")[0]\n    );\n    this.handleRest(rendition);\n  };\n  handleHtml = (result: ArrayBuffer, format: string) => {\n    var blob = new Blob([result], {\n      type: mimetype[format.toLocaleLowerCase()],\n    });\n    var reader = new FileReader();\n    reader.onload = async (evt) => {\n      const html = evt.target?.result as any;\n      let rendition = new StrRender(\n        html,\n        this.state.readerMode,\n        StorageUtil.getReaderConfig(\"isSliding\") === \"yes\" ? true : false\n      );\n      await rendition.renderTo(\n        document.getElementsByClassName(\"html-viewer-page\")[0]\n      );\n      this.handleRest(rendition);\n    };\n    reader.readAsText(blob, \"UTF-8\");\n  };\n  render() {\n    return (\n      <>\n        <div\n          className=\"html-viewer-page\"\n          id=\"page-area\"\n          style={\n            document.body.clientWidth < 570\n              ? { left: 0, right: 0 }\n              : this.state.readerMode === \"scroll\"\n              ? {\n                  left: `calc(50vw - ${\n                    270 * parseFloat(this.state.scale)\n                  }px + 20px)`,\n                  right: `calc(50vw - ${\n                    270 * parseFloat(this.state.scale)\n                  }px + 15px)`,\n                  overflowY: \"scroll\",\n                  overflowX: \"hidden\",\n                }\n              : this.state.readerMode === \"single\"\n              ? {\n                  left: `calc(50vw - ${\n                    270 * parseFloat(this.state.scale)\n                  }px + 15px)`,\n                  right: `calc(50vw - ${\n                    270 * parseFloat(this.state.scale)\n                  }px + 15px)`,\n                }\n              : this.state.readerMode === \"double\"\n              ? {\n                  left: this.state.margin + 10 - this.state.extraMargin + \"px\",\n                  right: this.state.margin + 10 - this.state.extraMargin + \"px\",\n                }\n              : {}\n          }\n        ></div>\n        {StorageUtil.getReaderConfig(\"isHideBackground\") === \"yes\" ? null : this\n            .props.currentBook.key ? (\n          <Background />\n        ) : null}\n        {this.props.htmlBook ? (\n          <PopupMenu\n            {...{\n              rendition: this.props.htmlBook.rendition,\n              rect: this.state.rect,\n              pageWidth: this.state.pageWidth,\n              pageHeight: this.state.pageHeight,\n              chapterIndex: this.state.chapterIndex,\n              chapter: this.state.chapter,\n            }}\n          />\n        ) : null}\n        {this.props.htmlBook && (\n          <ImageViewer\n            {...{\n              isShow: this.props.isShow,\n              rendition: this.props.htmlBook.rendition,\n              handleEnterReader: this.props.handleEnterReader,\n              handleLeaveReader: this.props.handleLeaveReader,\n            }}\n          />\n        )}\n      </>\n    );\n  }\n}\nexport default withRouter(Viewer as any);\n","export const mimetype = {\n  svg: \"image/svg+xml\",\n  png: \"image/png\",\n  jpg: \"image/jpeg\",\n  jpeg: \"image/jpeg\",\n  gif: \"image/gif\",\n  webp: \"image/webp\",\n  zip: \"application/zip\",\n  rar: \"application/x-rar-compressed\",\n  \"7z\": \"application/x-7z-compressed\",\n  tar: \"application/x-tar\",\n  html: \"text/html\",\n  htm: \"text/html\",\n  xml: \"text/xml\",\n  xhtml: \"application/xhtml+xml\",\n};\n","import BookModel from \"../../model/Book\";\nclass RecordRecent {\n  static setRecent(bookKey: string) {\n    let bookArr =\n      localStorage.getItem(\"recentBooks\") !== \"{}\" &&\n      localStorage.getItem(\"recentBooks\")\n        ? JSON.parse(localStorage.getItem(\"recentBooks\") || \"\")\n        : [];\n    const index = bookArr.indexOf(bookKey);\n    if (index > -1) {\n      bookArr.splice(index, 1);\n      bookArr.unshift(bookKey);\n    } else {\n      bookArr.unshift(bookKey);\n    }\n\n    localStorage.setItem(\"recentBooks\", JSON.stringify(bookArr));\n  }\n  static setAllRecent(books: BookModel[]) {\n    let bookArr: string[] = [];\n    books.forEach((item) => {\n      bookArr.push(item.key);\n    });\n    localStorage.setItem(\"recentBooks\", JSON.stringify(bookArr));\n  }\n\n  static clear(bookKey: string) {\n    let bookArr =\n      localStorage.getItem(\"recentBooks\") !== \"{}\" &&\n      localStorage.getItem(\"recentBooks\")\n        ? JSON.parse(localStorage.getItem(\"recentBooks\") || \"\")\n        : [];\n    const index = bookArr.indexOf(bookKey);\n    if (index > -1) {\n      bookArr.splice(index, 1);\n    }\n    localStorage.setItem(\"recentBooks\", JSON.stringify(bookArr));\n  }\n  static getAllRecent() {\n    let bookArr =\n      localStorage.getItem(\"recentBooks\") !== \"{}\" &&\n      localStorage.getItem(\"recentBooks\")\n        ? JSON.parse(localStorage.getItem(\"recentBooks\") || \"\")\n        : [];\n    return bookArr || [];\n  }\n}\n\nexport default RecordRecent;\n","export const removeExtraQuestionMark = (html: any) => {\n  return html\n    .replaceAll(\"–?\", \"–\")\n    .replaceAll(\"“?\", \"“\")\n    .replaceAll(\"”?\", \"”\")\n    .replaceAll(\"©?\", \"©\")\n    .replaceAll(\"’?\", \"’\")\n    .replaceAll(\"“?\", \"“\")\n    .replaceAll(\"…?\", \"…\")\n    .replaceAll(\"—?\", \"—\")\n    .replaceAll(\"‘?\", \"‘\")\n    .replaceAll(\"“?\", \"“\");\n};\n","import React from \"react\";\nimport \"./background.css\";\nimport { BackgroundProps, BackgroundState } from \"./interface\";\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\n\nclass Background extends React.Component<BackgroundProps, BackgroundState> {\n  isFirst: Boolean;\n  constructor(props: any) {\n    super(props);\n    this.state = {\n      isSingle:\n        StorageUtil.getReaderConfig(\"readerMode\") &&\n        StorageUtil.getReaderConfig(\"readerMode\") !== \"double\",\n      scale: StorageUtil.getReaderConfig(\"scale\") || 1,\n    };\n    this.isFirst = true;\n  }\n  componentDidMount() {\n    let background = document.querySelector(\".background\");\n    if (!background) return;\n    background?.setAttribute(\n      \"style\",\n      `background-color:${\n        StorageUtil.getReaderConfig(\"backgroundColor\") || \"rgba(255,255,255,1)\"\n      };filter: brightness(${\n        StorageUtil.getReaderConfig(\"brightness\") || 1\n      }) invert(${StorageUtil.getReaderConfig(\"isInvert\") === \"yes\" ? 1 : 0})`\n    );\n  }\n\n  render() {\n    return (\n      <>\n        <div\n          className=\"background-box2\"\n          style={\n            document.body.clientWidth < 570\n              ? { left: 5, right: 8 }\n              : this.state.isSingle\n              ? {\n                  left: `calc(50vw - ${\n                    270 * parseFloat(this.state.scale)\n                  }px - ${this.state.isSingle ? \"9\" : \"5\"}px)`,\n                  right: `calc(50vw - ${\n                    270 * parseFloat(this.state.scale)\n                  }px - 7px)`,\n                  boxShadow: \"0 0 0px rgba(191, 191, 191, 1)\",\n                }\n              : {}\n          }\n        ></div>\n\n        <div\n          className=\"background-box3\"\n          style={\n            document.body.clientWidth < 570\n              ? { left: 5, right: 10 }\n              : this.state.isSingle\n              ? {\n                  left: `calc(50vw - ${\n                    270 * parseFloat(this.state.scale)\n                  }px - 9px)`,\n                  right: `calc(50vw - ${\n                    270 * parseFloat(this.state.scale)\n                  }px - 9px)`,\n                }\n              : {}\n          }\n        >\n          {(!StorageUtil.getReaderConfig(\"backgroundColor\") &&\n            (StorageUtil.getReaderConfig(\"appSkin\") === \"night\" ||\n              (StorageUtil.getReaderConfig(\"appSkin\") === \"system\" &&\n                StorageUtil.getReaderConfig(\"isOSNight\") === \"yes\"))) ||\n          StorageUtil.getReaderConfig(\"backgroundColor\") ===\n            \"rgba(44,47,49,1)\" ? (\n            <div\n              className=\"dark-spine-shadow-left\"\n              style={\n                this.state.isSingle ||\n                (StorageUtil.getReaderConfig(\"backgroundColor\") &&\n                  StorageUtil.getReaderConfig(\"backgroundColor\").startsWith(\n                    \"#\"\n                  ))\n                  ? { display: \"none\" }\n                  : {}\n              }\n            ></div>\n          ) : (\n            <div\n              className=\"spine-shadow-left\"\n              style={\n                this.state.isSingle ||\n                (StorageUtil.getReaderConfig(\"backgroundColor\") &&\n                  StorageUtil.getReaderConfig(\"backgroundColor\").startsWith(\n                    \"#\"\n                  ))\n                  ? { display: \"none\" }\n                  : {}\n              }\n            ></div>\n          )}\n          <div\n            className=\"book-spine\"\n            style={this.state.isSingle ? { display: \"none\" } : {}}\n          ></div>\n          {(!StorageUtil.getReaderConfig(\"backgroundColor\") &&\n            StorageUtil.getReaderConfig(\"appSkin\") === \"night\") ||\n          StorageUtil.getReaderConfig(\"backgroundColor\") ===\n            \"rgba(44,47,49,1)\" ? (\n            <div\n              className=\"dark-spine-shadow-right\"\n              style={\n                StorageUtil.getReaderConfig(\"backgroundColor\") &&\n                StorageUtil.getReaderConfig(\"backgroundColor\").startsWith(\"#\")\n                  ? { display: \"none\" }\n                  : this.state.isSingle\n                  ? {\n                      position: \"relative\",\n                      right: 0,\n                    }\n                  : {}\n              }\n            ></div>\n          ) : (\n            <div\n              className=\"spine-shadow-right\"\n              style={\n                StorageUtil.getReaderConfig(\"backgroundColor\") &&\n                StorageUtil.getReaderConfig(\"backgroundColor\").startsWith(\"#\")\n                  ? { display: \"none\" }\n                  : this.state.isSingle\n                  ? {\n                      position: \"relative\",\n                      right: 0,\n                    }\n                  : {}\n              }\n            ></div>\n          )}\n        </div>\n\n        <div\n          className=\"background-box1\"\n          style={\n            document.body.clientWidth < 570\n              ? { left: 5, right: 6 }\n              : this.state.isSingle\n              ? {\n                  left: `calc(50vw - ${\n                    270 * parseFloat(this.state.scale)\n                  }px - ${this.state.isSingle ? \"9\" : \"5\"}px)`,\n                  right: `calc(50vw - ${\n                    270 * parseFloat(this.state.scale)\n                  }px - 5px)`,\n                  boxShadow: \"0 0 0px rgba(191, 191, 191, 1)\",\n                }\n              : {}\n          }\n        ></div>\n      </>\n    );\n  }\n}\n\nexport default Background;\n","import { connect } from \"react-redux\";\nimport { stateType } from \"../../store\";\nimport Background from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentBook: state.book.currentBook,\n  };\n};\nconst actionCreator = {};\nexport default connect(mapStateToProps, actionCreator)(Background as any);\n","import React from \"react\";\nimport \"./imageViewer.css\";\nimport { ImageViewerProps, ImageViewerStates } from \"./interface\";\nimport FileSaver from \"file-saver\";\nimport { handleLinkJump } from \"../../utils/readUtils/linkUtil\";\nimport { getIframeDoc } from \"../../utils/serviceUtils/docUtil\";\n\nclass ImageViewer extends React.Component<ImageViewerProps, ImageViewerStates> {\n  constructor(props: ImageViewerProps) {\n    super(props);\n    this.state = {\n      isShowImage: false,\n      imageRatio: \"horizontal\",\n      zoomIndex: 0,\n      rotateIndex: 0,\n    };\n  }\n\n  componentDidMount() {\n    this.props.rendition.on(\"rendered\", () => {\n      let doc = getIframeDoc();\n      if (!doc) return;\n      // StyleUtil.addDefaultCss();\n      doc.addEventListener(\"click\", this.showImage);\n    });\n  }\n\n  showImage = (event: any) => {\n    event.preventDefault();\n    if (this.props.isShow) {\n      this.props.handleLeaveReader(\"left\");\n      this.props.handleLeaveReader(\"right\");\n      this.props.handleLeaveReader(\"top\");\n      this.props.handleLeaveReader(\"bottom\");\n    }\n    handleLinkJump(event);\n    if (!event.target.src) {\n      return;\n    }\n    if (this.state.isShowImage) {\n      this.setState({\n        isShowImage: false,\n        zoomIndex: 0,\n        rotateIndex: 0,\n        imageRatio: \"horizontal\",\n      });\n    }\n    event.preventDefault();\n    const handleDirection = (direction: string) => {\n      this.setState({ imageRatio: direction });\n    };\n    var img = new Image();\n    img.addEventListener(\"load\", function () {\n      handleDirection(\n        this.naturalWidth / this.naturalHeight > 1 ? \"horizontal\" : \"vertical\"\n      );\n    });\n    img.src = event.target.src;\n    let image: HTMLImageElement | null = document.querySelector(\".image\");\n    if (image) {\n      image!.src = event.target.src;\n      this.setState({ isShowImage: true });\n    }\n  };\n  hideImage = (event: any) => {\n    event.preventDefault();\n    if (event.target.src) {\n      let image: HTMLImageElement | null = document.querySelector(\".image\");\n      if (image) image.src = \"\";\n    }\n    this.setState({ isShowImage: false });\n  };\n  handleZoomIn = () => {\n    let image: any = document.querySelector(\".image\");\n    if (image.style.width === \"200vw\" || image.style.height === \"200vh\") return;\n    this.setState({ zoomIndex: this.state.zoomIndex + 1 }, () => {\n      if (this.state.imageRatio === \"horizontal\") {\n        image.style.width = `${60 + this.state.zoomIndex * 10}vw`;\n      } else {\n        image.style.height = `${100 + 10 * this.state.zoomIndex}vh`;\n        image.style.marginTop = `${10 * this.state.zoomIndex}vh`;\n      }\n    });\n  };\n  handleZoomOut = () => {\n    let image: any = document.querySelector(\".image\");\n    if (image.style.width === \"10vw\" || image.style.height === \"10vh\") return;\n    this.setState({ zoomIndex: this.state.zoomIndex - 1 }, () => {\n      if (this.state.imageRatio === \"horizontal\") {\n        image.style.width = `${60 + this.state.zoomIndex * 10}vw`;\n      } else {\n        image.style.height = `${100 + 10 * this.state.zoomIndex}vh`;\n      }\n    });\n  };\n  handleSave = async () => {\n    let image: any = document.querySelector(\".image\");\n    let blob = await fetch(image.src).then((r) => r.blob());\n    FileSaver.saveAs(blob, `${new Date().toLocaleDateString()}`);\n  };\n  handleClock = () => {\n    let image: any = document.querySelector(\".image\");\n    this.setState({ rotateIndex: this.state.rotateIndex + 1 }, () => {\n      image.style.transform = `rotate(${this.state.rotateIndex * 90}deg)`;\n    });\n  };\n  handleCounterClock = () => {\n    let image: any = document.querySelector(\".image\");\n    this.setState({ rotateIndex: this.state.rotateIndex - 1 }, () => {\n      image.style.transform = `rotate(${this.state.rotateIndex * 90}deg)`;\n    });\n  };\n  render() {\n    return (\n      <div\n        className=\"image-preview\"\n        style={this.state.isShowImage ? {} : { display: \"none\" }}\n      >\n        <div\n          className=\"image-background\"\n          style={\n            this.state.isShowImage\n              ? { backgroundColor: \"rgba(75,75,75,0.3)\" }\n              : {}\n          }\n          onClick={(event) => {\n            this.hideImage(event);\n          }}\n        ></div>\n        <img\n          src=\"\"\n          alt=\"\"\n          className=\"image\"\n          style={\n            this.state.imageRatio === \"horizontal\"\n              ? { width: \"60vw\" }\n              : { height: \"100vh\" }\n          }\n        />\n        <div className=\"image-operation\">\n          <span\n            className=\"icon-zoom-in zoom-in-icon\"\n            onClick={() => {\n              this.handleZoomIn();\n            }}\n          ></span>\n          <span\n            className=\"icon-zoom-out zoom-out-icon\"\n            onClick={() => {\n              this.handleZoomOut();\n            }}\n          ></span>\n          <span\n            className=\"icon-save save-icon\"\n            onClick={() => {\n              this.handleSave();\n            }}\n          ></span>\n          <span\n            className=\"icon-clockwise clockwise-icon\"\n            onClick={() => {\n              this.handleClock();\n            }}\n          ></span>\n          <span\n            className=\"icon-counterclockwise counterclockwise-icon\"\n            onClick={() => {\n              this.handleCounterClock();\n            }}\n          ></span>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ImageViewer;\n","import { connect } from \"react-redux\";\nimport { stateType } from \"../../store\";\nimport ImageViewer from \"./component\";\nimport { withTranslation } from \"react-i18next\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentBook: state.book.currentBook,\n  };\n};\nconst actionCreator = {};\n\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(ImageViewer as any));\n","export const getIframeDoc = () => {\n  let pageArea = document.getElementById(\"page-area\");\n\n  if (!pageArea) return null;\n  let iframe = pageArea.getElementsByTagName(\"iframe\")[0];\n  if (!iframe) return null;\n  let doc = iframe.contentDocument;\n\n  if (!doc) {\n    return null;\n  }\n  return doc;\n};\nexport const getPDFIframeDoc = () => {\n  let pageArea = document.getElementById(\"page-area\");\n  if (!pageArea) return null;\n  let iframe = pageArea.getElementsByTagName(\"iframe\")[0];\n  if (!iframe) return null;\n  let iWin: any = iframe.contentWindow || iframe.contentDocument?.defaultView;\n  if (!iWin) return null;\n  return iWin;\n};\n","import localforage from \"localforage\";\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\nimport SortUtil from \"../../utils/readUtils/sortUtil\";\nimport BookModel from \"../../model/Book\";\nimport { Dispatch } from \"redux\";\nimport AddTrash from \"../../utils/readUtils/addTrash\";\n\nexport function handleBooks(books: BookModel[]) {\n  return { type: \"HANDLE_BOOKS\", payload: books };\n}\nexport function handleDeletedBooks(deletedBooks: BookModel[]) {\n  return { type: \"HANDLE_DELETED_BOOKS\", payload: deletedBooks };\n}\nexport function handleSearchResults(searchResults: number[]) {\n  return { type: \"HANDLE_SEARCH_BOOKS\", payload: searchResults };\n}\nexport function handleSearch(isSearch: boolean) {\n  return { type: \"HANDLE_SEARCH\", payload: isSearch };\n}\nexport function handleTipDialog(isTipDialog: boolean) {\n  return { type: \"HANDLE_TIP_DIALOG\", payload: isTipDialog };\n}\nexport function handleTip(tip: string) {\n  return { type: \"HANDLE_TIP\", payload: tip };\n}\nexport function handleSetting(isSettingOpen: boolean) {\n  return { type: \"HANDLE_SETTING\", payload: isSettingOpen };\n}\nexport function handleAbout(isAboutOpen: boolean) {\n  return { type: \"HANDLE_ABOUT\", payload: isAboutOpen };\n}\nexport function handleViewMode(mode: string) {\n  return { type: \"HANDLE_VIEW_MODE\", payload: mode };\n}\n\nexport function handleSortDisplay(isSortDisplay: boolean) {\n  return { type: \"HANDLE_SORT_DISPLAY\", payload: isSortDisplay };\n}\nexport function handleLoadingDialog(isShowLoading: boolean) {\n  return { type: \"HANDLE_SHOW_LOADING\", payload: isShowLoading };\n}\nexport function handleNewDialog(isShowNew: boolean) {\n  return { type: \"HANDLE_SHOW_NEW\", payload: isShowNew };\n}\nexport function handleSelectBook(isSelectBook: boolean) {\n  return { type: \"HANDLE_SELECT_BOOK\", payload: isSelectBook };\n}\nexport function handleSelectedBooks(selectedBooks: string[]) {\n  return { type: \"HANDLE_SELECTED_BOOKS\", payload: selectedBooks };\n}\nexport function handleNewWarning(isNewWarning: boolean) {\n  return { type: \"HANDLE_NEW_WARNING\", payload: isNewWarning };\n}\nexport function handleBookSort(isBookSort: boolean) {\n  return { type: \"HANDLE_BOOK_SORT\", payload: isBookSort };\n}\nexport function handleNoteSort(isNoteSort: boolean) {\n  return { type: \"HANDLE_NOTE_SORT\", payload: isNoteSort };\n}\nexport function handleBookSortCode(bookSortCode: {\n  sort: number;\n  order: number;\n}) {\n  return { type: \"HANDLE_SORT_CODE\", payload: bookSortCode };\n}\n\nexport function handleNoteSortCode(noteSortCode: {\n  sort: number;\n  order: number;\n}) {\n  return { type: \"HANDLE_NOTE_SORT_CODE\", payload: noteSortCode };\n}\n\nexport function handleFetchBooks(isTrash = false) {\n  return (dispatch: Dispatch) => {\n    localforage.getItem(\"books\", (err, value) => {\n      let bookArr: any = value;\n      let keyArr = AddTrash.getAllTrash();\n      if (isTrash) {\n        dispatch(handleDeletedBooks(handleKeyFilter(bookArr, keyArr)));\n      } else {\n        dispatch(handleBooks(handleKeyRemove(bookArr, keyArr)));\n      }\n    });\n  };\n}\nexport function handleFetchBookSortCode() {\n  return (dispatch: Dispatch) => {\n    let bookSortCode = SortUtil.getBookSortCode();\n    dispatch(handleBookSortCode(bookSortCode));\n  };\n}\nexport function handleFetchNoteSortCode() {\n  return (dispatch: Dispatch) => {\n    let noteSortCode = SortUtil.getNoteSortCode();\n    dispatch(handleNoteSortCode(noteSortCode));\n  };\n}\nexport function handleFetchList() {\n  return (dispatch: Dispatch) => {\n    let viewMode = StorageUtil.getReaderConfig(\"viewMode\") || \"card\";\n    dispatch(handleViewMode(viewMode));\n  };\n}\nconst handleKeyRemove = (items: any[], arr: string[]) => {\n  if (!items) return [];\n  let itemArr: any[] = [];\n  if (!arr[0]) {\n    return items;\n  }\n  for (let item of items) {\n    if (arr.indexOf(item.key) === -1) {\n      itemArr.push(item);\n    }\n  }\n\n  return itemArr;\n};\nconst handleKeyFilter = (items: any[], arr: string[]) => {\n  if (!items) {\n    return [];\n  }\n  let itemArr: any[] = [];\n  for (let item of items) {\n    if (arr.indexOf(item.key) > -1) {\n      itemArr.push(item);\n    }\n  }\n  return itemArr;\n};\n","import BookModel from \"../../model/Book\";\nexport function handleEditDialog(mode: boolean) {\n  return { type: \"HANDLE_EDIT_DIALOG\", payload: mode };\n}\nexport function handleDeleteDialog(mode: boolean) {\n  return { type: \"HANDLE_DELETE_DIALOG\", payload: mode };\n}\nexport function handleAddDialog(mode: boolean) {\n  return { type: \"HANDLE_ADD_DIALOG\", payload: mode };\n}\nexport function handleRenderBookFunc(renderBookFunc: () => void) {\n  return { type: \"HANDLE_RENDER_BOOK_FUNC\", payload: renderBookFunc };\n}\nexport function handleRenderNoteFunc(renderNoteFunc: () => void) {\n  return { type: \"HANDLE_RENDER_NOTE_FUNC\", payload: renderNoteFunc };\n}\nexport function handleActionDialog(mode: boolean) {\n  return { type: \"HANDLE_ACTION_DIALOG\", payload: mode };\n}\nexport function handleReadingState(state: boolean) {\n  return { type: \"HANDLE_READING_STATE\", payload: state };\n}\nexport function handleReadingBook(book: BookModel) {\n  return { type: \"HANDLE_READING_BOOK\", payload: book };\n}\nexport function handleDragItem(key: string) {\n  return { type: \"HANDLE_DRAG_ITEM\", payload: key };\n}\n","export function handleBackupDialog(mode: boolean) {\n  return { type: \"HANDLE_BACKUP\", payload: mode };\n}\nexport function handleTokenDialog(mode: boolean) {\n  return { type: \"HANDLE_TOKEN_DIALOG\", payload: mode };\n}\n","import RecordLocation from \"../../utils/readUtils/recordLocation\";\nimport BookModel from \"../../model/Book\";\nexport function handleLocations(locations: any) {\n  return { type: \"HANDLE_LOCATIONS\", payload: locations };\n}\nexport function handlePercentage(percentage: number) {\n  return { type: \"HANDLE_PERCENTAGE\", payload: percentage };\n}\nexport function handleFetchPercentage(book: BookModel) {\n  return (dispatch: (arg0: { type: string; payload: any }) => void) => {\n    let percentage = RecordLocation.getHtmlLocation(book.key).percentage || 0;\n\n    dispatch(handlePercentage(percentage));\n  };\n}\n","import localforage from \"localforage\";\nimport NoteModel from \"../../model/Note\";\nimport BookmarkModel from \"../../model/Bookmark\";\nimport HtmlBookModel from \"../../model/HtmlBook\";\nimport AddTrash from \"../../utils/readUtils/addTrash\";\nexport function handleNotes(notes: NoteModel[]) {\n  return { type: \"HANDLE_NOTES\", payload: notes };\n}\nexport function handleOriginalText(originalText: string) {\n  return { type: \"HANDLE_ORIGINAL_TEXT\", payload: originalText };\n}\nexport function handleColor(color: number) {\n  return { type: \"HANDLE_COLOR\", payload: color };\n}\nexport function handleBookmarks(bookmarks: BookmarkModel[]) {\n  return { type: \"HANDLE_BOOKMARKS\", payload: bookmarks };\n}\nexport function handleDigests(digests: NoteModel[]) {\n  return { type: \"HANDLE_DIGESTS\", payload: digests };\n}\nexport function handleHtmlBook(htmlBook: HtmlBookModel) {\n  return { type: \"HANDLE_HTML_BOOK\", payload: htmlBook };\n}\nexport function handleCurrentChapter(currentChapter: string) {\n  return { type: \"HANDLE_CURRENT_CHAPTER\", payload: currentChapter };\n}\nexport function handleCurrentChapterIndex(currentChapterIndex: number) {\n  return { type: \"HANDLE_CURRENT_CHAPTER_INDEX\", payload: currentChapterIndex };\n}\nexport function handleChapters(chapters: any) {\n  return { type: \"HANDLE_CHAPTERS\", payload: chapters };\n}\nexport function handleNoteKey(key: string) {\n  return { type: \"HANDLE_NOTE_KEY\", payload: key };\n}\nexport function handleFetchNotes() {\n  return (dispatch: (arg0: { type: string; payload: NoteModel[] }) => void) => {\n    localforage.getItem(\"notes\", (err, value) => {\n      let noteArr: any;\n      if (value === null || value === []) {\n        noteArr = [];\n      } else {\n        noteArr = value;\n      }\n      let keyArr = AddTrash.getAllTrash();\n      dispatch(handleNotes(handleKeyRemove(noteArr, keyArr)));\n      dispatch(\n        handleDigests(\n          handleKeyRemove(\n            noteArr.filter((item: NoteModel) => {\n              return item.notes === \"\";\n            }),\n            keyArr\n          )\n        )\n      );\n    });\n  };\n}\nexport function flatChapter(chapters: any) {\n  let newChapter: any = [];\n  for (let i = 0; i < chapters.length; i++) {\n    if (chapters[i].subitems[0]) {\n      newChapter.push(chapters[i]);\n      newChapter = newChapter.concat(flatChapter(chapters[i].subitems));\n    } else {\n      newChapter.push(chapters[i]);\n    }\n  }\n  return newChapter;\n}\n\nexport function handleFetchBookmarks() {\n  return (\n    dispatch: (arg0: { type: string; payload: BookmarkModel[] }) => void\n  ) => {\n    localforage.getItem(\"bookmarks\", (err, value) => {\n      let bookmarkArr: any;\n      if (value === null || value === []) {\n        bookmarkArr = [];\n      } else {\n        bookmarkArr = value;\n      }\n      let keyArr = AddTrash.getAllTrash();\n      dispatch(handleBookmarks(handleKeyRemove(bookmarkArr, keyArr)));\n    });\n  };\n}\nconst handleKeyRemove = (items: any[], arr: string[]) => {\n  let itemArr: any[] = [];\n  if (!arr[0]) {\n    return items;\n  }\n  for (let i = 0; i < items.length; i++) {\n    if (arr.indexOf(items[i].bookKey) === -1) {\n      itemArr.push(items[i]);\n    }\n  }\n  return itemArr;\n};\n","export function handleShelfIndex(shelfIndex: number) {\n  return { type: \"HANDLE_SHELF_INDEX\", payload: shelfIndex };\n}\nexport function handleCollapse(isCollapsed: boolean) {\n  return { type: \"HANDLE_COLLAPSE\", payload: isCollapsed };\n}\nexport function handleMode(mode: string) {\n  return { type: \"HANDLE_MODE\", payload: mode };\n}\n","export function handleOpenMenu(isOpenMenu: boolean) {\n  return { type: \"HANDLE_OPEN_MENU\", payload: isOpenMenu };\n}\nexport function handleMenuMode(menuMode: string) {\n  return { type: \"HANDLE_MENU_MODE\", payload: menuMode };\n}\nexport function handleOpenHighlight(isOpenHighlight: boolean) {\n  return { type: \"HANDLE_OPEN_HIGHLIGHT\", payload: isOpenHighlight };\n}\nexport function handleChangeDirection(isChangeDirection: boolean) {\n  return { type: \"HANDLE_CHANGE_DIRECTION\", payload: isChangeDirection };\n}\nexport function handleShowBookmark(isShowBookmark: boolean) {\n  return { type: \"HANDLE_SHOW_BOOKMARK\", payload: isShowBookmark };\n}\nexport function handleSelection(selection: string) {\n  return { type: \"HANDLE_SELECTION\", payload: selection };\n}\n","import BookModel from \"../../model/Book\";\nclass AddTrash {\n  static setTrash(bookKey: string) {\n    let bookArr =\n      localStorage.getItem(\"deletedBooks\") !== \"{}\" &&\n      localStorage.getItem(\"deletedBooks\")\n        ? JSON.parse(localStorage.getItem(\"deletedBooks\") || \"\")\n        : [];\n    const index = bookArr.indexOf(bookKey);\n    if (index > -1) {\n      bookArr.splice(index, 1);\n      bookArr.unshift(bookKey);\n    } else {\n      bookArr.unshift(bookKey);\n    }\n\n    localStorage.setItem(\"deletedBooks\", JSON.stringify(bookArr));\n  }\n  static setAllTrash(books: BookModel[]) {\n    let bookArr: string[] = [];\n    books.forEach((item) => {\n      bookArr.push(item.key);\n    });\n    localStorage.setItem(\"deletedBooks\", JSON.stringify(bookArr));\n  }\n  static clear(bookKey: string) {\n    let bookArr =\n      localStorage.getItem(\"deletedBooks\") !== \"{}\" &&\n      localStorage.getItem(\"deletedBooks\")\n        ? JSON.parse(localStorage.getItem(\"deletedBooks\") || \"\")\n        : [];\n    const index = bookArr.indexOf(bookKey);\n    if (index > -1) {\n      bookArr.splice(index, 1);\n    }\n    localStorage.setItem(\"deletedBooks\", JSON.stringify(bookArr));\n  }\n  static getAllTrash() {\n    let bookArr =\n      localStorage.getItem(\"deletedBooks\") !== \"{}\" &&\n      localStorage.getItem(\"deletedBooks\")\n        ? JSON.parse(localStorage.getItem(\"deletedBooks\") || \"\")\n        : [];\n    return bookArr || [];\n  }\n}\n\nexport default AddTrash;\n","import BookModel from \"../../model/Book\";\nimport NoteModel from \"../../model/Note\";\nimport ReadingTime from \"./readingTime\";\nimport RecordLocation from \"./recordLocation\";\nimport _ from \"underscore\";\nimport RecordRecent from \"./recordRecent\";\nconst getBookName = (books: BookModel[]) => {\n  return books.map((item) => item.name);\n};\nconst getAuthorName = (books: BookModel[]) => {\n  return books.map((item) => item.author);\n};\nconst getBookKey = (books: BookModel[]) => {\n  return books.map((item) => item.key);\n};\nconst getBookIndex = (nameArr: string[], oldNameArr: string[]) => {\n  let indexArr: number[] = [];\n  for (let i = 0; i < nameArr.length; i++) {\n    if (oldNameArr.indexOf(nameArr[i]) > -1) {\n      //如果索引数组已经包含该索引，就把它放在随后一位，取数组长度为索引\n      indexArr.push(\n        indexArr.indexOf(oldNameArr.indexOf(nameArr[i])) > -1\n          ? indexArr.length\n          : oldNameArr.indexOf(nameArr[i])\n      );\n    }\n  }\n  return indexArr.length < nameArr.length\n    ? indexArr.concat(\n        nameArr\n          .map((item, index) => index)\n          .filter((item) => indexArr.indexOf(item) === -1)\n      )\n    : indexArr;\n};\nconst getDurationArr = () => {\n  let durationObj = ReadingTime.getAllTime();\n  var sortable: any[] = [];\n  for (let obj in durationObj) {\n    sortable.push([obj, durationObj[obj]]);\n  }\n  sortable.sort(function (a, b) {\n    return a[1] - b[1];\n  });\n  return Object.keys(durationObj);\n};\nconst getPercentageArr = () => {\n  let locationObj = RecordLocation.getAllCfi();\n  var sortable: any = [];\n  for (let obj in locationObj) {\n    sortable.push([obj, locationObj[obj].percentage || 0]);\n  }\n  sortable.sort(function (a, b) {\n    return a[1] - b[1];\n  });\n  return sortable.map((item) => item[0]);\n};\nclass SortUtil {\n  static sortBooks(\n    books: BookModel[],\n    bookSortCode: { sort: number; order: number }\n  ) {\n    let oldRecentArr = books.map((item) => item.key);\n    let recentArr = RecordRecent.getAllRecent();\n    if (bookSortCode.sort === 1 || bookSortCode.sort === 0) {\n      if (bookSortCode.order === 1) {\n        return getBookIndex(recentArr, oldRecentArr).reverse();\n      } else {\n        return getBookIndex(recentArr, oldRecentArr);\n      }\n    }\n    if (bookSortCode.sort === 2) {\n      let oldNameArr = getBookName(books);\n      let nameArr = getBookName(books).sort();\n      if (bookSortCode.order === 1) {\n        return getBookIndex(nameArr, oldNameArr).reverse();\n      } else {\n        return getBookIndex(nameArr, oldNameArr);\n      }\n    }\n    if (bookSortCode.sort === 3) {\n      let nameArr: number[] = [];\n      for (let i = 0; i < books.length; i++) {\n        nameArr.push(i);\n      }\n      if (bookSortCode.order === 1) {\n        return nameArr.reverse();\n      } else {\n        return nameArr;\n      }\n    }\n    if (bookSortCode.sort === 4) {\n      let durationKeys = getDurationArr();\n\n      let bookKeys = getBookKey(books);\n      if (bookSortCode.order === 1) {\n        return getBookIndex(\n          _.union(durationKeys, bookKeys),\n          bookKeys\n        ).reverse();\n      } else {\n        return getBookIndex(_.union(durationKeys, bookKeys), bookKeys);\n      }\n    }\n    if (bookSortCode.sort === 5) {\n      let oldAuthorArr = getAuthorName(books);\n      let authorArr = getAuthorName(books).sort();\n      if (bookSortCode.order === 1) {\n        return getBookIndex(authorArr, oldAuthorArr).reverse();\n      } else {\n        return getBookIndex(authorArr, oldAuthorArr);\n      }\n    }\n    if (bookSortCode.sort === 6) {\n      let percentagenKeys = getPercentageArr();\n      let bookKeys = getBookKey(books);\n      if (bookSortCode.order === 1) {\n        return getBookIndex(percentagenKeys, bookKeys).reverse();\n      } else {\n        return getBookIndex(percentagenKeys, bookKeys);\n      }\n    }\n  }\n  static sortNotes(\n    notes: NoteModel[],\n    noteSortCode: { sort: number; order: number },\n    books: BookModel[] = []\n  ) {\n    if (noteSortCode.sort === 2) {\n      //使书摘从晚到早排序\n      let noteArr = _.clone(notes).reverse();\n      let dateArr = _.uniq(\n        notes.map(\n          (item) =>\n            \"\" + item.date.year + \"-\" + item.date.month + \"-\" + item.date.day\n        )\n      );\n      if (noteSortCode.order === 1) {\n        dateArr.sort();\n      } else {\n        dateArr.sort().reverse();\n      }\n      //得到以日期为键，书摘为值的对象\n      let noteObj: { [key: string]: any } = {};\n      dateArr.forEach((date) => {\n        noteObj[date] = [];\n      });\n      noteArr.forEach((note) => {\n        dateArr.forEach((date) => {\n          if (\n            date ===\n            \"\" + note.date.year + \"-\" + note.date.month + \"-\" + note.date.day\n          ) {\n            noteObj[date].push(note);\n          }\n        });\n      });\n      return noteObj || {};\n    }\n    if (noteSortCode.sort === 1) {\n      //使书摘从晚到早排序\n      let noteArr = _.clone(notes).reverse();\n      let nameArr = _.uniq(\n        notes.map(\n          (item) =>\n            books[\n              _.findLastIndex(books, {\n                key: item.bookKey,\n              })\n            ].name\n        )\n      );\n      if (noteSortCode.order === 1) {\n        nameArr.sort();\n      } else {\n        nameArr.sort().reverse();\n      }\n      //得到以日期为键，书摘为值的对象\n      let noteObj: { [key: string]: any } = {};\n      nameArr.forEach((name) => {\n        noteObj[name] = [];\n      });\n      noteArr.forEach((note) => {\n        nameArr.forEach((name) => {\n          if (\n            name ===\n            books[\n              _.findLastIndex(books, {\n                key: note.bookKey,\n              })\n            ].name\n          ) {\n            noteObj[name].push(note);\n          }\n        });\n      });\n      return noteObj || {};\n    }\n  }\n  static setBookSortCode(sortCode: number, orderCode: number) {\n    let json =\n      localStorage.getItem(\"bookSortCode\") ||\n      JSON.stringify({ sort: 1, order: 2 });\n    let obj = json ? JSON.parse(json) : { sort: 1, order: 2 };\n    obj.sort = sortCode;\n    obj.order = orderCode;\n    localStorage.setItem(\"bookSortCode\", JSON.stringify(obj));\n  }\n\n  static getBookSortCode() {\n    let json =\n      localStorage.getItem(\"bookSortCode\") ||\n      JSON.stringify({ sort: 1, order: 2 });\n    let obj = JSON.parse(json) || { sort: 1, order: 2 };\n    return obj || null;\n  }\n  static setNoteSortCode(sort: number, order: number) {\n    let json =\n      localStorage.getItem(\"noteSortCode\") ||\n      JSON.stringify({ sort: 2, order: 2 });\n    let obj = json ? JSON.parse(json) : { sort: 2, order: 2 };\n    obj.sort = sort;\n    obj.order = order;\n    localStorage.setItem(\"noteSortCode\", JSON.stringify(obj));\n  }\n\n  static getNoteSortCode() {\n    let json =\n      localStorage.getItem(\"noteSortCode\") ||\n      JSON.stringify({ sort: 2, order: 2 });\n    let obj = JSON.parse(json) || { sort: 2, order: 2 };\n    return obj || null;\n  }\n}\n\nexport default SortUtil;\n","import { isElectron } from \"react-device-detect\";\nimport StorageUtil from \"./storageUtil\";\n\nexport const openExternalUrl = (url: string) => {\n  window.open_url(url);\n};\n","import BookModel from \"../../model/Book\";\nimport localforage from \"localforage\";\nimport BookUtil from \"../fileUtils/bookUtil\";\nimport NoteModel from \"../../model/Note\";\nimport BookmarkModel from \"../../model/Bookmark\";\nimport { isElectron } from \"react-device-detect\";\n\nlet configArr = [\n  \"notes.json\",\n  \"books.json\",\n  \"bookmarks.json\",\n  \"readerConfig.json\",\n  \"noteTags.json\",\n  \"themeColors.json\",\n  \"bookSortCode.json\",\n  \"noteSortCode.json\",\n  \"readingTime.json\",\n  \"recentBooks.json\",\n  \"favoriteBooks.json\",\n  \"favoriteBooks.json\",\n  \"shelfList.json\",\n  \"pdfjs.history.json\",\n  \"recordLocation.json\",\n];\nexport function getParamsFromUrl() {\n  var hashParams: any = {};\n  var e,\n    r = /([^&;=]+)=?([^&;]*)/g,\n    q =\n      window.location.hash.substring(2) ||\n      window.location.search.substring(1).split(\"#\")[0];\n\n  while ((e = r.exec(q))) {\n    hashParams[e[1]] = decodeURIComponent(e[2]);\n  }\n  return hashParams;\n}\n//移动文件到指定路径\nexport const moveData = (\n  blob,\n  driveIndex,\n  books: BookModel[] = [],\n  handleFinish: () => void = () => {}\n) => {\n  let file = new File([blob], \"config.zip\", {\n    lastModified: new Date().getTime(),\n    type: blob.type,\n  });\n  const fs = window.require(\"fs\");\n  const path = window.require(\"path\");\n  const AdmZip = window.require(\"adm-zip\");\n\n  const { ipcRenderer } = window.require(\"electron\");\n  const dirPath = ipcRenderer.sendSync(\"user-data\", \"ping\");\n  const dataPath = localStorage.getItem(\"storageLocation\")\n    ? localStorage.getItem(\"storageLocation\")\n    : window\n        .require(\"electron\")\n        .ipcRenderer.sendSync(\"storage-location\", \"ping\");\n  var reader = new FileReader();\n  reader.readAsArrayBuffer(file);\n  reader.onload = async (event) => {\n    if (!event.target) return;\n    if (!fs.existsSync(path.join(dirPath))) {\n      fs.mkdirSync(path.join(dirPath));\n    }\n    fs.writeFileSync(\n      path.join(dirPath, file.name),\n      Buffer.from(event.target.result as any)\n    );\n    var zip = new AdmZip(path.join(dirPath, file.name));\n    zip.extractAllTo(/*target path*/ dataPath, /*overwrite*/ true);\n    const fs_extra = window.require(\"fs-extra\");\n    fs_extra.copy(\n      path.join(dirPath, file.name),\n      path.join(dataPath, file.name),\n      function (err) {\n        if (err) return;\n      }\n    );\n    if (driveIndex === 4) {\n      let deleteBooks = books.map((item) => {\n        return localforage.removeItem(item.key);\n      });\n      await Promise.all(deleteBooks);\n    }\n    if (driveIndex === 5) {\n      handleFinish();\n    }\n  };\n};\n//改变数据存储路径\nexport const changePath = (oldPath: string, newPath: string) => {\n  return new Promise<number>((resolve, reject) => {\n    const fs = window.require(\"fs-extra\");\n    try {\n      fs.readdir(newPath, (err, files: string[]) => {\n        let isConfiged: boolean = false;\n        files.forEach((file: string) => {\n          if (file === \"config.zip\") {\n            isConfiged = true;\n          }\n        });\n        if (isConfiged) {\n          localStorage.setItem(\"storageLocation\", newPath);\n          resolve(1);\n        } else {\n          fs.copy(oldPath, newPath, function (err) {\n            if (err) return;\n            fs.emptyDirSync(oldPath);\n            resolve(2);\n          });\n        }\n      });\n    } catch (error) {\n      console.log(error);\n      resolve(0);\n    }\n  });\n};\nexport const syncData = (blob: Blob, books: BookModel[] = [], isSync: true) => {\n  return new Promise<boolean>((resolve, reject) => {\n    let file = new File([blob], \"config.zip\", {\n      lastModified: new Date().getTime(),\n      type: blob.type,\n    });\n    const fs = window.require(\"fs\");\n    const path = window.require(\"path\");\n    const AdmZip = window.require(\"adm-zip\");\n    const dataPath = localStorage.getItem(\"storageLocation\")\n      ? localStorage.getItem(\"storageLocation\")\n      : window\n          .require(\"electron\")\n          .ipcRenderer.sendSync(\"storage-location\", \"ping\");\n    var reader = new FileReader();\n    reader.readAsArrayBuffer(file);\n    reader.onload = async (event) => {\n      if (!event.target) return;\n      if (!fs.existsSync(path.join(dataPath))) {\n        fs.mkdirSync(path.join(dataPath));\n      }\n      fs.writeFileSync(\n        path.join(dataPath, file.name),\n        Buffer.from(event.target.result as any)\n      );\n      var zip = new AdmZip(path.join(dataPath, file.name));\n      zip.extractAllTo(/*target path*/ dataPath, /*overwrite*/ true);\n\n      if (!isSync) {\n        let deleteBooks = books.map((item) => {\n          return localforage.removeItem(item.key);\n        });\n        await Promise.all(deleteBooks);\n        resolve(true);\n      } else {\n        resolve(true);\n      }\n    };\n  });\n};\n\nexport const zipBook = (zip: any, books: BookModel[]) => {\n  return new Promise<boolean>(async (resolve, reject) => {\n    let bookZip = zip.folder(\"book\");\n    let data: any = [];\n    books &&\n      books.forEach((item) => {\n        data.push(\n          !isElectron\n            ? localforage.getItem(item.key)\n            : BookUtil.fetchBook(item.key, false, item.path)\n        );\n      });\n    try {\n      let results = await Promise.all(data);\n      for (let i = 0; i < books.length; i++) {\n        results[i] && bookZip.file(`${books[i].key}`, results[i]);\n      }\n      resolve(true);\n    } catch (error) {\n      resolve(false);\n    }\n  });\n};\n\nexport const unzipConfig = (zipEntries: any) => {\n  return new Promise<boolean>((resolve, reject) => {\n    zipEntries.forEach(function (zipEntry) {\n      let text = zipEntry.getData().toString(\"utf8\");\n      if (configArr.indexOf(zipEntry.name) > -1 && text) {\n        if (\n          zipEntry.name === \"notes.json\" ||\n          zipEntry.name === \"books.json\" ||\n          zipEntry.name === \"bookmarks.json\"\n        ) {\n          localforage.setItem(zipEntry.name.split(\".\")[0], JSON.parse(text));\n        } else if (zipEntry.name === \"pdfjs.history.json\") {\n          localStorage.setItem(\"pdfjs.history\", text);\n        } else {\n          localStorage.setItem(zipEntry.name.split(\".\")[0], text);\n        }\n      }\n    });\n    resolve(true);\n  });\n};\n\nconst toArrayBuffer = (buf) => {\n  const ab = new ArrayBuffer(buf.length);\n  const view = new Uint8Array(ab);\n  for (let i = 0; i < buf.length; ++i) {\n    view[i] = buf[i];\n  }\n  return ab;\n};\nexport const unzipBook = (zipEntries: any) => {\n  return new Promise<boolean>((resolve, reject) => {\n    localforage.getItem(\"books\").then((value: any) => {\n      let count = 0;\n      value &&\n        value.length > 0 &&\n        value.forEach((item: any) => {\n          zipEntries.forEach(async (zipEntry) => {\n            if (zipEntry.name === item.key) {\n              await BookUtil.addBook(\n                item.key,\n                toArrayBuffer(zipEntry.getData())\n              );\n              count++;\n              if (count === value.length) {\n                resolve(true);\n              }\n            }\n          });\n        });\n    });\n  });\n};\nexport const zipConfig = (\n  zip: any,\n  books: BookModel[],\n  notes: NoteModel[],\n  bookmarks: BookmarkModel[]\n) => {\n  return new Promise<boolean>((resolve, reject) => {\n    try {\n      let configZip = zip.folder(\"config\");\n      configZip\n        .file(\"notes.json\", JSON.stringify(notes))\n        .file(\"books.json\", JSON.stringify(books))\n        .file(\"bookmarks.json\", JSON.stringify(bookmarks))\n        .file(\"readerConfig.json\", localStorage.getItem(\"readerConfig\") || \"\")\n        .file(\"themeColors.json\", localStorage.getItem(\"themeColors\") || \"\")\n        .file(\n          \"bookSortCode.json\",\n          localStorage.getItem(\"bookSortCode\") ||\n            JSON.stringify({ sort: 1, order: 2 })\n        )\n        .file(\n          \"noteSortCode.json\",\n          localStorage.getItem(\"noteSortCode\") ||\n            JSON.stringify({ sort: 2, order: 2 })\n        )\n        .file(\"readingTime.json\", localStorage.getItem(\"readingTime\") || \"\")\n        .file(\"recentBooks.json\", localStorage.getItem(\"recentBooks\") || [])\n        .file(\"deletedBooks.json\", localStorage.getItem(\"deletedBooks\") || [])\n        .file(\"favoriteBooks.json\", localStorage.getItem(\"favoriteBooks\") || [])\n        .file(\"shelfList.json\", localStorage.getItem(\"shelfList\") || [])\n        .file(\"noteTags.json\", localStorage.getItem(\"noteTags\") || [])\n        .file(\"pdfjs.history.json\", localStorage.getItem(\"pdfjs.history\") || [])\n        .file(\n          \"recordLocation.json\",\n          localStorage.getItem(\"recordLocation\") || \"\"\n        );\n      resolve(true);\n    } catch (error) {\n      resolve(false);\n    }\n  });\n};\n","import i18n from \"i18next\";\nimport { initReactI18next } from \"react-i18next\";\nimport translationEN from \"./assets/locales/en/translation.json\";\nimport translationCN from \"./assets/locales/cn/translation.json\";\nimport translationTW from \"./assets/locales/tw/translation.json\";\nimport translationRO from \"./assets/locales/ro/translation.json\";\nimport translationPL from \"./assets/locales/pl/translation.json\";\nimport translationCS from \"./assets/locales/cs/translation.json\";\nimport translationJP from \"./assets/locales/jp/translation.json\";\nimport translationKO from \"./assets/locales/ko/translation.json\";\nimport translationDE from \"./assets/locales/de/translation.json\";\nimport translationRU from \"./assets/locales/ru/translation.json\";\nimport translationFR from \"./assets/locales/fr/translation.json\";\nimport translationES from \"./assets/locales/es/translation.json\";\nimport translationFA from \"./assets/locales/fa/translation.json\";\nimport translationPTBR from \"./assets/locales/pt-BR/translation.json\";\n\n// the translations\nconst resources = {\n  en: {\n    translation: translationEN,\n  },\n  zh: {\n    translation: translationCN,\n  },\n  cht: {\n    translation: translationTW,\n  },\n  ro: {\n    translation: translationRO,\n  },\n  pl: {\n    translation: translationPL,\n  },\n  cs: {\n    translation: translationCS,\n  },\n  jp: {\n    translation: translationJP,\n  },\n  ko: {\n    translation: translationKO,\n  },\n  de: {\n    translation: translationDE,\n  },\n  ru: {\n    translation: translationRU,\n  },\n  es: {\n    translation: translationES,\n  },\n  fr: {\n    translation: translationFR,\n  },\n  fa: {\n    translation: translationFA,\n  },\n  ptBR: {\n    translation: translationPTBR,\n  },\n};\n\ni18n\n  .use(initReactI18next) // passes i18n down to react-i18next\n  .init({\n    resources,\n    lng: \"en\",\n    fallbackLng: \"en\",\n    keySeparator: false, // we do not use keys in form messages.welcome\n    interpolation: {\n      escapeValue: false, // react already safes from xss\n    },\n  });\n\nexport default i18n;\n","const initState = {\n  isOpenEditDialog: false,\n  isOpenDeleteDialog: false,\n  isOpenAddDialog: false,\n  isOpenActionDialog: false,\n  isReading: false,\n  dragItem: \"\",\n  currentBook: {},\n  renderBookFunc: () => {},\n  renderNoteFunc: () => {},\n};\nexport function book(\n  state = initState,\n  action: { type: string; payload: any }\n) {\n  switch (action.type) {\n    case \"HANDLE_EDIT_DIALOG\":\n      return {\n        ...state,\n        isOpenEditDialog: action.payload,\n      };\n    case \"HANDLE_DELETE_DIALOG\":\n      return {\n        ...state,\n        isOpenDeleteDialog: action.payload,\n      };\n    case \"HANDLE_RENDER_BOOK_FUNC\":\n      return {\n        ...state,\n        renderBookFunc: action.payload,\n      };\n    case \"HANDLE_RENDER_NOTE_FUNC\":\n      return {\n        ...state,\n        renderNoteFunc: action.payload,\n      };\n    case \"HANDLE_ADD_DIALOG\":\n      return {\n        ...state,\n        isOpenAddDialog: action.payload,\n      };\n    case \"HANDLE_ACTION_DIALOG\":\n      return {\n        ...state,\n        isOpenActionDialog: action.payload,\n      };\n    case \"HANDLE_READING_STATE\":\n      return {\n        ...state,\n        isReading: action.payload,\n      };\n    case \"HANDLE_READING_BOOK\":\n      return {\n        ...state,\n        currentBook: action.payload,\n      };\n    case \"HANDLE_DRAG_ITEM\":\n      return {\n        ...state,\n        dragItem: action.payload,\n      };\n    case \"HANDLE_REDIRECT\":\n      return {\n        ...state,\n        isRedirect: true,\n      };\n    default:\n      return state;\n  }\n}\n","const initState = {\n  books: null,\n  deletedBooks: [],\n  searchResults: [],\n  isSearch: false,\n  isAboutOpen: false,\n  isBookSort: localStorage.getItem(\"bookSortCode\") ? true : false,\n  isNoteSort: false,\n  isSettingOpen: false,\n  viewMode: \"card\",\n  isSortDisplay: false,\n  isShowLoading: false,\n  isNewWarning: false,\n  isTipDialog: false,\n  isShowNew: false,\n  bookSortCode: { sort: 1, order: 2 },\n  noteSortCode: { sort: 2, order: 2 },\n  isSelectBook: false,\n  message: \"Add Successfully\",\n  tip: \"\",\n  selectedBooks: [],\n};\nexport function manager(\n  state = initState,\n  action: { type: string; payload: any }\n) {\n  switch (action.type) {\n    case \"HANDLE_BOOKS\":\n      return {\n        ...state,\n        books: action.payload,\n      };\n    case \"HANDLE_DELETED_BOOKS\":\n      return {\n        ...state,\n        deletedBooks: action.payload,\n      };\n    case \"HANDLE_SEARCH_BOOKS\":\n      return {\n        ...state,\n        searchResults: action.payload,\n      };\n    case \"HANDLE_SELECT_BOOK\":\n      return {\n        ...state,\n        isSelectBook: action.payload,\n      };\n    case \"HANDLE_SELECTED_BOOKS\":\n      return {\n        ...state,\n        selectedBooks: action.payload,\n      };\n    case \"HANDLE_TIP_DIALOG\":\n      return {\n        ...state,\n        isTipDialog: action.payload,\n      };\n    case \"HANDLE_TIP\":\n      return {\n        ...state,\n        tip: action.payload,\n      };\n    case \"HANDLE_SEARCH\":\n      return {\n        ...state,\n        isSearch: action.payload,\n      };\n\n    case \"HANDLE_SETTING\":\n      return {\n        ...state,\n        isSettingOpen: action.payload,\n      };\n    case \"HANDLE_ABOUT\":\n      return {\n        ...state,\n        isAboutOpen: action.payload,\n      };\n    case \"HANDLE_BOOK_SORT\":\n      return {\n        ...state,\n        isBookSort: action.payload,\n      };\n    case \"HANDLE_NOTE_SORT\":\n      return {\n        ...state,\n        isNoteSort: action.payload,\n      };\n\n    case \"HANDLE_VIEW_MODE\":\n      return {\n        ...state,\n        viewMode: action.payload,\n      };\n    case \"HANDLE_SORT_DISPLAY\":\n      return {\n        ...state,\n        isSortDisplay: action.payload,\n      };\n    case \"HANDLE_SHOW_LOADING\":\n      return {\n        ...state,\n        isShowLoading: action.payload,\n      };\n    case \"HANDLE_SHOW_NEW\":\n      return {\n        ...state,\n        isShowNew: action.payload,\n      };\n    case \"HANDLE_NEW_WARNING\":\n      return {\n        ...state,\n        isNewWarning: action.payload,\n      };\n\n    case \"HANDLE_SORT_CODE\":\n      return {\n        ...state,\n        bookSortCode: {\n          sort: action.payload.sort,\n          order: action.payload.order,\n        },\n      };\n    case \"HANDLE_NOTE_SORT_CODE\":\n      return {\n        ...state,\n        noteSortCode: {\n          sort: action.payload.sort,\n          order: action.payload.order,\n        },\n      };\n    case \"HANDLE_NOTES\":\n      return {\n        ...state,\n        notes: action.payload,\n      };\n    case \"HANDLE_BOOKMARKS\":\n      return {\n        ...state,\n        bookmarks: action.payload,\n      };\n\n    default:\n      return state;\n  }\n}\n","const initState = {\n  percentage: null,\n  locations: null,\n};\nexport function progressPanel(\n  state = initState,\n  action: { type: string; payload: any }\n) {\n  switch (action.type) {\n    case \"HANDLE_PERCENTAGE\":\n      return {\n        ...state,\n        percentage: action.payload,\n      };\n\n    case \"HANDLE_SECTION\":\n      return {\n        ...state,\n        section: action.payload,\n      };\n    case \"HANDLE_LOCATIONS\":\n      return {\n        ...state,\n        locations: action.payload,\n      };\n    default:\n      return state;\n  }\n}\n","import StorageUtil from \"../../utils/serviceUtils/storageUtil\";\nconst initState = {\n  bookmarks: [],\n  notes: [],\n  digests: [],\n  chapters: null,\n  currentChapter: \"\",\n  currentChapterIndex: 0,\n\n  color: parseInt(StorageUtil.getReaderConfig(\"highlightIndex\"))\n    ? parseInt(StorageUtil.getReaderConfig(\"highlightIndex\"))\n    : StorageUtil.getReaderConfig(\"appSkin\") === \"night\" ||\n      (StorageUtil.getReaderConfig(\"appSkin\") === \"system\" &&\n        StorageUtil.getReaderConfig(\"isOSNight\") === \"yes\")\n    ? 3\n    : 0,\n  noteKey: \"\",\n  originalText: \"\",\n  htmlBook: null,\n  readerMode: StorageUtil.getReaderConfig(\"readerMode\") || \"double\",\n};\nexport function reader(\n  state = initState,\n  action: { type: string; payload: any }\n) {\n  switch (action.type) {\n    case \"HANDLE_BOOKMARKS\":\n      return {\n        ...state,\n        bookmarks: action.payload,\n      };\n    case \"HANDLE_NOTES\":\n      return {\n        ...state,\n        notes: action.payload,\n      };\n    case \"HANDLE_CURRENT_CHAPTER\":\n      return {\n        ...state,\n        currentChapter: action.payload,\n      };\n    case \"HANDLE_CURRENT_CHAPTER_INDEX\":\n      return {\n        ...state,\n        currentChapterIndex: action.payload,\n      };\n    case \"HANDLE_ORIGINAL_TEXT\":\n      return {\n        ...state,\n        originalText: action.payload,\n      };\n    case \"HANDLE_HTML_BOOK\":\n      return {\n        ...state,\n        htmlBook: action.payload,\n      };\n    case \"HANDLE_COLOR\":\n      return {\n        ...state,\n        color: action.payload,\n      };\n\n    case \"HANDLE_NOTE_KEY\":\n      return {\n        ...state,\n        noteKey: action.payload,\n      };\n    case \"HANDLE_DIGESTS\":\n      return {\n        ...state,\n        digests: action.payload,\n      };\n    case \"HANDLE_SECTION\":\n      return {\n        ...state,\n        section: action.payload,\n      };\n    case \"HANDLE_CHAPTERS\":\n      return {\n        ...state,\n        chapters: action.payload,\n      };\n    default:\n      return state;\n  }\n}\n","const initState = {\n  selection: null,\n  isOpenMenu: false,\n  menuMode: \"menu\",\n  isChangeDirection: false,\n  isShowBookmark: false,\n};\nexport function viewArea(\n  state = initState,\n  action: { type: string; payload: any }\n) {\n  switch (action.type) {\n    case \"HANDLE_OPEN_MENU\":\n      return {\n        ...state,\n        isOpenMenu: action.payload,\n      };\n    case \"HANDLE_OPEN_HIGHLIGHT\":\n      return {\n        ...state,\n        isOpenHighlight: action.payload,\n      };\n\n    case \"HANDLE_SHOW_BOOKMARK\":\n      return {\n        ...state,\n        isShowBookmark: action.payload,\n      };\n    case \"HANDLE_SELECTION\":\n      return {\n        ...state,\n        selection: action.payload,\n      };\n    case \"HANDLE_DIALOG_LOCATION\":\n      return {\n        ...state,\n        dialogLocation: action.payload,\n      };\n    case \"HANDLE_MENU_MODE\":\n      return {\n        ...state,\n        menuMode: action.payload,\n      };\n    case \"HANDLE_CHANGE_DIRECTION\":\n      return {\n        ...state,\n        isChangeDirection: action.payload,\n      };\n    default:\n      return state;\n  }\n}\n","import StorageUtil from \"../../utils/serviceUtils/storageUtil\";\nconst initState = {\n  mode: \"home\",\n  shelfIndex: -1,\n  isCollapsed: StorageUtil.getReaderConfig(\"isCollapsed\") === \"yes\",\n};\nexport function sidebar(\n  state = initState,\n  action: { type: string; payload: any }\n) {\n  switch (action.type) {\n    case \"HANDLE_MODE\":\n      return {\n        ...state,\n        mode: action.payload,\n      };\n    case \"HANDLE_SHELF_INDEX\":\n      return {\n        ...state,\n        shelfIndex: action.payload,\n      };\n    case \"HANDLE_COLLAPSE\":\n      return {\n        ...state,\n        isCollapsed: action.payload,\n      };\n    default:\n      return state;\n  }\n}\n","const initState = {\n  isBackup: false,\n  isOpenTokenDialog: false,\n};\nexport function backupPage(\n  state = initState,\n  action: { type: string; payload: boolean }\n) {\n  switch (action.type) {\n    case \"HANDLE_BACKUP\":\n      return {\n        ...state,\n        isBackup: action.payload,\n      };\n    case \"HANDLE_TOKEN_DIALOG\":\n      return {\n        ...state,\n        isOpenTokenDialog: action.payload,\n      };\n    default:\n      return state;\n  }\n}\n","import { createStore, applyMiddleware, compose, combineReducers } from \"redux\";\nimport thunk from \"redux-thunk\";\nimport { book } from \"./reducers/book\";\nimport { manager } from \"./reducers/manager\";\nimport { progressPanel } from \"./reducers/progressPanel\";\nimport { reader } from \"./reducers/reader\";\nimport { viewArea } from \"./reducers/viewArea\";\nimport { sidebar } from \"./reducers/sidebar\";\nimport { backupPage } from \"./reducers/backupPage\";\nimport BookModel from \"../model/Book\";\nimport NoteModel from \"../model/Note\";\nimport BookmarkModel from \"../model/Bookmark\";\nimport HtmlBookModel from \"../model/HtmlBook\";\nconst rootReducer = combineReducers({\n  book,\n  manager,\n  reader,\n  progressPanel,\n  viewArea,\n  sidebar,\n  backupPage,\n});\nconst store = createStore(\n  rootReducer,\n  compose(\n    applyMiddleware(thunk),\n    (window as any).devToolsExtension\n      ? (window as any).devToolsExtension()\n      : (f: any) => f\n  )\n);\nexport default store;\nexport type stateType = {\n  manager: {\n    books: BookModel[];\n    deletedBooks: BookModel[];\n    searchResults: number[];\n    isSearch: boolean;\n    isBookSort: boolean;\n    isSettingOpen: boolean;\n    viewMode: string;\n    isSortDisplay: boolean;\n    isAboutOpen: boolean;\n    isShowLoading: boolean;\n    isShowNew: boolean;\n    isNewWarning: boolean;\n    isSelectBook: boolean;\n    selectedBooks: string[];\n    isTipDialog: boolean;\n    bookSortCode: { sort: number; order: number };\n    noteSortCode: { sort: number; order: number };\n    tip: string;\n  };\n  book: {\n    isOpenEditDialog: boolean;\n    isOpenDeleteDialog: boolean;\n    isOpenAddDialog: boolean;\n    isOpenActionDialog: boolean;\n    isReading: boolean;\n    dragItem: string;\n    currentBook: BookModel;\n    renderBookFunc: () => void;\n    renderNoteFunc: () => void;\n  };\n  backupPage: {\n    isBackup: boolean;\n    isOpenTokenDialog: boolean;\n  };\n  progressPanel: {\n    percentage: number;\n    locations: any[];\n  };\n  reader: {\n    bookmarks: BookmarkModel[];\n    notes: NoteModel[];\n    digests: NoteModel[];\n    color: number;\n    chapters: any[];\n    noteKey: string;\n    currentChapter: string;\n    currentChapterIndex: number;\n    originalText: string;\n    htmlBook: HtmlBookModel;\n  };\n  sidebar: {\n    mode: string;\n    shelfIndex: number;\n    isCollapsed: boolean;\n  };\n  viewArea: {\n    selection: string;\n    menuMode: string;\n    isOpenMenu: boolean;\n    isChangeDirection: boolean;\n    isShowBookmark: boolean;\n  };\n};\n","export const sideMenu = [\n  {\n    name: \"Books\",\n    icon: \"home\",\n    mode: \"home\",\n  },\n  {\n    name: \"Favorites\",\n    icon: \"love\",\n    mode: \"favorite\",\n  },\n\n  {\n    name: \"Notes\",\n    icon: \"idea\",\n    mode: \"note\",\n  },\n  {\n    name: \"Highlights\",\n    icon: \"digest\",\n    mode: \"digest\",\n  },\n  {\n    name: \"Deleted Books\",\n    icon: \"trash\",\n    mode: \"trash\",\n  },\n];\n","import React from \"react\";\nimport \"./sidebar.css\";\nimport { sideMenu } from \"../../constants/sideMenu\";\nimport { SidebarProps, SidebarState } from \"./interface\";\nimport { withRouter } from \"react-router-dom\";\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\nimport { Tooltip } from \"react-tippy\";\nimport { openExternalUrl } from \"../../utils/serviceUtils/urlUtil\";\n\nclass Sidebar extends React.Component<SidebarProps, SidebarState> {\n  constructor(props: SidebarProps) {\n    super(props);\n    this.state = {\n      index: 0,\n      hoverIndex: -1,\n      isCollapsed:\n        StorageUtil.getReaderConfig(\"isCollapsed\") === \"yes\" || false,\n    };\n  }\n  componentDidMount() {\n    this.props.handleMode(\n      document.URL.split(\"/\").reverse()[0] === \"empty\"\n        ? \"home\"\n        : document.URL.split(\"/\").reverse()[0]\n    );\n  }\n  handleSidebar = (mode: string, index: number) => {\n    this.setState({ index: index });\n    this.props.handleSelectBook(false);\n    this.props.history.push(`/manager/${mode}`);\n    this.props.handleMode(mode);\n    this.props.handleShelfIndex(-1);\n    this.props.handleSearch(false);\n    this.props.handleSortDisplay(false);\n  };\n  handleHover = (index: number) => {\n    this.setState({ hoverIndex: index });\n  };\n  handleCollapse = (isCollapsed: boolean) => {\n    this.setState({ isCollapsed });\n    this.props.handleCollapse(isCollapsed);\n    StorageUtil.setReaderConfig(\"isCollapsed\", isCollapsed ? \"yes\" : \"no\");\n  };\n  handleJump = (url: string) => {\n    openExternalUrl(url);\n  };\n  render() {\n    const renderSideMenu = () => {\n      return sideMenu.map((item, index) => {\n        return (\n          <li\n            key={item.name}\n            className={\n              this.state.index === index\n                ? \"active side-menu-item\"\n                : \"side-menu-item\"\n            }\n            id={`sidebar-${item.icon}`}\n            onClick={() => {\n              this.handleSidebar(item.mode, index);\n            }}\n            onMouseEnter={() => {\n              this.handleHover(index);\n            }}\n            onMouseLeave={() => {\n              this.handleHover(-1);\n            }}\n            style={this.props.isCollapsed ? { width: 40, marginLeft: 15 } : {}}\n          >\n            {this.state.index === index ? (\n              <div className=\"side-menu-selector-container\"></div>\n            ) : null}\n            {this.state.hoverIndex === index ? (\n              <div className=\"side-menu-hover-container\"></div>\n            ) : null}\n            <div\n              className={\n                this.state.index === index\n                  ? \"side-menu-selector active-selector\"\n                  : \"side-menu-selector \"\n              }\n            >\n              <Tooltip\n                title={this.props.t(item.name)}\n                position=\"top\"\n                trigger=\"mouseenter\"\n              >\n                <div\n                  className=\"side-menu-icon\"\n                  style={this.props.isCollapsed ? {} : { marginLeft: \"38px\" }}\n                >\n                  <span\n                    className={\n                      this.state.index === index\n                        ? `icon-${item.icon}  active-icon`\n                        : `icon-${item.icon}`\n                    }\n                    style={\n                      this.props.isCollapsed ? { marginLeft: \"-25px\" } : {}\n                    }\n                  ></span>\n                </div>\n              </Tooltip>\n              <span style={this.props.isCollapsed ? { display: \"none\" } : {}}>\n                {this.props.t(item.name)}\n              </span>\n            </div>\n          </li>\n        );\n      });\n    };\n    return (\n      <div className=\"sidebar\">\n        <div\n          className=\"sidebar-list-icon\"\n          onClick={() => {\n            this.handleCollapse(!this.state.isCollapsed);\n          }}\n        >\n          <Tooltip\n            title={this.props.t(\n              this.props.isCollapsed ? \"Show sidebar\" : \"Collapse sidebar\"\n            )}\n            position=\"top\"\n            trigger=\"mouseenter\"\n            distance={25}\n          >\n            <span className=\"icon-menu sidebar-list\"></span>\n          </Tooltip>\n        </div>\n\n        <img\n          src={\n            StorageUtil.getReaderConfig(\"appSkin\") === \"night\" ||\n            (StorageUtil.getReaderConfig(\"appSkin\") === \"system\" &&\n              StorageUtil.getReaderConfig(\"isOSNight\") === \"yes\")\n              ? \"./assets/label_light.png\"\n              : \"./assets/label.png\"\n          }\n          alt=\"\"\n          onClick={() => {\n            this.handleJump(\"https://koodo.960960.xyz\");\n          }}\n          className=\"logo\"\n        />\n        <div className=\"side-menu-container-parent\">\n          <ul className=\"side-menu-container\">{renderSideMenu()}</ul>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default withRouter(Sidebar);\n","import {\n  handleMode,\n  handleSearch,\n  handleSortDisplay,\n  handleCollapse,\n  handleSelectBook,\n  handleShelfIndex,\n} from \"../../store/actions\";\nimport { connect } from \"react-redux\";\nimport { stateType } from \"../../store\";\nimport { withTranslation } from \"react-i18next\";\nimport Sidebar from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return { mode: state.sidebar.mode, isCollapsed: state.sidebar.isCollapsed };\n};\nconst actionCreator = {\n  handleMode,\n  handleSearch,\n  handleSortDisplay,\n  handleCollapse,\n  handleSelectBook,\n  handleShelfIndex,\n};\n\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(Sidebar as any));\n","import BookModel from \"../../model/Book\";\nimport NoteModel from \"../../model/Note\";\nclass SearchUtil {\n  static MergeArray(arr1: number[], arr2: number[]) {\n    var _arr: number[] = [];\n    for (let item of arr1) {\n      _arr.push(item);\n    }\n    for (let item of arr2) {\n      var flag = true;\n      for (let subitem of arr1) {\n        if (item === subitem) {\n          flag = false;\n          break;\n        }\n      }\n      if (flag) {\n        _arr.push(item);\n      }\n    }\n    return _arr;\n  }\n  static fuzzyQuery(list: string[], keyWord: string) {\n    var arr: number[] = [];\n    for (var i = 0; i < list.length; i++) {\n      if (list[i].indexOf(keyWord) > -1) {\n        arr.push(i);\n      }\n    }\n    return arr;\n  }\n  static MouseSearch(books: BookModel[]) {\n    let keyword = (\n      document.querySelector(\".header-search-box\") as HTMLInputElement\n    ).value.toLowerCase();\n    let bookNameArr: string[] = [];\n    let AuthorNameArr: string[] = [];\n    if (!books) return [];\n    books.forEach((item) => {\n      bookNameArr.push(item.name.toLowerCase());\n      AuthorNameArr.push(item.author.toLowerCase());\n    });\n    let bookResults = this.fuzzyQuery(bookNameArr, keyword);\n    let authorResults = this.fuzzyQuery(AuthorNameArr, keyword);\n\n    return this.MergeArray(bookResults, authorResults);\n  }\n  static KeySearch(event: any, books: BookModel[]) {\n    if (event && event.keyCode === 13) {\n      let bookNameArr: string[] = [];\n      let AuthorNameArr: string[] = [];\n      if (!books) return [];\n\n      books.forEach((item) => {\n        bookNameArr.push(item.name.toLowerCase());\n        AuthorNameArr.push(item.author.toLowerCase());\n      });\n      let bookResults = this.fuzzyQuery(\n        bookNameArr,\n        event.target.value.toLowerCase()\n      );\n      let authorResults = this.fuzzyQuery(\n        AuthorNameArr,\n        event.target.value.toLowerCase()\n      );\n\n      return this.MergeArray(bookResults, authorResults);\n    }\n  }\n  static MouseNoteSearch(notes: NoteModel[]) {\n    let keyword = (\n      document.querySelector(\".header-search-box\") as HTMLInputElement\n    ).value.toLowerCase();\n    let noteArr: string[] = [];\n    let textArr: string[] = [];\n    notes.forEach((item: NoteModel) => {\n      noteArr.push(item.notes.toLowerCase());\n      textArr.push(item.text.toLowerCase());\n    });\n    let noteResults = this.fuzzyQuery(noteArr, keyword);\n    let textResults = this.fuzzyQuery(textArr, keyword);\n    return this.MergeArray(noteResults, textResults);\n  }\n  static KeyNoteSearch(event: any, notes: NoteModel[]) {\n    if (event && event.keyCode === 13) {\n      let noteArr: string[] = [];\n      let textArr: string[] = [];\n      notes.forEach((item: NoteModel) => {\n        noteArr.push(item.notes.toLowerCase());\n        textArr.push(item.text.toLowerCase());\n      });\n      let noteResults = this.fuzzyQuery(\n        noteArr,\n        event.target.value.toLowerCase()\n      );\n      let textResults = this.fuzzyQuery(\n        textArr,\n        event.target.value.toLowerCase()\n      );\n      return this.MergeArray(noteResults, textResults);\n    }\n  }\n}\nexport default SearchUtil;\n","//搜索框\nimport React from \"react\";\nimport \"./searchBox.css\";\nimport SearchUtil from \"../../utils/serviceUtils/searchUtil\";\nimport { SearchBoxProps } from \"./interface\";\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\n\nclass SearchBox extends React.Component<SearchBoxProps> {\n  componentDidMount() {\n    if (this.props.isNavSearch) {\n      let searchBox: any = document.querySelector(\".header-search-box\");\n      searchBox && searchBox.focus();\n    }\n  }\n  handleMouse = () => {\n    let value = (this.refs.searchBox as any).value;\n    if (this.props.isNavSearch) {\n      value && this.search(value);\n    }\n    if (this.props.mode === \"nav\") {\n      this.props.handleSearchState(true);\n    }\n    let results =\n      this.props.tabMode === \"note\"\n        ? SearchUtil.MouseNoteSearch(\n            this.props.notes.filter((item) => item.notes !== \"\")\n          )\n        : this.props.tabMode === \"digest\"\n        ? SearchUtil.MouseNoteSearch(this.props.digests)\n        : SearchUtil.MouseSearch(this.props.books);\n    if (results) {\n      this.props.handleSearchResults(results);\n      this.props.handleSearch(true);\n    }\n  };\n  handleKey = (event: any) => {\n    if (event.keyCode !== 13) {\n      return;\n    }\n    let value = (this.refs.searchBox as any).value.toLowerCase();\n    if (this.props.isNavSearch || this.props.isReading) {\n      value && this.search(value);\n    }\n    let results =\n      this.props.tabMode === \"note\"\n        ? SearchUtil.KeyNoteSearch(\n            event,\n            this.props.notes.filter((item) => item.notes !== \"\")\n          )\n        : this.props.tabMode === \"digest\"\n        ? SearchUtil.KeyNoteSearch(event, this.props.digests)\n        : SearchUtil.KeySearch(event, this.props.books);\n    if (results) {\n      this.props.handleSearchResults(results);\n      this.props.handleSearch(true);\n    }\n  };\n  search = async (q: string) => {\n    let searchList = await this.props.htmlBook.rendition.doSearch(q);\n\n    this.props.handleSearchList(\n      searchList.map((item: any) => {\n        item.excerpt = item.excerpt.replace(\n          q,\n          `<span class=\"content-search-text\">${q}</span>`\n        );\n        return item;\n      })\n    );\n  };\n\n  handleCancel = () => {\n    if (this.props.isNavSearch) {\n      this.props.handleSearchList(null);\n    }\n    this.props.handleSearch(false);\n    (document.querySelector(\".header-search-box\") as HTMLInputElement).value =\n      \"\";\n  };\n\n  render() {\n    return (\n      <div style={{ position: \"relative\" }}>\n        <input\n          type=\"text\"\n          ref=\"searchBox\"\n          className=\"header-search-box\"\n          onKeyDown={(event) => {\n            this.handleKey(event);\n          }}\n          onFocus={() => {\n            this.props.mode === \"nav\" && this.props.handleSearchState(true);\n          }}\n          placeholder={\n            this.props.isNavSearch || this.props.mode === \"nav\"\n              ? this.props.t(\"Search in the book\")\n              : this.props.tabMode === \"note\"\n              ? this.props.t(\"Search my notes\")\n              : this.props.tabMode === \"digest\"\n              ? this.props.t(\"Search my highlights\")\n              : this.props.t(\"Search my library\")\n          }\n          style={\n            this.props.mode === \"nav\"\n              ? { width: this.props.width, height: this.props.height }\n              : { paddingRight: \"50px\" }\n          }\n          onCompositionStart={() => {\n            if (StorageUtil.getReaderConfig(\"isNavLocked\") === \"yes\") {\n              return;\n            } else {\n              StorageUtil.setReaderConfig(\"isTempLocked\", \"yes\");\n              StorageUtil.setReaderConfig(\"isNavLocked\", \"yes\");\n            }\n          }}\n          onCompositionEnd={() => {\n            if (StorageUtil.getReaderConfig(\"isTempLocked\") === \"yes\") {\n              StorageUtil.setReaderConfig(\"isNavLocked\", \"\");\n              StorageUtil.setReaderConfig(\"isTempLocked\", \"\");\n            }\n          }}\n        />\n        {this.props.isSearch ? (\n          <span\n            className=\"header-search-text\"\n            onClick={() => {\n              this.handleCancel();\n            }}\n            style={\n              this.props.mode === \"nav\" ? { right: \"-9px\", top: \"14px\" } : {}\n            }\n          >\n            <span className=\"icon-close\"></span>\n          </span>\n        ) : (\n          <span\n            className=\"icon-search header-search-icon\"\n            onClick={() => {\n              this.handleMouse();\n            }}\n            style={this.props.mode === \"nav\" ? { right: \"5px\" } : {}}\n          ></span>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default SearchBox;\n","import { connect } from \"react-redux\";\nimport { handleSearchResults, handleSearch } from \"../../store/actions\";\nimport { stateType } from \"../../store\";\nimport { withTranslation } from \"react-i18next\";\nimport SearchBox from \"./component\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    books: state.manager.books,\n    notes: state.reader.notes,\n    htmlBook: state.reader.htmlBook,\n    digests: state.reader.digests,\n    isSearch: state.manager.isSearch,\n    isReading: state.book.isReading,\n    currentBook: state.book.currentBook,\n    tabMode: state.sidebar.mode,\n    shelfIndex: state.sidebar.shelfIndex,\n  };\n};\nconst actionCreator = {\n  handleSearchResults,\n  handleSearch,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(SearchBox as any));\n","import SparkMD5 from \"spark-md5\";\n\ndeclare var window: any;\nvar pdfjsLib = window[\"pdfjs-dist/build/pdf\"];\nexport const fetchMD5 = (file: any) => {\n  return new Promise<string>(async (resolve, reject) => {\n    try {\n      let md5 = await getFileMD5(file);\n      if (file.name.indexOf(\".pdf\") > -1) {\n        let fileReader = new FileReader();\n        fileReader.readAsArrayBuffer(file);\n        fileReader.onload = (ev) => {\n          pdfjsLib\n            .getDocument({ data: (ev.target as any).result })\n            .promise.then((pdfDoc: any) => {\n              resolve(pdfDoc._pdfInfo.fingerprint + \"-\" + md5);\n            })\n            .catch((err: any) => {\n              resolve(md5);\n            });\n        };\n      } else {\n        resolve(md5);\n      }\n    } catch (error) {\n      reject(\"\");\n    }\n  });\n};\nexport const getFileMD5 = (file: any) => {\n  return new Promise<string>((resolve, reject) => {\n    try {\n      var blobSlice =\n          (File as any).prototype.slice ||\n          (File as any).prototype.mozSlice ||\n          (File as any).prototype.webkitSlice,\n        chunkSize = 2097152, // 以每片2MB大小来逐次读取\n        chunks = Math.ceil(file.size / chunkSize),\n        currentChunk = 0,\n        spark = new SparkMD5(), //创建SparkMD5的实例\n        fileReader = new FileReader();\n      fileReader.onload = async (e) => {\n        if (!e.target) {\n          reject(\"\");\n\n          throw new Error();\n        }\n        spark.appendBinary(e.target.result as any); // append array buffer\n        currentChunk += 1;\n        if (currentChunk < chunks) {\n          loadNext();\n        } else {\n          resolve(spark.end());\n        }\n      };\n\n      const loadNext = () => {\n        var start = currentChunk * chunkSize,\n          end = start + chunkSize >= file.size ? file.size : start + chunkSize;\n\n        fileReader.readAsBinaryString(blobSlice.call(file, start, end));\n      };\n\n      loadNext();\n    } catch (error) {\n      reject(\"\");\n    }\n  });\n};\n","export const fetchMD5FromPath = (filePath: string) => {\n  return new Promise<string>((resolve, reject) => {\n    var crypto = window.require(\"crypto\");\n    var fs = window.require(\"fs\");\n\n    var md5sum = crypto.createHash(\"md5\");\n    var s = fs.ReadStream(filePath);\n    s.on(\"data\", function (d) {\n      md5sum.update(d);\n    });\n\n    s.on(\"end\", () => {\n      resolve(md5sum.digest(\"hex\"));\n    });\n    s.on(\"error\", () => {\n      reject(\"\");\n    });\n  });\n};\nexport const fetchFileFromPath = (filePath: string) => {\n  return new Promise<File>((resolve, reject) => {\n    const fs = window.require(\"fs\");\n\n    fs.readFile(filePath, (err, data) => {\n      if (err) {\n        console.log(err);\n        return;\n      }\n      const file = new File(\n        [data],\n        window.navigator.platform.indexOf(\"Win\") > -1\n          ? filePath.split(\"\\\\\").reverse()[0]\n          : filePath.split(\"/\").reverse()[0],\n        {\n          lastModified: new Date().getTime(),\n        }\n      );\n      resolve(file);\n    });\n  });\n};\n","import React from \"react\";\nimport \"./importLocal.css\";\nimport BookModel from \"../../model/Book\";\nimport localforage from \"localforage\";\nimport { fetchMD5 } from \"../../utils/fileUtils/md5Util\";\nimport { Trans } from \"react-i18next\";\nimport Dropzone from \"react-dropzone\";\nimport { Tooltip } from \"react-tippy\";\nimport { ImportLocalProps, ImportLocalState } from \"./interface\";\nimport RecordRecent from \"../../utils/readUtils/recordRecent\";\nimport { isElectron } from \"react-device-detect\";\nimport { withRouter } from \"react-router-dom\";\nimport BookUtil from \"../../utils/fileUtils/bookUtil\";\nimport { fetchFileFromPath } from \"../../utils/fileUtils/fileUtil\";\nimport toast from \"react-hot-toast\";\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\nimport { handleReadingBook } from \"../../store/actions\";\ndeclare var window: any;\nlet clickFilePath = \"\";\n\nclass ImportLocal extends React.Component<ImportLocalProps, ImportLocalState> {\n  constructor(props: ImportLocalProps) {\n    super(props);\n    this.state = {\n      isOpenFile: false,\n      width: document.body.clientWidth,\n    };\n  }\n  componentDidMount() {\n    if (isElectron) {\n      const { ipcRenderer } = window.require(\"electron\");\n      if (!localStorage.getItem(\"storageLocation\")) {\n        localStorage.setItem(\n          \"storageLocation\",\n          ipcRenderer.sendSync(\"storage-location\", \"ping\")\n        );\n      }\n\n      const filePath = ipcRenderer.sendSync(\"get-file-data\");\n      if (filePath && filePath !== \".\") {\n        this.handleFilePath(filePath);\n      }\n      window.addEventListener(\n        \"focus\",\n        (event) => {\n          const _filePath = ipcRenderer.sendSync(\"get-file-data\");\n          if (_filePath && _filePath !== \".\") {\n            this.handleFilePath(_filePath);\n          }\n        },\n        false\n      );\n    }\n    window.addEventListener(\"resize\", () => {\n      this.setState({ width: document.body.clientWidth });\n    });\n\n    window.getMd5WithBrowser = this.getMd5WithBrowser;\n  }\n  handleFilePath = async (filePath: string) => {\n    clickFilePath = filePath;\n    let md5 = await fetchMD5(await fetchFileFromPath(filePath));\n    if ([...(this.props.books || []), ...this.props.deletedBooks].length > 0) {\n      let isRepeat = false;\n      let repeatBook: BookModel | null = null;\n      [...(this.props.books || []), ...this.props.deletedBooks].forEach(\n        (item) => {\n          if (item.md5 === md5) {\n            isRepeat = true;\n            repeatBook = item;\n          }\n        }\n      );\n      if (isRepeat && repeatBook) {\n        this.handleJump(repeatBook);\n        return;\n      }\n    }\n    const fileTemp = await fetchFileFromPath(filePath);\n\n    this.setState({ isOpenFile: true }, async () => {\n      await this.getMd5WithBrowser(fileTemp);\n    });\n  };\n  handleJump = (book: BookModel) => {\n    if (StorageUtil.getReaderConfig(\"isOpenInMain\") === \"yes\") {\n      this.props.history.push(BookUtil.getBookUrl(book));\n      this.props.handleReadingBook(book);\n    } else {\n      localStorage.setItem(\"tempBook\", JSON.stringify(book));\n      BookUtil.RedirectBook(book);\n      this.props.history.push(\"/manager/home\");\n    }\n  };\n  handleAddBook = (book: BookModel, buffer: ArrayBuffer) => {\n    return new Promise<void>((resolve, reject) => {\n      if (this.state.isOpenFile) {\n        StorageUtil.getReaderConfig(\"isImportPath\") !== \"yes\" &&\n          StorageUtil.getReaderConfig(\"isPreventAdd\") !== \"yes\" &&\n          BookUtil.addBook(book.key, buffer);\n        if (StorageUtil.getReaderConfig(\"isPreventAdd\") === \"yes\") {\n          this.handleJump(book);\n\n          this.setState({ isOpenFile: false });\n\n          return resolve();\n        }\n      } else {\n        StorageUtil.getReaderConfig(\"isImportPath\") !== \"yes\" &&\n          BookUtil.addBook(book.key, buffer);\n      }\n\n      let bookArr = [...(this.props.books || []), ...this.props.deletedBooks];\n      if (bookArr == null) {\n        bookArr = [];\n      }\n      bookArr.push(book);\n      this.props.handleReadingBook(book);\n      RecordRecent.setRecent(book.key);\n      localforage\n        .setItem(\"books\", bookArr)\n        .then(() => {\n          this.props.handleFetchBooks();\n\n          toast.success(this.props.t(\"Add Successfully\"));\n          setTimeout(() => {\n            this.state.isOpenFile && this.handleJump(book);\n            if (\n              StorageUtil.getReaderConfig(\"isOpenInMain\") === \"yes\" &&\n              this.state.isOpenFile\n            ) {\n              this.setState({ isOpenFile: false });\n              return;\n            }\n            this.setState({ isOpenFile: false });\n            this.props.history.push(\"/manager/home\");\n          }, 100);\n          return resolve();\n        })\n        .catch(() => {\n          toast.error(this.props.t(\"Import Failed\"));\n          return resolve();\n        });\n    });\n  };\n\n  //获取书籍md5\n  getMd5WithBrowser = async (file: any) => {\n    return new Promise<void>(async (resolve, reject) => {\n      const md5 = await fetchMD5(file);\n      if (!md5) {\n        toast.error(this.props.t(\"Import Failed\"));\n        return resolve();\n      } else {\n        await this.handleBook(file, md5);\n        return resolve();\n      }\n    });\n  };\n\n  handleBook = (file: any, md5: string) => {\n    let extension = (file.name as string)\n      .split(\".\")\n      .reverse()[0]\n      .toLocaleLowerCase();\n    let bookName = file.name.substr(0, file.name.length - extension.length - 1);\n    let result: BookModel | string;\n    return new Promise<void>((resolve, reject) => {\n      //md5重复不导入\n      let isRepeat = false;\n      let duplicated_key;\n      if (\n        [...(this.props.books || []), ...this.props.deletedBooks].length > 0\n      ) {\n        [...(this.props.books || []), ...this.props.deletedBooks].forEach(\n          (item) => {\n            if (item.md5 === md5 && item.size === file.size) {\n              duplicated_key = item.key;\n              isRepeat = true;\n              // toast.error(this.props.t(\"Duplicate Book\"));\n              return resolve();\n            }\n          }\n        );\n      }\n      //解析图书，获取图书数据\n      if (true) {\n        let reader = new FileReader();\n        reader.readAsArrayBuffer(file);\n\n        reader.onload = async (e) => {\n          if (!e.target) {\n            toast.error(this.props.t(\"Import Failed\"));\n            return resolve();\n          }\n          let reader = new FileReader();\n          reader.onload = async (event) => {\n            const file_content = (event.target as any).result;\n            result = await BookUtil.generateBook(\n              bookName,\n              extension,\n              md5,\n              file.size,\n              file.path || clickFilePath,\n              file_content\n            );\n            clickFilePath = \"\";\n            if (result === \"parse_kindle_error\") {\n              toast.error(\n                this.props.t(\n                  \"You may see this error when the book you're importing is not supported by Koodo Reader, try converting it with Calibre\"\n                )\n              );\n              return resolve();\n            } else if (result === \"get_metadata_error\") {\n              toast.error(this.props.t(\"Import Failed\"));\n              return resolve();\n            }\n            if(!isRepeat){\n              await this.handleAddBook(\n                result as BookModel,\n                file_content as ArrayBuffer\n              );\n            } else {\n              let book = result as BookModel;\n              book.key = duplicated_key;\n              this.props.history.push(BookUtil.getBookUrl(book));\n            }\n\n            return resolve();\n          };\n          reader.readAsArrayBuffer(file);\n        };\n      }\n    });\n  };\n\n  render() {\n    return (\n      <Dropzone\n        onDrop={async (acceptedFiles) => {\n          this.props.handleDrag(false);\n          for (let item of acceptedFiles) {\n            await this.getMd5WithBrowser(item);\n          }\n        }}\n        accept={[\n          \".epub\",\n          \".pdf\",\n          \".txt\",\n          \".mobi\",\n          \".azw3\",\n          \".djvu\",\n          \".htm\",\n          \".html\",\n          \".xml\",\n          \".xhtml\",\n          \".docx\",\n          \".rtf\",\n          \".md\",\n          \".fb2\",\n          \".cbz\",\n          \".cbt\",\n          \".cbr\",\n        ]}\n        multiple={true}\n      >\n        {({ getRootProps, getInputProps }) => (\n          <div\n            className=\"import-from-local\"\n            {...getRootProps()}\n            style={\n              this.props.isCollapsed && document.body.clientWidth < 950\n                ? { width: \"42px\" }\n                : {}\n            }\n          >\n            <div className=\"animation-mask-local\"></div>\n            {this.props.isCollapsed && this.state.width < 950 ? (\n              <Tooltip\n                title={this.props.t(\"Import\")}\n                position=\"top\"\n                style={{ height: \"20px\" }}\n                trigger=\"mouseenter\"\n              >\n                <span\n                  className=\"icon-folder\"\n                  style={{ fontSize: \"15px\", fontWeight: 500 }}\n                ></span>\n              </Tooltip>\n            ) : (\n              <span>\n                <Trans>Import</Trans>\n              </span>\n            )}\n\n            <input\n              onClick={async () => {\n                await on_import_click();\n              }}\n              id=\"import-book-box\"\n              className=\"import-book-box\"\n            />\n          </div>\n        )}\n      </Dropzone>\n    );\n  }\n}\n\nexport default withRouter(ImportLocal);\n","import \"./importLocal.css\";\nimport { connect } from \"react-redux\";\nimport { handleFetchBooks, handleLoadingDialog } from \"../../store/actions\";\nimport { handleReadingBook } from \"../../store/actions\";\nimport { stateType } from \"../../store\";\nimport { withTranslation } from \"react-i18next\";\nimport ImportLocal from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    books: state.manager.books,\n    notes: state.reader.notes,\n    bookmarks: state.reader.bookmarks,\n    isCollapsed: state.sidebar.isCollapsed,\n    deletedBooks: state.manager.deletedBooks,\n  };\n};\nconst actionCreator = {\n  handleFetchBooks,\n  handleReadingBook,\n  handleLoadingDialog,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(ImportLocal as any));\n","import React from \"react\";\nimport \"./updateInfo.css\";\nimport { UpdateInfoProps, UpdateInfoState } from \"./interface\";\nimport { version } from \"../../../../package.json\";\nimport { Trans } from \"react-i18next\";\nimport axios from \"axios\";\nimport Lottie from \"react-lottie\";\nimport animationNew from \"../../../assets/lotties/new.json\";\nimport animationSuccess from \"../../../assets/lotties/success.json\";\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\nimport { openExternalUrl } from \"../../../utils/serviceUtils/urlUtil\";\nconst newOptions = {\n  loop: false,\n  autoplay: true,\n  animationData: animationNew,\n  rendererSettings: {\n    preserveAspectRatio: \"xMidYMid slice\",\n  },\n};\nconst successOptions = {\n  loop: false,\n  autoplay: true,\n  animationData: animationSuccess,\n  rendererSettings: {\n    preserveAspectRatio: \"xMidYMid slice\",\n  },\n};\n\nclass UpdateInfo extends React.Component<UpdateInfoProps, UpdateInfoState> {\n  constructor(props: UpdateInfoProps) {\n    super(props);\n    this.state = {\n      updateLog: \"\",\n      isUpdated: false,\n    };\n  }\n  componentDidMount() {\n    !this.props.currentBook.key &&\n      axios\n        .get(`https://koodo.960960.xyz/api/update?name=${navigator.language}`)\n        .then((res) => {\n          const newVersion = res.data.log.version;\n          console.log(\n            res,\n            version,\n            newVersion,\n            version.localeCompare(newVersion)\n          );\n\n          setTimeout(() => {\n            if (version.localeCompare(newVersion) < 0) {\n              if (StorageUtil.getReaderConfig(\"isDisableUpdate\") !== \"yes\") {\n                this.setState({ updateLog: res.data.log });\n                this.props.handleNewDialog(true);\n              } else {\n                this.props.handleNewWarning(true);\n              }\n            } else if (\n              StorageUtil.getReaderConfig(\"version\") !== newVersion &&\n              StorageUtil.getReaderConfig(\"isFirst\")\n            ) {\n              this.setState({ isUpdated: true });\n              this.props.handleNewDialog(true);\n              StorageUtil.setReaderConfig(\"version\", newVersion);\n            }\n            StorageUtil.setReaderConfig(\n              \"appInfo\",\n              version.localeCompare(newVersion) < 0\n                ? \"new\"\n                : version.localeCompare(newVersion) === 0\n                ? \"stable\"\n                : \"dev\"\n            );\n          }, 500);\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n  }\n  renderList = (arr: any[]) => {\n    return arr.map((item, index) => {\n      return (\n        <li className=\"update-dialog-list\" key={index}>\n          <span>{index + 1 + \". \"}</span>\n          <span>{item}</span>\n        </li>\n      );\n    });\n  };\n\n  handleClose = () => {\n    this.setState({ updateLog: \"\", isUpdated: false });\n    this.props.handleNewDialog(false);\n  };\n\n  render() {\n    return (\n      <>\n        {(this.state.updateLog || this.state.isUpdated) &&\n          this.props.isShowNew && (\n            <div\n              className=\"new-version\"\n              style={\n                this.state.isUpdated\n                  ? { height: \"240px\", top: \"calc(50vh - 120px)\" }\n                  : {}\n              }\n            >\n              <div className=\"new-version-title\">\n                {this.state.isUpdated ? (\n                  <Trans>Update Complete</Trans>\n                ) : (\n                  <>\n                    <Trans>Update to</Trans>\n                    {\" \" + this.state.updateLog.version}\n                  </>\n                )}\n              </div>\n              <div\n                className=\"setting-close-container\"\n                onClick={() => {\n                  this.handleClose();\n                }}\n              >\n                <span className=\"icon-close setting-close\"></span>\n              </div>\n              {this.state.isUpdated && (\n                <div className=\"update-info-text\">\n                  <Trans>You successfully update to</Trans>\n                  {\" \" + version}\n                </div>\n              )}\n              <div className=\"update-dialog-info\" style={{ height: 420 }}>\n                <div className=\"new-version-animation\">\n                  {this.state.isUpdated ? (\n                    <Lottie\n                      options={successOptions}\n                      height={80}\n                      width={80}\n                      style={{ marginTop: \"10px\", marginBottom: \"10px\" }}\n                    />\n                  ) : (\n                    <Lottie options={newOptions} height={220} width={220} />\n                  )}\n                </div>\n                <div\n                  className=\"new-version-open\"\n                  onClick={() => {\n                    openExternalUrl(\n                      this.state.isUpdated\n                        ? \"https://koodo.960960.xyz/en/log\"\n                        : \"https://koodo.960960.xyz/en\"\n                    );\n                  }}\n                  style={this.state.isUpdated ? { marginTop: \"10px\" } : {}}\n                >\n                  {this.state.isUpdated ? (\n                    <>\n                      <Trans>Changelog</Trans>\n                    </>\n                  ) : (\n                    <Trans>Download</Trans>\n                  )}\n                </div>\n                {this.state.updateLog && (\n                  <>\n                    <p className=\"update-dialog-new-title\">\n                      <Trans>What's New</Trans>\n                    </p>\n                    <ul className=\"update-dialog-new-container\">\n                      {this.renderList(this.state.updateLog.new)}\n                    </ul>\n                    <p className=\"update-dialog-fix-title\">\n                      <Trans>What's been fixed</Trans>\n                    </p>\n                    <ul className=\"update-dialog-fix-container\">\n                      {this.renderList(this.state.updateLog.fix)}\n                    </ul>\n                  </>\n                )}\n              </div>\n            </div>\n          )}\n      </>\n    );\n  }\n}\n\nexport default UpdateInfo;\n","import { connect } from \"react-redux\";\nimport { handleNewDialog, handleNewWarning } from \"../../../store/actions\";\nimport UpdateInfo from \"./component\";\nimport { withTranslation } from \"react-i18next\";\nimport { stateType } from \"../../../store\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentBook: state.book.currentBook,\n    books: state.manager.books,\n    isShowNew: state.manager.isShowNew,\n  };\n};\nconst actionCreator = {\n  handleNewDialog,\n  handleNewWarning,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(UpdateInfo as any));\n","import BookModel from \"../../model/Book\";\nimport NoteModel from \"../../model/Note\";\nimport BookmarkModel from \"../../model/Bookmark\";\nimport { zipBook, zipConfig } from \"./common\";\n\nlet JSZip = (window as any).JSZip;\n\nexport const backup = (\n  bookArr: BookModel[],\n  notes: NoteModel[],\n  bookmarks: BookmarkModel[],\n  isSync: boolean\n) => {\n  return new Promise<Blob | boolean>(async (resolve, reject) => {\n    let zip = new JSZip();\n    let books = bookArr;\n    //0表示备份到本地，1表示备份到dropbox,2表示备份到onedrive,3表示备份到webdav，4表示把indexeddb中的数据转移到uploads文件夹中，5表示同步数据到本地\n    let result = await zipConfig(zip, books, notes, bookmarks);\n    if (!result) resolve(false);\n    if (!isSync) {\n      await zipBook(zip, books);\n    }\n    zip\n      .generateAsync({ type: \"blob\" })\n      .then((blob: any) => {\n        resolve(blob);\n      })\n      .catch((err: any) => {\n        console.log(err);\n        resolve(false);\n      });\n  });\n};\n","import React from \"react\";\nimport \"./header.css\";\nimport SearchBox from \"../../components/searchBox\";\nimport ImportLocal from \"../../components/importLocal\";\nimport { Trans } from \"react-i18next\";\nimport { HeaderProps, HeaderState } from \"./interface\";\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\nimport UpdateInfo from \"../../components/dialogs/updateDialog\";\nimport { restore } from \"../../utils/syncUtils/restoreUtil\";\nimport { backup } from \"../../utils/syncUtils/backupUtil\";\nimport { Tooltip } from \"react-tippy\";\nimport { isElectron } from \"react-device-detect\";\nimport { syncData } from \"../../utils/syncUtils/common\";\nimport toast from \"react-hot-toast\";\nclass Header extends React.Component<HeaderProps, HeaderState> {\n  constructor(props: HeaderProps) {\n    super(props);\n\n    this.state = {\n      isOnlyLocal: false,\n      language: StorageUtil.getReaderConfig(\"lang\"),\n      isNewVersion: false,\n      width: document.body.clientWidth,\n      isdataChange: false,\n    };\n  }\n  componentDidMount() {\n    if (isElectron) {\n      const fs = window.require(\"fs\");\n      const path = window.require(\"path\");\n      const { ipcRenderer } = window.require(\"electron\");\n      const dirPath = ipcRenderer.sendSync(\"user-data\", \"ping\");\n      if (!fs.existsSync(dirPath)) {\n        fs.mkdirSync(dirPath);\n        fs.mkdirSync(path.join(dirPath, \"data\"));\n        fs.mkdirSync(path.join(dirPath, \"data\", \"book\"));\n        console.log(\"文件夹创建成功\");\n      } else {\n        console.log(\"文件夹已存在\");\n      }\n\n      if (\n        StorageUtil.getReaderConfig(\"storageLocation\") &&\n        !localStorage.getItem(\"storageLocation\")\n      ) {\n        localStorage.setItem(\n          \"storageLocation\",\n          StorageUtil.getReaderConfig(\"storageLocation\")\n        );\n      }\n\n      //Check for data update\n      let storageLocation = localStorage.getItem(\"storageLocation\")\n        ? localStorage.getItem(\"storageLocation\")\n        : window\n            .require(\"electron\")\n            .ipcRenderer.sendSync(\"storage-location\", \"ping\");\n      let sourcePath = path.join(\n        storageLocation,\n        \"config\",\n        \"readerConfig.json\"\n      );\n      //Detect data modification\n      fs.readFile(sourcePath, \"utf8\", (err, data) => {\n        if (err) {\n          console.log(err);\n          return;\n        }\n        const readerConfig = JSON.parse(data);\n        if (\n          localStorage.getItem(\"lastSyncTime\") &&\n          parseInt(readerConfig.lastSyncTime) >\n            parseInt(localStorage.getItem(\"lastSyncTime\")!)\n        ) {\n          this.setState({ isdataChange: true });\n        }\n      });\n    }\n\n    window.addEventListener(\"resize\", () => {\n      this.setState({ width: document.body.clientWidth });\n    });\n    window.addEventListener(\"focus\", () => {\n      this.props.handleFetchBooks();\n      this.props.handleFetchNotes();\n      this.props.handleFetchBookmarks();\n    });\n  }\n\n  syncFromLocation = async () => {\n    const fs = window.require(\"fs\");\n    const path = window.require(\"path\");\n    const { zip } = window.require(\"zip-a-folder\");\n    let storageLocation = localStorage.getItem(\"storageLocation\")\n      ? localStorage.getItem(\"storageLocation\")\n      : window\n          .require(\"electron\")\n          .ipcRenderer.sendSync(\"storage-location\", \"ping\");\n    let sourcePath = path.join(storageLocation, \"config\");\n    let outPath = path.join(storageLocation, \"config.zip\");\n    await zip(sourcePath, outPath);\n\n    var data = fs.readFileSync(outPath);\n\n    let blobTemp = new Blob([data], { type: \"application/epub+zip\" });\n    let fileTemp = new File([blobTemp], \"config.zip\", {\n      lastModified: new Date().getTime(),\n      type: blobTemp.type,\n    });\n    let result = await restore(fileTemp, true);\n    if (result) {\n      this.setState({ isdataChange: false });\n      //Check for data update\n      let storageLocation = localStorage.getItem(\"storageLocation\")\n        ? localStorage.getItem(\"storageLocation\")\n        : window\n            .require(\"electron\")\n            .ipcRenderer.sendSync(\"storage-location\", \"ping\");\n      let sourcePath = path.join(\n        storageLocation,\n        \"config\",\n        \"readerConfig.json\"\n      );\n\n      fs.readFile(sourcePath, \"utf8\", (err, data) => {\n        if (err) {\n          console.log(err);\n          return;\n        }\n        const readerConfig = JSON.parse(data);\n        if (localStorage.getItem(\"lastSyncTime\") && readerConfig.lastSyncTime) {\n          localStorage.setItem(\"lastSyncTime\", readerConfig.lastSyncTime);\n        }\n      });\n    }\n    if (!result) {\n      toast.error(this.props.t(\"Sync Failed\"));\n    } else {\n      toast.success(this.props.t(\"Sync Successfully\"));\n    }\n  };\n  handleSync = () => {\n    if (StorageUtil.getReaderConfig(\"isFirst\") !== \"no\") {\n      this.props.handleTipDialog(true);\n      this.props.handleTip(\n        \"Sync function works with third-party cloud drive. You need to manually change the storage location to the same sync folder on different computers. When you click the sync button, Koodo Reader will automatically upload or download the data from this folder according the timestamp.\"\n      );\n      StorageUtil.setReaderConfig(\"isFirst\", \"no\");\n      return;\n    }\n    const fs = window.require(\"fs\");\n    const path = window.require(\"path\");\n    let storageLocation = localStorage.getItem(\"storageLocation\")\n      ? localStorage.getItem(\"storageLocation\")\n      : window\n          .require(\"electron\")\n          .ipcRenderer.sendSync(\"storage-location\", \"ping\");\n    let sourcePath = path.join(storageLocation, \"config\", \"readerConfig.json\");\n    fs.readFile(sourcePath, \"utf8\", async (err, data) => {\n      if (err || !data) {\n        this.syncToLocation();\n        return;\n      }\n      const readerConfig = JSON.parse(data);\n\n      if (\n        readerConfig &&\n        localStorage.getItem(\"lastSyncTime\") &&\n        parseInt(readerConfig.lastSyncTime) >\n          parseInt(localStorage.getItem(\"lastSyncTime\")!)\n      ) {\n        this.syncFromLocation();\n      } else {\n        //否则就把Koodo中数据同步到同步文件夹\n        this.syncToLocation();\n      }\n    });\n  };\n  syncToLocation = async () => {\n    let timestamp = new Date().getTime().toString();\n    StorageUtil.setReaderConfig(\"lastSyncTime\", timestamp);\n    localStorage.setItem(\"lastSyncTime\", timestamp);\n    let result = await backup(\n      this.props.books,\n      this.props.notes,\n      this.props.bookmarks,\n      true\n    );\n    if (!result) {\n      toast.error(this.props.t(\"Sync Failed\"));\n    } else {\n      syncData(result as Blob, this.props.books, true);\n      toast.success(this.props.t(\"Sync Successfully\"));\n    }\n  };\n\n  render() {\n    return (\n      <div className=\"header\">\n        <div className=\"header-search-container\">\n          <SearchBox />\n        </div>\n\n        <>\n          <div\n            className=\"setting-icon-container\"\n            onClick={() => {\n              this.props.handleSortDisplay(!this.props.isSortDisplay);\n            }}\n            onMouseLeave={() => {\n              this.props.handleSortDisplay(false);\n            }}\n            style={{ left: \"490px\", top: \"18px\" }}\n          >\n            <Tooltip\n              title={this.props.t(\"Sort by\")}\n              position=\"top\"\n              trigger=\"mouseenter\"\n              distance={20}\n            >\n              <span className=\"icon-sort-desc header-sort-icon\"></span>\n            </Tooltip>\n          </div>\n          <div\n            className=\"setting-icon-container\"\n            onClick={() => {\n              this.props.handleAbout(!this.props.isAboutOpen);\n            }}\n            onMouseLeave={() => {\n              this.props.handleAbout(false);\n            }}\n          >\n            <Tooltip\n              title={this.props.t(\"Setting\")}\n              position=\"top\"\n              trigger=\"mouseenter\"\n            >\n              <span\n                className=\"icon-setting setting-icon\"\n                style={\n                  this.props.isNewWarning ? { color: \"rgb(35, 170, 242)\" } : {}\n                }\n              ></span>\n            </Tooltip>\n          </div>\n          {isElectron && (\n            <div\n              className=\"setting-icon-container\"\n              onClick={() => {\n                // this.syncFromLocation();\n                this.handleSync();\n              }}\n              style={{ left: \"635px\" }}\n            >\n              <Tooltip\n                title={this.props.t(\n                  this.state.isdataChange\n                    ? \"Data change detected, whether to update?\"\n                    : \"Sync\"\n                )}\n                position=\"top\"\n                trigger=\"mouseenter\"\n              >\n                <span\n                  className=\"icon-sync setting-icon\"\n                  style={\n                    this.state.isdataChange\n                      ? { color: \"rgb(35, 170, 242)\" }\n                      : {}\n                  }\n                ></span>\n              </Tooltip>\n            </div>\n          )}\n        </>\n\n        <div\n          className=\"import-from-cloud\"\n          onClick={() => {\n            this.props.handleBackupDialog(true);\n          }}\n          style={\n            this.props.isCollapsed && document.body.clientWidth < 950\n              ? { width: \"42px\" }\n              : {}\n          }\n        >\n          <div className=\"animation-mask\"></div>\n          {this.props.isCollapsed && this.state.width < 950 ? (\n            <Tooltip\n              title={this.props.t(\"Backup\")}\n              position=\"top\"\n              trigger=\"mouseenter\"\n            >\n              <span\n                className=\"icon-share\"\n                style={{ fontSize: \"15px\", fontWeight: 600 }}\n              ></span>\n            </Tooltip>\n          ) : (\n            <Trans>Backup</Trans>\n          )}\n        </div>\n        <ImportLocal\n          {...{\n            handleDrag: this.props.handleDrag,\n          }}\n        />\n        {isElectron && <UpdateInfo />}\n      </div>\n    );\n  }\n}\n\nexport default Header;\n","import { connect } from \"react-redux\";\nimport { withTranslation } from \"react-i18next\";\nimport {\n  handleSortDisplay,\n  handleSetting,\n  handleAbout,\n  handleTipDialog,\n  handleTip,\n  handleBackupDialog,\n  handleFetchBooks,\n  handleFetchNotes,\n  handleFetchBookmarks,\n} from \"../../store/actions\";\nimport { stateType } from \"../../store\";\nimport Header from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    isSearch: state.manager.isSearch,\n    isAboutOpen: state.manager.isAboutOpen,\n    bookmarks: state.reader.bookmarks,\n    books: state.manager.books,\n    isNewWarning: state.manager.isNewWarning,\n    notes: state.reader.notes,\n    isCollapsed: state.sidebar.isCollapsed,\n\n    isSortDisplay: state.manager.isSortDisplay,\n  };\n};\nconst actionCreator = {\n  handleSortDisplay,\n  handleBackupDialog,\n  handleSetting,\n  handleAbout,\n  handleTipDialog,\n  handleTip,\n  handleFetchBooks,\n  handleFetchNotes,\n  handleFetchBookmarks,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(Header as any));\n","import BookModel from \"../../model/Book\";\nimport NoteModel from \"../../model/Note\";\nimport BookmarkModel from \"../../model/Bookmark\";\nclass DeleteUtil {\n  static deleteBook(books: BookModel[], bookKey: string) {\n    books = books.filter((item) => item.key !== bookKey);\n    return books;\n  }\n  static deleteBookmarks(bookmarks: BookmarkModel[], bookKey: string) {\n    bookmarks = bookmarks.filter((item) => item.bookKey !== bookKey);\n    return bookmarks;\n  }\n  static deleteNotes(notes: NoteModel[], bookKey: string) {\n    notes = notes.filter((item) => item.bookKey !== bookKey);\n    return notes;\n  }\n}\n\nexport default DeleteUtil;\n","const defaultShelf = {\n  New: null,\n  Study: [],\n  Work: [],\n  Entertainment: [],\n};\nclass ShelfUtil {\n  static setShelf(shelfTitle: string, bookKey: string) {\n    let json = localStorage.getItem(\"shelfList\");\n    let obj = JSON.parse(json!) || defaultShelf;\n    if (obj[shelfTitle] === undefined) {\n      obj[shelfTitle] = [];\n    }\n    if (obj[shelfTitle].indexOf(bookKey) === -1) {\n      obj[shelfTitle].unshift(bookKey);\n    }\n    localStorage.setItem(\"shelfList\", JSON.stringify(obj));\n  }\n\n  static getShelf() {\n    let json = localStorage.getItem(\"shelfList\");\n    let obj = JSON.parse(json!) || defaultShelf;\n    return obj;\n  }\n  static clearShelf(shelfIndex: number, bookKey: string) {\n    let json = localStorage.getItem(\"shelfList\");\n    let obj = JSON.parse(json!) || defaultShelf;\n    let shelfTitle = Object.keys(obj);\n    let currentShelfTitle = shelfTitle[shelfIndex];\n    let index = obj[currentShelfTitle].indexOf(bookKey);\n    obj[currentShelfTitle].splice(index, 1);\n    localStorage.setItem(\"shelfList\", JSON.stringify(obj));\n  }\n  static deletefromAllShelf(bookKey: string) {\n    let json = localStorage.getItem(\"shelfList\");\n    let obj = JSON.parse(json!) || defaultShelf;\n    let shelfTitle = Object.keys(obj);\n    shelfTitle.splice(0, 1);\n    shelfTitle.forEach((item) => {\n      let index = obj[item].indexOf(bookKey);\n      if (index > -1) {\n        obj[item].splice(index, 1);\n      }\n    });\n    localStorage.setItem(\"shelfList\", JSON.stringify(obj));\n  }\n  static removeShelf(shelfTitle: string) {\n    let json = localStorage.getItem(\"shelfList\");\n    let obj = JSON.parse(json!) || defaultShelf;\n    delete obj[shelfTitle];\n    localStorage.setItem(\"shelfList\", JSON.stringify(obj));\n  }\n  static getBookPosition(bookKey: string) {\n    let json = localStorage.getItem(\"shelfList\");\n    let obj = JSON.parse(json!) || defaultShelf;\n    let shelfList: string[] = [];\n    for (let item in obj) {\n      if (obj[item] && obj[item].indexOf(bookKey) > -1) {\n        shelfList.push(item);\n      }\n    }\n    return shelfList;\n  }\n}\n\nexport default ShelfUtil;\n","import BookModel from \"../../model/Book\";\nclass AddFavorite {\n  static setFavorite(bookKey: string) {\n    let bookArr =\n      localStorage.getItem(\"favoriteBooks\") !== \"{}\" &&\n      localStorage.getItem(\"favoriteBooks\")\n        ? JSON.parse(localStorage.getItem(\"favoriteBooks\") || \"\")\n        : [];\n    const index = bookArr.indexOf(bookKey);\n    if (index > -1) {\n      bookArr.splice(index, 1);\n      bookArr.unshift(bookKey);\n    } else {\n      bookArr.unshift(bookKey);\n    }\n\n    localStorage.setItem(\"favoriteBooks\", JSON.stringify(bookArr));\n  }\n  static setAllFavorite(books: BookModel[]) {\n    let bookArr: string[] = [];\n    books.forEach((item) => {\n      bookArr.push(item.key);\n    });\n    localStorage.setItem(\"favoriteBooks\", JSON.stringify(bookArr));\n  }\n  static clear(bookKey: string) {\n    let bookArr =\n      localStorage.getItem(\"favoriteBooks\") !== \"{}\" &&\n      localStorage.getItem(\"favoriteBooks\")\n        ? JSON.parse(localStorage.getItem(\"favoriteBooks\") || \"\")\n        : [];\n    const index = bookArr.indexOf(bookKey);\n    if (index > -1) {\n      bookArr.splice(index, 1);\n    }\n    localStorage.setItem(\"favoriteBooks\", JSON.stringify(bookArr));\n  }\n  static getAllFavorite() {\n    let bookArr =\n      localStorage.getItem(\"favoriteBooks\") !== \"{}\" &&\n      localStorage.getItem(\"favoriteBooks\")\n        ? JSON.parse(localStorage.getItem(\"favoriteBooks\") || \"\")\n        : [];\n    return bookArr || [];\n  }\n}\n\nexport default AddFavorite;\n","import React from \"react\";\nimport \"./deleteDialog.css\";\nimport DeleteUtil from \"../../../utils/readUtils/deleteUtil\";\nimport localforage from \"localforage\";\nimport ShelfUtil from \"../../../utils/readUtils/shelfUtil\";\nimport RecordRecent from \"../../../utils/readUtils/recordRecent\";\nimport RecordLocation from \"../../../utils/readUtils/recordLocation\";\nimport AddFavorite from \"../../../utils/readUtils/addFavorite\";\nimport { Trans } from \"react-i18next\";\nimport { DeleteDialogProps } from \"./interface\";\nimport { withRouter } from \"react-router-dom\";\nimport AddTrash from \"../../../utils/readUtils/addTrash\";\nimport BookUtil from \"../../../utils/fileUtils/bookUtil\";\nimport toast from \"react-hot-toast\";\nclass DeleteDialog extends React.Component<DeleteDialogProps> {\n  handleCancel = () => {\n    this.props.handleDeleteDialog(false);\n  };\n  handleDeleteOther = (key: string) => {\n    return new Promise<void>(async (resolve, reject) => {\n      if (this.props.bookmarks) {\n        let bookmarkArr = DeleteUtil.deleteBookmarks(this.props.bookmarks, key);\n        if (bookmarkArr.length === 0) {\n          await localforage.removeItem(\"bookmarks\");\n        } else {\n          await localforage.setItem(\"bookmarks\", bookmarkArr);\n        }\n        this.props.handleFetchBookmarks();\n      }\n      if (this.props.notes) {\n        let noteArr = DeleteUtil.deleteNotes(this.props.notes, key);\n        if (noteArr.length === 0) {\n          await localforage.removeItem(\"notes\");\n          resolve();\n        } else {\n          await localforage.setItem(\"notes\", noteArr);\n          resolve();\n        }\n        this.props.handleFetchNotes();\n      }\n    });\n  };\n  handleComfirm = async () => {\n    //从列表删除和从图书库删除判断\n    if (this.props.mode === \"shelf\") {\n      if (this.props.isSelectBook) {\n        this.props.selectedBooks.forEach((item) => {\n          ShelfUtil.clearShelf(this.props.shelfIndex, item);\n        });\n        this.props.handleSelectedBooks([]);\n        this.props.handleFetchBooks(false);\n        this.props.handleSelectBook(!this.props.isSelectBook);\n        this.props.handleDeleteDialog(false);\n        toast.success(this.props.t(\"Delete Successfully\"));\n        return;\n      }\n      ShelfUtil.clearShelf(this.props.shelfIndex, this.props.currentBook.key);\n    } else if (this.props.mode === \"trash\") {\n      let keyArr = AddTrash.getAllTrash();\n      for (let i = 0; i < keyArr.length; i++) {\n        await this.deleteBook(keyArr[i]);\n      }\n\n      if (this.props.books.length === 1) {\n        this.props.history.push(\"/manager/empty\");\n      }\n      this.props.handleFetchBooks(false);\n      this.props.handleFetchBooks(true);\n      this.props.handleFetchBookmarks();\n      this.props.handleFetchNotes();\n    } else if (this.props.isSelectBook) {\n      this.props.selectedBooks.forEach((item) => {\n        AddTrash.setTrash(item);\n        //从喜爱的图书中删除\n        AddFavorite.clear(item);\n      });\n      this.props.handleSelectedBooks([]);\n      this.props.handleFetchBooks(false);\n      this.props.handleSelectBook(!this.props.isSelectBook);\n    } else {\n      AddTrash.setTrash(this.props.currentBook.key);\n      //从喜爱的图书中删除\n      AddFavorite.clear(this.props.currentBook.key);\n      this.props.handleFetchBooks(false);\n    }\n\n    this.props.handleDeleteDialog(false);\n    toast.success(this.props.t(\"Delete Successfully\"));\n  };\n  deleteBook = (key: string) => {\n    return new Promise<void>((resolve, reject) => {\n      this.props.books &&\n        localforage\n          .setItem(\"books\", DeleteUtil.deleteBook(this.props.books, key))\n          .then(async () => {\n            await BookUtil.deleteBook(key);\n            //从喜爱的图书中删除\n            AddFavorite.clear(key);\n            //从回收的图书中删除\n            AddTrash.clear(key);\n            //从书架删除\n            ShelfUtil.deletefromAllShelf(key);\n            //从阅读记录删除\n            RecordRecent.clear(key);\n            //删除阅读历史\n            RecordLocation.clear(key);\n            //删除书签，笔记，书摘，高亮\n            await this.handleDeleteOther(key);\n            resolve();\n          })\n          .catch(() => {\n            reject();\n          });\n    });\n  };\n  render() {\n    return (\n      <div className=\"delete-dialog-container\">\n        {this.props.mode === \"shelf\" ? (\n          <div className=\"delete-dialog-title\">\n            <Trans>Delete from Shelf</Trans>\n          </div>\n        ) : this.props.mode === \"trash\" ? (\n          <div className=\"delete-dialog-title\">\n            <Trans>Delete All Books</Trans>\n          </div>\n        ) : (\n          <div className=\"delete-dialog-title\">\n            <Trans>Delete This Book</Trans>\n          </div>\n        )}\n        {this.props.mode === \"trash\" ? null : (\n          <div className=\"delete-dialog-book\">\n            <div className=\"delete-dialog-book-title\">\n              {this.props.isSelectBook ? (\n                <Trans\n                  i18nKey=\"Total books\"\n                  count={this.props.selectedBooks.length}\n                >\n                  {\"Total \" + this.props.selectedBooks.length + \" books\"}\n                </Trans>\n              ) : (\n                this.props.currentBook.name\n              )}\n            </div>\n          </div>\n        )}\n\n        {this.props.mode === \"shelf\" ? (\n          <div className=\"delete-dialog-other-option\">\n            <Trans>This action won't delete the original book</Trans>\n          </div>\n        ) : this.props.mode === \"trash\" ? (\n          <div className=\"delete-dialog-other-option\" style={{ top: \"80px\" }}>\n            <Trans>\n              This action will remove all the books in recycle bin,together with\n              their notes, bookmarks and digests\n            </Trans>\n          </div>\n        ) : (\n          <div className=\"delete-dialog-other-option\">\n            <Trans>\n              {\n                \"This action will move this book and its the notes, bookmarks and highlights of this book to the recycle bin\"\n              }\n            </Trans>\n          </div>\n        )}\n        <div\n          className=\"delete-dialog-cancel\"\n          onClick={() => {\n            this.handleCancel();\n          }}\n        >\n          <Trans>Cancel</Trans>\n        </div>\n        <div\n          className=\"delete-dialog-comfirm\"\n          onClick={() => {\n            this.handleComfirm();\n          }}\n        >\n          <Trans>Delete</Trans>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default withRouter(DeleteDialog as any);\n","import { connect } from \"react-redux\";\nimport {\n  handleFetchBooks,\n  handleDeleteDialog,\n  handleActionDialog,\n  handleFetchBookmarks,\n  handleFetchNotes,\n  handleSelectedBooks,\n  handleSelectBook,\n} from \"../../../store/actions\";\nimport { stateType } from \"../../../store\";\nimport DeleteDialog from \"./component\";\nimport { withTranslation } from \"react-i18next\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    books: state.manager.books,\n    selectedBooks: state.manager.selectedBooks,\n    isSelectBook: state.manager.isSelectBook,\n    isOpenDeleteDialog: state.book.isOpenDeleteDialog,\n    currentBook: state.book.currentBook,\n    bookmarks: state.reader.bookmarks,\n    notes: state.reader.notes,\n    digests: state.reader.digests,\n    mode: state.sidebar.mode,\n    shelfIndex: state.sidebar.shelfIndex,\n  };\n};\nconst actionCreator = {\n  handleFetchBooks,\n  handleDeleteDialog,\n  handleFetchBookmarks,\n  handleFetchNotes,\n  handleActionDialog,\n  handleSelectedBooks,\n  handleSelectBook,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(DeleteDialog as any) as any);\n","import React from \"react\";\nimport \"./editDialog.css\";\nimport localforage from \"localforage\";\nimport { Trans } from \"react-i18next\";\nimport { EditDialogProps, EditDialogState } from \"./interface\";\nimport toast from \"react-hot-toast\";\nclass EditDialog extends React.Component<EditDialogProps, EditDialogState> {\n  constructor(props: EditDialogProps) {\n    super(props);\n    this.state = { isCheck: false };\n  }\n  componentDidMount() {\n    const nameBox: HTMLInputElement = document.querySelector(\n      \".edit-dialog-book-name-box\"\n    ) as HTMLInputElement;\n    const authorBox: HTMLInputElement = document.querySelector(\n      \".edit-dialog-book-author-box\"\n    ) as HTMLInputElement;\n    nameBox.value = this.props.currentBook.name;\n    authorBox.value = this.props.currentBook.author;\n  }\n\n  handleCancel = () => {\n    this.props.handleEditDialog(false);\n  };\n  handleComfirm = () => {\n    const nameBox: HTMLInputElement = document.querySelector(\n      \".edit-dialog-book-name-box\"\n    ) as HTMLInputElement;\n    let name = nameBox.value;\n    const authorBox: HTMLInputElement = document.querySelector(\n      \".edit-dialog-book-author-box\"\n    ) as HTMLInputElement;\n    let author = authorBox.value;\n    let { books } = this.props;\n    books.forEach((item) => {\n      if (item.key === this.props.currentBook.key) {\n        item.name = name;\n        item.author = author;\n        return false;\n      }\n    });\n    localforage.setItem(\"books\", books).then(() => {\n      this.props.handleEditDialog(false);\n      this.props.handleFetchBooks();\n    });\n    toast.success(this.props.t(\"Edit Successfully\"));\n    this.props.handleActionDialog(false);\n  };\n  render() {\n    return (\n      <div className=\"edit-dialog-container\">\n        <div className=\"edit-dialog-title\">\n          <Trans>Edit Book</Trans>\n        </div>\n        <div className=\"edit-dialog-book-name-container\">\n          <div className=\"edit-dialog-book-name-text\">\n            <Trans>Book Name</Trans>\n          </div>\n          <input className=\"edit-dialog-book-name-box\" />\n        </div>\n        <div className=\"edit-dialog-book-author-container\">\n          <div className=\"edit-dialog-book-author-text\">\n            <Trans>Author</Trans>\n          </div>\n          <input className=\"edit-dialog-book-author-box\" />\n        </div>\n        <div\n          className=\"edit-dialog-cancel\"\n          onClick={() => {\n            this.handleCancel();\n          }}\n        >\n          <Trans>Cancel</Trans>\n        </div>\n        <div\n          className=\"edit-dialog-comfirm\"\n          onClick={() => {\n            this.handleComfirm();\n          }}\n        >\n          <Trans>Confirm</Trans>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default EditDialog;\n","import { connect } from \"react-redux\";\nimport \"./editDialog.css\";\nimport { handleFetchBooks } from \"../../../store/actions\";\nimport { handleEditDialog, handleActionDialog } from \"../../../store/actions\";\nimport { stateType } from \"../../../store\";\nimport EditDialog from \"./component\";\nimport { withTranslation } from \"react-i18next\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    books: state.manager.books,\n    isOpenDeleteDialog: state.book.isOpenDeleteDialog,\n    currentBook: state.book.currentBook,\n    bookmarks: state.reader.bookmarks,\n    notes: state.reader.notes,\n    digests: state.reader.digests,\n  };\n};\nconst actionCreator = {\n  handleFetchBooks,\n  handleEditDialog,\n  handleActionDialog,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(EditDialog as any) as any);\n","import React, { Component } from \"react\";\nimport ShelfUtil from \"../../../utils/readUtils/shelfUtil\";\nimport { Trans } from \"react-i18next\";\nimport { AddDialogProps, AddDialogState } from \"./interface\";\nimport \"./addDialog.css\";\nimport toast from \"react-hot-toast\";\n\nclass AddDialog extends Component<AddDialogProps, AddDialogState> {\n  constructor(props: AddDialogProps) {\n    super(props);\n    this.state = { isNew: true, shelfTitle: \"\" };\n  }\n\n  handleCancel = () => {\n    this.props.handleAddDialog(false);\n  };\n  handleComfirm = () => {\n    const inputElement: HTMLInputElement = document.querySelector(\n      \".add-dialog-new-shelf-box\"\n    ) as HTMLInputElement;\n    if (!isNaN(parseInt(inputElement.value))) {\n      toast(this.props.t(\"Shelf title can't be pure number\"));\n      return;\n    }\n    let shelfTitle: string = this.state.shelfTitle;\n    let shelfList = ShelfUtil.getShelf();\n    let shelfTitles = Object.keys(ShelfUtil.getShelf());\n    let shelfIndex = this.state.isNew\n      ? shelfTitles.length\n      : shelfTitles.indexOf(inputElement.value);\n    if (this.state.isNew) {\n      shelfTitle = inputElement.value;\n      if (shelfList.hasOwnProperty(shelfTitle)) {\n        toast(this.props.t(\"Duplicate Shelf\"));\n        return;\n      }\n    }\n    //未填书架名提醒\n    if (!shelfTitle) {\n      toast(this.props.t(\"Shelf Title is Empty\"));\n      return;\n    }\n    //判断书架中是否已有该图书\n    if (\n      shelfList[`${shelfTitle}`] &&\n      shelfList[`${shelfTitle}`].indexOf(this.props.currentBook.key) > -1\n    ) {\n      toast(this.props.t(\"Duplicate Book\"));\n      return;\n    }\n    if (this.props.isSelectBook) {\n      this.props.selectedBooks.forEach((item) => {\n        ShelfUtil.setShelf(shelfTitle, item);\n      });\n      this.props.handleSelectBook(!this.props.isSelectBook);\n      if (this.props.isSelectBook) {\n        this.props.handleSelectedBooks([]);\n      }\n    } else {\n      ShelfUtil.setShelf(shelfTitle, this.props.currentBook.key);\n    }\n\n    this.props.handleAddDialog(false);\n    toast.success(this.props.t(\"Add Successfully\"));\n    this.props.handleActionDialog(false);\n    this.props.handleMode(\"shelf\");\n    this.props.handleShelfIndex(shelfIndex);\n  };\n  //如果是添加到已存在的书架就diable新建图书的input框\n  handleChange = (shelfTitle: string) => {\n    if (shelfTitle === \"New\") {\n      this.setState({ isNew: true });\n    } else {\n      this.setState({ shelfTitle });\n      this.setState({ isNew: false });\n    }\n  };\n  render() {\n    const renderShelfList = () => {\n      let shelfList = ShelfUtil.getShelf();\n      let shelfTitle = Object.keys(shelfList);\n      return shelfTitle.map((item) => {\n        return (\n          <option\n            value={item}\n            key={item}\n            className=\"add-dialog-shelf-list-option\"\n          >\n            {this.props.t(item)}\n          </option>\n        );\n      });\n    };\n    return (\n      <div className=\"add-dialog-container\">\n        <div className=\"add-dialog-title\">\n          <Trans>Add to Shelf</Trans>\n        </div>\n        <div className=\"add-dialog-shelf-list-container\">\n          <div className=\"add-dialog-shelf-list-text\">\n            <Trans>Select</Trans>\n          </div>\n          <select\n            className=\"add-dialog-shelf-list-box\"\n            onChange={(event: React.ChangeEvent<HTMLSelectElement>) => {\n              this.handleChange(event.target.value);\n            }}\n          >\n            {renderShelfList()}\n          </select>\n        </div>\n        <div className=\"add-dialog-new-shelf-container\">\n          <div className=\"add-dialog-new-shelf-text\">\n            <Trans>New Shelf</Trans>\n          </div>\n          <input\n            className=\"add-dialog-new-shelf-box\"\n            disabled={!this.state.isNew}\n          />\n        </div>\n        <div\n          className=\"add-dialog-cancel\"\n          onClick={() => {\n            this.handleCancel();\n          }}\n        >\n          <Trans>Cancel</Trans>\n        </div>\n        <div\n          className=\"add-dialog-comfirm\"\n          onClick={() => {\n            this.handleComfirm();\n          }}\n        >\n          <Trans>Confirm</Trans>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default AddDialog;\n","import { connect } from \"react-redux\";\nimport {\n  handleAddDialog,\n  handleActionDialog,\n  handleMode,\n  handleShelfIndex,\n  handleSelectBook,\n  handleSelectedBooks,\n} from \"../../../store/actions\";\nimport { stateType } from \"../../../store\";\nimport { withTranslation } from \"react-i18next\";\nimport AddDialog from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    books: state.manager.books,\n    selectedBooks: state.manager.selectedBooks,\n    isSelectBook: state.manager.isSelectBook,\n    isOpenDeleteDialog: state.book.isOpenDeleteDialog,\n    currentBook: state.book.currentBook,\n    bookmarks: state.reader.bookmarks,\n    notes: state.reader.notes,\n    digests: state.reader.digests,\n  };\n};\nconst actionCreator = {\n  handleAddDialog,\n  handleActionDialog,\n  handleSelectBook,\n  handleMode,\n  handleShelfIndex,\n  handleSelectedBooks,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(AddDialog as any) as any);\n","//排序弹窗\nimport React from \"react\";\nimport \"./sortDialog.css\";\nimport SortUtil from \"../../../utils/readUtils/sortUtil\";\nimport { Trans } from \"react-i18next\";\nimport { SortDialogProps, SortDialogState } from \"./interface\";\n\nclass SortDialog extends React.Component<SortDialogProps, SortDialogState> {\n  constructor(props: SortDialogProps) {\n    super(props);\n    this.state = {\n      isNote: this.props.mode === \"note\" || this.props.mode === \"digest\",\n    };\n  }\n\n  handleSort = (code: number) => {\n    if (this.state.isNote) {\n      let noteSortCode = this.props.noteSortCode;\n      noteSortCode.sort = code;\n      this.props.handleNoteSortCode(noteSortCode);\n      this.props.handleNoteSort(true);\n      SortUtil.setNoteSortCode(code, this.props.noteSortCode.order);\n    } else {\n      let bookSortCode = this.props.bookSortCode;\n      bookSortCode.sort = code;\n      this.props.handleBookSortCode(bookSortCode);\n      this.props.handleBookSort(true);\n      SortUtil.setBookSortCode(code, this.props.bookSortCode.order);\n    }\n  };\n  handleOrder = (code: number) => {\n    if (this.state.isNote) {\n      let noteSortCode = this.props.noteSortCode;\n      noteSortCode.order = code;\n      this.props.handleNoteSort(true);\n      SortUtil.setNoteSortCode(this.props.noteSortCode.sort, code);\n      this.props.handleNoteSortCode(noteSortCode);\n    } else {\n      let bookSortCode = this.props.bookSortCode;\n      bookSortCode.order = code;\n      this.props.handleBookSort(true);\n      SortUtil.setBookSortCode(this.props.bookSortCode.sort, code);\n      this.props.handleBookSortCode(bookSortCode);\n    }\n  };\n\n  render() {\n    let sortCode = this.state.isNote\n      ? this.props.noteSortCode\n      : this.props.bookSortCode;\n    return (\n      <div\n        className=\"sort-dialog-container\"\n        onMouseLeave={() => {\n          this.props.handleSortDisplay(false);\n        }}\n        onMouseEnter={() => {\n          this.props.handleSortDisplay(true);\n        }}\n        style={this.state.isNote ? { height: \"150px\" } : {}}\n      >\n        {this.state.isNote ? (\n          <ul className=\"sort-by-category\">\n            {[\"Sort by Name\", \"Sort by Date\"].map((item, index) => {\n              return (\n                <li\n                  className=\"sort-by-category-list\"\n                  onClick={() => {\n                    this.handleSort(index + 1);\n                  }}\n                  style={sortCode.sort === index + 1 ? {} : { opacity: 0.34 }}\n                >\n                  <Trans>{item}</Trans>\n                  {sortCode.sort === index + 1 && (\n                    <span\n                      className=\"icon-check\"\n                      style={{ fontWeight: \"bold\" }}\n                    ></span>\n                  )}\n                </li>\n              );\n            })}\n          </ul>\n        ) : (\n          <ul className=\"sort-by-category\">\n            {[\n              \"Sort by Recent\",\n              \"Sort by Name\",\n              \"Sort by Date\",\n              \"Sort by Duration\",\n              \"Sort by Author\",\n              \"Sort by Percentage\",\n            ].map((item, index) => {\n              return (\n                <li\n                  className=\"sort-by-category-list\"\n                  onClick={() => {\n                    this.handleSort(index + 1);\n                  }}\n                  style={sortCode.sort === index + 1 ? {} : { opacity: 0.34 }}\n                  key={index + 1}\n                >\n                  <Trans>{item}</Trans>\n                  {sortCode.sort === index + 1 && (\n                    <span\n                      className=\"icon-check\"\n                      style={{ fontWeight: \"bold\" }}\n                    ></span>\n                  )}\n                </li>\n              );\n            })}\n          </ul>\n        )}\n        <div className=\"sort-dialog-seperator\"></div>\n        <ul className=\"sort-by-order\">\n          <li\n            className=\"sort-by-order-list\"\n            onClick={() => {\n              this.handleOrder(1);\n            }}\n            style={sortCode.order === 1 ? {} : { opacity: 0.34 }}\n          >\n            <Trans>Ascend</Trans>\n            {sortCode.order === 1 && (\n              <span\n                className=\"icon-check\"\n                style={{ fontWeight: \"bold\" }}\n              ></span>\n            )}\n          </li>\n          <li\n            className=\"sort-by-order-list\"\n            onClick={() => {\n              this.handleOrder(2);\n            }}\n            style={sortCode.order === 2 ? {} : { opacity: 0.34 }}\n          >\n            <Trans>Descend</Trans>\n            {sortCode.order === 2 && (\n              <span\n                className=\"icon-check\"\n                style={{ fontWeight: \"bold\" }}\n              ></span>\n            )}\n          </li>\n        </ul>\n      </div>\n    );\n  }\n}\n\nexport default SortDialog;\n","import { connect } from \"react-redux\";\nimport {\n  handleBookSortCode,\n  handleNoteSortCode,\n  handleSortDisplay,\n  handleBookSort,\n  handleNoteSort,\n} from \"../../../store/actions\";\nimport { stateType } from \"../../../store\";\nimport SortDialog from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    bookSortCode: state.manager.bookSortCode,\n    noteSortCode: state.manager.noteSortCode,\n    mode: state.sidebar.mode,\n    isSortDisplay: state.manager.isSortDisplay,\n  };\n};\nconst actionCreator = {\n  handleBookSortCode,\n  handleSortDisplay,\n  handleNoteSortCode,\n  handleBookSort,\n  handleNoteSort,\n};\nexport default connect(mapStateToProps, actionCreator)(SortDialog);\n","import React from \"react\";\nimport { Trans } from \"react-i18next\";\nimport { AboutDialogProps, AboutDialogState } from \"./interface\";\nimport { isElectron } from \"react-device-detect\";\nimport { openExternalUrl } from \"../../../utils/serviceUtils/urlUtil\";\n\nclass AboutDialog extends React.Component<AboutDialogProps, AboutDialogState> {\n  constructor(props: AboutDialogProps) {\n    super(props);\n    this.state = {};\n  }\n  handleJump = (url: string) => {\n    openExternalUrl(url);\n    this.props.handleAbout(false);\n  };\n\n  render() {\n    return (\n      <div\n        className=\"sort-dialog-container\"\n        onMouseLeave={() => {\n          this.props.handleAbout(false);\n        }}\n        onMouseEnter={() => {\n          this.props.handleAbout(true);\n        }}\n        style={\n          this.props.isNewWarning\n            ? { left: \"510px\", width: \"150px\" }\n            : {\n                left: \"510px\",\n\n                width: \"150px\",\n              }\n        }\n      >\n        <ul className=\"sort-by-category\">\n          <li\n            className=\"sort-by-category-list\"\n            onClick={() => {\n              this.props.handleSetting(true);\n              this.props.handleAbout(false);\n            }}\n          >\n            <Trans>Setting</Trans>\n          </li>\n\n          \n          <li\n            className=\"sort-by-category-list\"\n            onClick={() => {\n              this.handleJump(`https://koodo.960960.xyz/en/support`);\n            }}\n          >\n            <Trans>Feedback</Trans>\n          </li>\n          \n          <li\n            className=\"sort-by-category-list\"\n            onClick={() => {\n              this.handleJump(\"https://koodo.960960.xyz\");\n            }}\n          >\n            <Trans>Our Website</Trans>\n          </li>\n          \n          \n          {isElectron && (\n            <li\n              className=\"sort-by-category-list\"\n              onClick={() => {\n                window\n                  .require(\"electron\")\n                  .ipcRenderer.invoke(\"open-console\", \"ping\");\n              }}\n            >\n              <Trans>Open Console</Trans>\n            </li>\n          )}\n          {this.props.isNewWarning && (\n            <li\n              className=\"sort-by-category-list\"\n              onClick={() => {\n                this.handleJump(\"https://koodo.960960.xyz/en\");\n              }}\n              style={{ color: \"rgb(35, 170, 242)\" }}\n            >\n              <Trans>New Version</Trans>\n            </li>\n          )}\n        </ul>\n      </div>\n    );\n  }\n}\n\nexport default AboutDialog;\n","import { connect } from \"react-redux\";\nimport { handleSetting, handleAbout } from \"../../../store/actions\";\nimport { stateType } from \"../../../store\";\nimport AboutDialog from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    isSettingOpen: state.manager.isSettingOpen,\n    isAboutOpen: state.manager.isAboutOpen,\n    isNewWarning: state.manager.isNewWarning,\n  };\n};\nconst actionCreator = {\n  handleSetting,\n  handleAbout,\n};\nexport default connect(mapStateToProps, actionCreator)(AboutDialog as any);\n","export const config = {\n  callback_url:\n    process.env.NODE_ENV === \"production\"\n      ? \"https://reader.960960.xyz\"\n      : \"http://localhost:3000\",\n  token_url:\n    process.env.NODE_ENV === \"production\"\n      ? \"http://localhost:3366\"\n      : \"http://localhost:3366\",\n  dropbox_client_id: \"vnc67byrssocvy1\",\n  googledrive_client_id:\n    \"99440516227-ifr1ann33f2j610i3ri17ej0i51c7m6e.apps.googleusercontent.com\",\n  onedrive_client_id: \"ac96f9bf-94f2-49c0-8418-999b919bc236\",\n};\nexport const driveList = [\n  {\n    id: 1,\n    name: \"Local\",\n    icon: \"local\",\n    url: \"\",\n  },\n  {\n    id: 2,\n    name: \"Dropbox\",\n    icon: \"dropbox\",\n    url: `https://www.dropbox.com/oauth2/authorize?response_type=token&client_id=${config.dropbox_client_id}&redirect_uri=${config.callback_url}`,\n  },\n\n  {\n    id: 3,\n    name: \"Google Drive\",\n    icon: \"googledrive\",\n    url: \"\",\n  },\n  // {\n  //   id: 4,\n  //   name: \"OneDrive\",\n  //   icon: \"onedrive\",\n  //   url: `https://login.microsoftonline.com/common/oauth2/v2.0/authorize?client_id=${config.onedrive_client_id}&scope=files.readwrite offline_access&response_type=code&redirect_uri=${config.callback_url}`,\n  // },\n  {\n    id: 5,\n    name: \"WebDav\",\n    icon: \"webdav\",\n    url: \"\",\n  },\n];\n","import { restore } from \"./restoreUtil\";\nimport StorageUtil from \"../serviceUtils/storageUtil\";\n\nvar Dropbox = (window as any).Dropbox;\n\nclass DropboxUtil {\n  static UploadFile(blob: any) {\n    return new Promise<boolean>((resolve, reject) => {\n      var ACCESS_TOKEN = StorageUtil.getReaderConfig(\"dropbox_token\") || \"\";\n      var dbx = new Dropbox.Dropbox({ accessToken: ACCESS_TOKEN });\n      const file = new File([blob], \"data.zip\");\n      let date = new Date().getTime();\n      dbx\n        .filesUpload({\n          path: `/${date}/data.zip`,\n          contents: file,\n        })\n        .then(function (response: any) {\n          console.log(response, \"上传成功\");\n          resolve(true);\n        })\n        .catch(function (error: any) {\n          console.log(error, \"上传失败\");\n          resolve(false);\n        });\n    });\n  }\n  static DownloadFile() {\n    return new Promise<boolean>((resolve, reject) => {\n      var ACCESS_TOKEN = StorageUtil.getReaderConfig(\"dropbox_token\") || \"\";\n      var dbx = new Dropbox.Dropbox({ accessToken: ACCESS_TOKEN });\n      dbx\n        .filesListFolder({ path: \"\" })\n        .then(function (response) {\n          let folderArr: string[] = [];\n          response.result.entries.forEach((item) => {\n            if (!isNaN(parseInt(item.name))) folderArr.push(item.name);\n          });\n          let folder = folderArr.sort().reverse()[0];\n          dbx\n            .filesDownload({\n              path: `/${folder}/data.zip`,\n            })\n            .then(async (data: any) => {\n              let file = data.result.fileBlob;\n              file.lastModifiedDate = new Date();\n              file.name = \"data.zip\";\n              let result = await restore(file);\n              if (result) {\n                resolve(true);\n              } else {\n                resolve(false);\n              }\n            })\n            .catch(function (error: any) {\n              console.log(error);\n              resolve(false);\n            });\n        })\n        .catch(function (error) {\n          console.log(error);\n        });\n    });\n  }\n}\n\nexport default DropboxUtil;\n","import { restore } from \"./restoreUtil\";\nimport StorageUtil from \"../serviceUtils/storageUtil\";\n\nclass WebdavUtil {\n  static UploadFile = async (file: any) => {\n    return new Promise<boolean>(async (resolve, reject) => {\n      const { createClient } = window.require(\"webdav\");\n      let { url, username, password } = JSON.parse(\n        StorageUtil.getReaderConfig(\"webdav_token\") || \"\"\n      );\n      const client = createClient(url, {\n        username,\n        password,\n      });\n      var wfs = window.require(\"webdav-fs\")(url, {\n        username: username,\n        password: password,\n      });\n      if ((await client.exists(\"/KoodoReader\")) === false) {\n        await client.createDirectory(\"/KoodoReader\");\n      }\n      wfs.writeFile(\"/KoodoReader/data.zip\", file, \"binary\", function (err) {\n        console.log(err);\n        if (err) resolve(false);\n        let year = new Date().getFullYear(),\n          month = new Date().getMonth() + 1,\n          day = new Date().getDate();\n        client\n          .copyFile(\n            \"/KoodoReader/data.zip\",\n            \"/KoodoReader/\" +\n              `${year}-${month <= 9 ? \"0\" + month : month}-${\n                day <= 9 ? \"0\" + day : day\n              }.zip`\n          )\n          .then(() => {\n            resolve(true);\n          })\n          .catch(() => {\n            resolve(false);\n          });\n      });\n    });\n  };\n  static DownloadFile = async () => {\n    return new Promise<boolean>(async (resolve, reject) => {\n      const fs = window.require(\"fs\");\n      const path = window.require(\"path\");\n      const { createClient } = window.require(\"webdav\");\n      const { ipcRenderer } = window.require(\"electron\");\n      const dirPath = ipcRenderer.sendSync(\"user-data\", \"ping\");\n      const request = window.require(\"request\");\n      let { url, username, password } = JSON.parse(\n        StorageUtil.getReaderConfig(\"webdav_token\") || \"\"\n      );\n      const client = createClient(url, {\n        username,\n        password,\n      });\n      if ((await client.exists(\"/KoodoReader/data.zip\")) === false) {\n        resolve(false);\n      }\n      const downloadLink: string = client.getFileDownloadLink(\n        \"/KoodoReader/data.zip\"\n      );\n      let stream = fs.createWriteStream(path.join(dirPath, `data.zip`));\n      request(downloadLink)\n        .pipe(stream)\n        .on(\"close\", async (err) => {\n          if (err) {\n            console.log(err);\n            resolve(false);\n          } else {\n            var data = fs.readFileSync(path.join(dirPath, `data.zip`));\n            let blobTemp: any = new Blob([data], { type: \"application/zip\" });\n            let fileTemp = new File([blobTemp], \"data.zip\", {\n              lastModified: new Date().getTime(),\n              type: blobTemp.type,\n            });\n            let result = await restore(fileTemp);\n            if (!result) resolve(false);\n            try {\n              const fs_extra = window.require(\"fs-extra\");\n              fs_extra.remove(path.join(dirPath, `data.zip`), (error: any) => {\n                if (error) resolve(false);\n                resolve(true);\n              });\n            } catch (e) {\n              console.log(\"error removing \", path.join(dirPath, `data.zip`));\n              resolve(false);\n            }\n          }\n        });\n    });\n  };\n}\n\nexport default WebdavUtil;\n","import React, { Component } from \"react\";\nimport \"./tokenDialog.css\";\nimport { Trans } from \"react-i18next\";\nimport { TokenDialogProps, TokenDialogState } from \"./interface\";\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\nimport toast from \"react-hot-toast\";\nimport { openExternalUrl } from \"../../../utils/serviceUtils/urlUtil\";\nclass TokenDialog extends Component<TokenDialogProps, TokenDialogState> {\n  constructor(props: TokenDialogProps) {\n    super(props);\n    this.state = { isNew: false };\n  }\n\n  handleCancel = () => {\n    this.props.handleTokenDialog(false);\n  };\n  handleTokenComfirm = () => {\n    let token: string = (\n      document.querySelector(\".token-dialog-token-box\") as HTMLTextAreaElement\n    ).value;\n    StorageUtil.setReaderConfig(`${this.props.driveName}_token`, token);\n    this.props.handleTokenDialog(false);\n    toast.success(this.props.t(\"Add Successfully\"));\n  };\n  handleDavComfirm = () => {\n    let url: string = (\n      document.querySelector(\".token-dialog-url-box\") as HTMLTextAreaElement\n    ).value;\n    let username: string = (\n      document.querySelector(\n        \".token-dialog-username-box\"\n      ) as HTMLTextAreaElement\n    ).value;\n    let password: string = (\n      document.querySelector(\n        \".token-dialog-password-box\"\n      ) as HTMLTextAreaElement\n    ).value;\n    StorageUtil.setReaderConfig(\n      `${this.props.driveName}_token`,\n      JSON.stringify({ url, username, password })\n    );\n    this.props.handleTokenDialog(false);\n    toast.success(this.props.t(\"Add Successfully\"));\n  };\n  handleJump = (url: string) => {\n    openExternalUrl(url);\n  };\n  render() {\n    return (\n      <div className=\"token-dialog-container\">\n        <div className=\"token-dialog-box\">\n          <div className=\"token-dialog-title\">\n            <Trans>Authorize</Trans>\n            &nbsp;\n            {this.props.driveName}&nbsp;\n            <Trans>Token</Trans>\n          </div>\n          {this.props.driveName === \"webdav\" ? (\n            <>\n              <div\n                className=\"token-dialog-info-text\"\n                style={\n                  StorageUtil.getReaderConfig(\"lang\") === \"en\"\n                    ? { fontSize: \"14px\" }\n                    : {}\n                }\n              >\n                <Trans>Webdav Info</Trans>\n              </div>\n              <input\n                type=\"text\"\n                name=\"username\"\n                placeholder={this.props.t(\"Server Address\")}\n                id=\"token-dialog-url-box\"\n                className=\"token-dialog-url-box\"\n              />\n              <input\n                type=\"text\"\n                name=\"username\"\n                placeholder={this.props.t(\"Username\")}\n                id=\"token-dialog-username-box\"\n                className=\"token-dialog-username-box\"\n              />\n              <input\n                type=\"text\"\n                name=\"username\"\n                placeholder={this.props.t(\"Password\")}\n                id=\"token-dialog-password-box\"\n                className=\"token-dialog-password-box\"\n              />\n            </>\n          ) : (\n            <>\n              <div\n                className=\"token-dialog-info-text\"\n                style={\n                  StorageUtil.getReaderConfig(\"lang\") === \"en\"\n                    ? { fontSize: \"14px\" }\n                    : {}\n                }\n              >\n                <Trans>\n                  Please authorize your account, and fill the following box with\n                  the token\n                </Trans>\n              </div>\n              <div\n                className=\"token-dialog-link-text\"\n                onClick={() => {\n                  this.handleJump(this.props.url);\n                }}\n              >\n                <Trans>Authorize</Trans>\n              </div>\n              <textarea className=\"token-dialog-token-box\" />\n            </>\n          )}\n\n          <div\n            className=\"token-dialog-cancel\"\n            onClick={() => {\n              this.handleCancel();\n            }}\n          >\n            <Trans>Cancel</Trans>\n          </div>\n          <div\n            className=\"token-dialog-comfirm\"\n            onClick={() => {\n              if (this.props.driveName === \"webdav\") {\n                this.handleDavComfirm();\n              } else {\n                this.handleTokenComfirm();\n              }\n            }}\n          >\n            <Trans>Confirm</Trans>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default TokenDialog;\n","import { connect } from \"react-redux\";\nimport { handleTokenDialog } from \"../../../store/actions\";\nimport { stateType } from \"../../../store\";\nimport { withTranslation } from \"react-i18next\";\nimport TokenDialog from \"./component\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    books: state.manager.books,\n    isOpenDeleteDialog: state.book.isOpenDeleteDialog,\n    currentBook: state.book.currentBook,\n    bookmarks: state.reader.bookmarks,\n    notes: state.reader.notes,\n    digests: state.reader.digests,\n  };\n};\nconst actionCreator = {\n  handleTokenDialog,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(TokenDialog as any));\n","import React from \"react\";\nimport \"./backupDialog.css\";\nimport { driveList } from \"../../../constants/driveList\";\nimport { backup } from \"../../../utils/syncUtils/backupUtil\";\nimport { restore } from \"../../../utils/syncUtils/restoreUtil\";\nimport { Trans } from \"react-i18next\";\nimport DropboxUtil from \"../../../utils/syncUtils/dropbox\";\nimport WebdavUtil from \"../../../utils/syncUtils/webdav\";\nimport { BackupDialogProps, BackupDialogState } from \"./interface\";\nimport TokenDialog from \"../tokenDialog\";\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\nimport Lottie from \"react-lottie\";\nimport animationSuccess from \"../../../assets/lotties/success.json\";\nimport FileSaver from \"file-saver\";\nimport toast from \"react-hot-toast\";\nimport { isElectron } from \"react-device-detect\";\nconst successOptions = {\n  loop: false,\n  autoplay: true,\n  animationData: animationSuccess,\n  rendererSettings: {\n    preserveAspectRatio: \"xMidYMid slice\",\n  },\n};\nclass BackupDialog extends React.Component<\n  BackupDialogProps,\n  BackupDialogState\n> {\n  constructor(props: BackupDialogProps) {\n    super(props);\n    this.state = {\n      currentStep: 0,\n      isBackup: \"\",\n      currentDrive: 0,\n    };\n  }\n  handleClose = () => {\n    this.props.handleBackupDialog(false);\n  };\n\n  handleFinish = () => {\n    this.setState({ currentStep: 2 });\n    this.props.handleLoadingDialog(false);\n    this.showMessage(\"Excute Successfully\");\n    this.props.handleFetchBooks();\n  };\n  handleRestoreToLocal = async (event: any) => {\n    event.preventDefault();\n    this.props.handleLoadingDialog(true);\n    let result = await restore(event.target.files[0]);\n    if (result) {\n      this.handleFinish();\n    }\n  };\n  showMessage = (message: string) => {\n    toast(this.props.t(message));\n  };\n  handleDrive = (index: number) => {\n    let year = new Date().getFullYear(),\n      month = new Date().getMonth() + 1,\n      day = new Date().getDate();\n    this.setState({ currentDrive: index }, async () => {\n      switch (index) {\n        case 0:\n          let blob: Blob | boolean = await backup(\n            this.props.books,\n            this.props.notes,\n            this.props.bookmarks,\n            false\n          );\n          if (!blob) {\n            this.showMessage(\"Backup Failed\");\n          }\n          FileSaver.saveAs(\n            blob as Blob,\n            `${year}-${month <= 9 ? \"0\" + month : month}-${\n              day <= 9 ? \"0\" + day : day\n            }.zip`\n          );\n          this.handleFinish();\n          break;\n        case 1:\n          if (!StorageUtil.getReaderConfig(\"dropbox_token\")) {\n            this.props.handleTokenDialog(true);\n            break;\n          }\n\n          if (this.state.isBackup === \"yes\") {\n            this.showMessage(\"Uploading, please wait\");\n            this.props.handleLoadingDialog(true);\n\n            let blob: Blob | boolean = await backup(\n              this.props.books,\n              this.props.notes,\n              this.props.bookmarks,\n              false\n            );\n            if (!blob) {\n              this.showMessage(\"Backup Failed\");\n              this.props.handleLoadingDialog(false);\n            }\n            let result = await DropboxUtil.UploadFile(blob);\n            if (result) {\n              this.handleFinish();\n            } else {\n              this.showMessage(\"Upload failed, check your connection\");\n            }\n          } else {\n            this.props.handleLoadingDialog(true);\n            this.showMessage(\"Downloading, please wait\");\n            let result = await DropboxUtil.DownloadFile();\n            if (result) {\n              this.handleFinish();\n            } else {\n              this.showMessage(\"Download failed,network problem or no backup\");\n              this.props.handleLoadingDialog(false);\n            }\n          }\n\n          break;\n        case 2:\n          this.showMessage(\"Coming Soon\");\n          break;\n\n        case 3:\n          if (!StorageUtil.getReaderConfig(\"webdav_token\")) {\n            this.props.handleTokenDialog(true);\n            break;\n          }\n          if (this.state.isBackup === \"yes\") {\n            this.showMessage(\"Uploading, please wait\");\n            this.props.handleLoadingDialog(true);\n\n            let blob: any = await backup(\n              this.props.books,\n              this.props.notes,\n              this.props.bookmarks,\n              false\n            );\n            if (!blob) {\n              this.showMessage(\"Backup Failed\");\n              this.props.handleLoadingDialog(false);\n            }\n\n            let result = await WebdavUtil.UploadFile(\n              new File([blob], \"data.zip\", {\n                lastModified: new Date().getTime(),\n                type: blob.type,\n              })\n            );\n            if (result) {\n              this.handleFinish();\n            } else {\n              this.showMessage(\"Upload failed, check your connection\");\n              this.props.handleLoadingDialog(false);\n            }\n          } else {\n            this.showMessage(\"Downloading, please wait\");\n            this.props.handleLoadingDialog(true);\n\n            let result = await WebdavUtil.DownloadFile();\n            if (!result) {\n              this.showMessage(\"Download failed,network problem or no backup\");\n            } else {\n              this.handleFinish();\n            }\n          }\n          break;\n        default:\n          break;\n      }\n    });\n  };\n  render() {\n    const renderDrivePage = () => {\n      return driveList.map((item, index) => {\n        return (\n          <li\n            key={item.id}\n            className=\"backup-page-list-item\"\n            onClick={() => {\n              //webdav is avavilible on desktop\n              if (index === 3 && !isElectron) {\n                toast(\n                  this.props.t(\n                    \"Koodo Reader's web version are limited by the browser, for more powerful features, please download the desktop version.\"\n                  )\n                );\n                return;\n              }\n              this.handleDrive(index);\n            }}\n            style={index !== 2 ? { opacity: 1 } : {}}\n          >\n            <div className=\"backup-page-list-item-container\">\n              <span\n                className={`icon-${item.icon} backup-page-list-icon`}\n              ></span>\n              {StorageUtil.getReaderConfig(\"dropbox_token\") && index === 1 ? (\n                <div\n                  className=\"backup-page-list-title\"\n                  onClick={() => {\n                    StorageUtil.setReaderConfig(\"dropbox_token\", \"\");\n                    this.showMessage(\"Unauthorize Successfully\");\n                  }}\n                  style={{ color: \"rgb(0, 120, 212)\" }}\n                >\n                  <Trans>Unauthorize</Trans>\n                </div>\n              ) : StorageUtil.getReaderConfig(\"webdav_token\") && index === 3 ? (\n                <div\n                  className=\"backup-page-list-title\"\n                  onClick={() => {\n                    StorageUtil.setReaderConfig(\"webdav_token\", \"\");\n                    this.showMessage(\"Unauthorize Successfully\");\n                  }}\n                  style={{ color: \"rgb(0, 120, 212)\" }}\n                >\n                  <Trans>Unauthorize</Trans>\n                </div>\n              ) : (\n                <div className=\"backup-page-list-title\">\n                  <Trans>{item.name}</Trans>\n                </div>\n              )}\n            </div>\n          </li>\n        );\n      });\n    };\n\n    const dialogProps = {\n      driveName: driveList[this.state.currentDrive!].icon,\n      url: driveList[this.state.currentDrive!].url,\n    };\n\n    return (\n      <div className=\"backup-page-container\">\n        {this.props.isOpenTokenDialog ? <TokenDialog {...dialogProps} /> : null}\n        {this.state.currentStep === 0 ? (\n          <div className=\"backup-page-title\">\n            <Trans>Choose your operation</Trans>\n          </div>\n        ) : this.state.currentStep === 1 && this.state.isBackup === \"yes\" ? (\n          <div className=\"backup-page-title\">\n            <Trans>Where to keep your data?</Trans>\n          </div>\n        ) : this.state.currentStep === 1 && this.state.isBackup === \"no\" ? (\n          <div className=\"backup-page-title\">\n            <Trans>Where is your data?</Trans>\n          </div>\n        ) : null}\n        {this.state.currentStep === 0 ? (\n          <div className=\"backup-page-option\">\n            <div\n              className={\n                this.state.isBackup === \"yes\"\n                  ? \"backup-page-backup active\"\n                  : \"backup-page-backup\"\n              }\n              onClick={() => {\n                this.setState({ isBackup: \"yes\" });\n              }}\n            >\n              <span className=\"icon-backup\"></span>\n              <div style={{ lineHeight: 1.25 }}>\n                <Trans>Backup</Trans>\n              </div>\n            </div>\n\n            <div\n              className={\n                this.state.isBackup === \"no\"\n                  ? \"backup-page-backup active\"\n                  : \"backup-page-backup\"\n              }\n              onClick={(event) => {\n                if (!isElectron) {\n                  event.preventDefault();\n                  toast(\n                    this.props.t(\n                      \"Koodo Reader's web version are limited by the browser, for more powerful features, please download the desktop version.\"\n                    )\n                  );\n                  return;\n                }\n                this.setState({ isBackup: \"no\" });\n              }}\n            >\n              <span className=\"icon-restore\"></span>\n              <div>\n                <Trans>Restore</Trans>\n              </div>\n            </div>\n          </div>\n        ) : this.state.currentStep === 1 ? (\n          <div className=\"backup-page-drive-container\">\n            <div>{renderDrivePage()}</div>\n            {this.state.isBackup === \"no\" ? (\n              <input\n                type=\"file\"\n                id=\"restore-file\"\n                accept=\"application/zip\"\n                className=\"restore-file\"\n                name=\"file\"\n                multiple={false}\n                onChange={(event) => {\n                  this.handleRestoreToLocal(event);\n                }}\n              />\n            ) : null}\n          </div>\n        ) : (\n          <div className=\"backup-page-finish-container\">\n            <div className=\"backup-page-finish\">\n              <Lottie options={successOptions} height={80} width={80} />\n              <div className=\"backup-page-finish-text\">\n                <Trans>\n                  {this.state.isBackup === \"yes\"\n                    ? \"Backup Successfully\"\n                    : \"Restore Successfully\"}\n                </Trans>\n              </div>\n              {this.state.isBackup ? null : (\n                <div style={{ opacity: 0.6 }}>\n                  <Trans>Try refresh or restart</Trans>\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n        {this.state.isBackup === \"yes\" && this.state.currentStep === 0 ? (\n          <div className=\"backup-page-backup-selector\"></div>\n        ) : null}\n        {this.state.isBackup === \"no\" && this.state.currentStep === 0 ? (\n          <div\n            className=\"backup-page-backup-selector\"\n            style={{ marginLeft: \"252px\" }}\n          ></div>\n        ) : null}\n        <div\n          className=\"backup-page-close-icon\"\n          onClick={() => {\n            this.handleClose();\n          }}\n        >\n          <span className=\"icon-close backup-close-icon\"></span>\n        </div>\n\n        {this.state.currentStep === 1 ? (\n          <div\n            className=\"backup-page-next\"\n            onClick={() => {\n              this.setState({ currentStep: 0 });\n            }}\n          >\n            <Trans>Last Step</Trans>\n          </div>\n        ) : this.state.currentStep === 0 ? (\n          <div\n            className=\"backup-page-next\"\n            onClick={() => {\n              this.setState({ currentStep: 1 });\n            }}\n            style={this.state.isBackup ? {} : { display: \"none\" }}\n          >\n            <Trans>Next Step</Trans>\n          </div>\n        ) : null}\n      </div>\n    );\n  }\n}\n\nexport default BackupDialog;\n","import {\n  handleBackupDialog,\n  handleTokenDialog,\n  handleLoadingDialog,\n  handleTipDialog,\n  handleFetchBooks,\n} from \"../../../store/actions\";\nimport { connect } from \"react-redux\";\nimport { withTranslation } from \"react-i18next\";\nimport { stateType } from \"../../../store\";\nimport BackupDialog from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    books: state.manager.books,\n    bookmarks: state.reader.bookmarks,\n    notes: state.reader.notes,\n    digests: state.reader.digests,\n    isOpenTokenDialog: state.backupPage.isOpenTokenDialog,\n  };\n};\nconst actionCreator = {\n  handleBackupDialog,\n  handleTokenDialog,\n  handleLoadingDialog,\n  handleTipDialog,\n  handleFetchBooks,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(BackupDialog as any) as any);\n","export const dropdownList = [\n  {\n    id: 1,\n    title: \"Font Family\",\n    value: \"fontFamily\",\n    option: [\n      \"Built-in font\",\n      \"Helvetica\",\n      \"Times New Roman\",\n      \"Microsoft YaHei\",\n      \"SimSun\",\n      \"SimHei\",\n      \"Arial\",\n    ],\n  },\n  {\n    id: 2,\n    title: \"Line Height\",\n    value: \"lineHeight\",\n    option: [\"Default\", \"1\", \"1.25\", \"1.5\", \"1.75\", \"2\"],\n  },\n  {\n    id: 3,\n    title: \"Text Align\",\n    value: \"textAlign\",\n    option: [\"Default\", \"Left\", \"Justify\", \"Right\"],\n  },\n  {\n    id: 4,\n    title: \"Chinese Conversion\",\n    value: \"convertChinese\",\n    option: [\n      \"Default\",\n      \"Simplified To Traditional\",\n      \"Traditional To Simplified\",\n    ],\n  },\n];\nexport const speedList = {\n  id: 3,\n  title: \"Speed\",\n  value: \"speed\",\n  option: [\n    \"0.1\",\n    \"0.2\",\n    \"0.3\",\n    \"0.4\",\n    \"0.5\",\n    \"0.75\",\n    \"1\",\n    \"1.25\",\n    \"1.5\",\n    \"1.75\",\n    \"2\",\n    \"3\",\n    \"4\",\n    \"5\",\n  ],\n};\n","export const settingList = [\n  {\n    isElectron: false,\n    title: \"Turn on touch screen mode\",\n    desc: \"Gesture and UI optimization for touch screen\",\n    propName: \"isTouch\",\n  },\n  {\n    isElectron: false,\n    title: \"Prevent accidental trigger\",\n    desc: \"Reader menu will not be triggered by hovering but clicking on the area\",\n    propName: \"isPreventTrigger\",\n  },\n  {\n    isElectron: true,\n    title: \"Import books as link\",\n    desc: \"The imported books will not be copied to library, only linked to the original book path\",\n    propName: \"isImportPath\",\n  },\n  {\n    isElectron: true,\n    title: \"Merge reader into Word\",\n    desc: \"Get rid of window frame, make reader hide into Word or any text editor, and can't be detected. You need to set up the reader's position, size and style first.\",\n    propName: \"isMergeWord\",\n  },\n  {\n    isElectron: false,\n    title: \"Auto open last-read book\",\n    desc: \"The book that you read from last time will be open automatically when launching\",\n    propName: \"isOpenBook\",\n  },\n  {\n    isElectron: true,\n    title: \"Auto open book in fullscreen\",\n    desc: \"Reader window will be maximized to fit the screen when opening a book\",\n    propName: \"isAutoFullscreen\",\n  },\n  {\n    isElectron: false,\n    title: \"Auto expand content\",\n    desc: \"All the folded content will be expanded in the navigation panel\",\n    propName: \"isExpandContent\",\n  },\n  {\n    isElectron: true,\n    title: \"Disable screen blanking\",\n    desc: \"When Koodo is running, your computer won't enter sleep mode\",\n    propName: \"isPreventSleep\",\n  },\n  {\n    isElectron: true,\n    title: \"Open book without adding it to library\",\n    desc: \"When opening books in the file manager with Koodo, the opened books won't be added to the library\",\n    propName: \"isPreventAdd\",\n  },\n  {\n    isElectron: true,\n    title: \"Disable update notification\",\n    propName: \"isDisableUpdate\",\n  },\n  {\n    isElectron: false,\n    title: \"Use first page as PDF cover\",\n    propName: \"isPDFCover\",\n  },\n  {\n    isElectron: true,\n    title: \"Open url with built-in browser\",\n    propName: \"isUseBuiltIn\",\n  },\n];\nexport const langList = [\n  { label: \"简体中文\", value: \"zh\" },\n  { label: \"繁體中文\", value: \"cht\" },\n  { label: \"English\", value: \"en\" },\n  { label: \"Pусский\", value: \"ru\" },\n  { label: \"Español\", value: \"es\" },\n  { label: \"Français\", value: \"fr\" },\n  { label: \"Português\", value: \"ptBR\" },\n  { label: \"فارسی\", value: \"fa\" },\n  { label: \"日本語\", value: \"jp\" },\n  { label: \"čeština\", value: \"cs\" },\n  { label: \"Deutsch\", value: \"de\" },\n  { label: \"한국어\", value: \"ko\" },\n  { label: \"Polski\", value: \"pl\" },\n  { label: \"Română\", value: \"ro\" },\n];\n\nexport const searchList = [\n  { label: \"Google\", value: \"google\" },\n  { label: \"Baidu\", value: \"baidu\" },\n  { label: \"Bing\", value: \"bing\" },\n  { label: \"DuckDuckGo\", value: \"duckduckgo\" },\n  { label: \"Yandex\", value: \"yandex\" },\n  { label: \"Yahoo\", value: \"yahoo\" },\n  { label: \"Naver\", value: \"naver\" },\n  { label: \"Baidu Baike\", value: \"baike\" },\n  { label: \"Wikipedia\", value: \"wiki\" },\n];\nexport const skinList = [\n  { label: \"Follow OS\", value: \"system\" },\n  { label: \"Light Mode\", value: \"light\" },\n  { label: \"Night Mode\", value: \"night\" },\n];\n\nexport const readerSettingList = [\n  {\n    title: \"Sliding Animation\",\n    propName: \"isSliding\",\n  },\n  {\n    title: \"Text Indent\",\n    propName: \"isIndent\",\n  },\n  {\n    title: \"Bold\",\n    propName: \"isBold\",\n  },\n  {\n    title: \"Italic\",\n    propName: \"isItalic\",\n  },\n  {\n    title: \"Text underline\",\n    propName: \"isUnderline\",\n  },\n  {\n    title: \"Text shadow\",\n    propName: \"isShadow\",\n  },\n  {\n    title: \"Invert color\",\n    propName: \"isInvert\",\n  },\n  {\n    title: \"Hide footer\",\n    propName: \"isHideFooter\",\n  },\n  {\n    title: \"Hide header\",\n    propName: \"isHideHeader\",\n  },\n  {\n    title: \"Hide mimical background\",\n    propName: \"isHideBackground\",\n  },\n  {\n    title: \"Hide navigation button\",\n    propName: \"isHidePageButton\",\n  },\n  {\n    title: \"Hide menu button\",\n    propName: \"isHideMenuButton\",\n  },\n];\n","export const backgroundList = [\n  \"rgba(255,255,255,1)\",\n  \"rgba(44,47,49,1)\",\n  \"rgba(233, 216, 188,1)\",\n  \"rgba(197, 231, 207,1)\",\n];\nexport const textList = [\n  \"rgba(0,0,0,1)\",\n  \"rgba(255,255,255,1)\",\n  \"rgba(89, 68, 41,1)\",\n  \"rgba(54, 80, 62,1)\",\n];\nexport const themeList = [\n  {\n    id: 0,\n    color: \"rgba(75, 75, 75, 1)\",\n    name: \"default\",\n    title: \"Default\",\n  },\n  {\n    id: 1,\n    color: \"rgba(1, 121, 202, 1)\",\n    name: \"blue\",\n    title: \"Blue\",\n  },\n  {\n    id: 2,\n    color: \"rgba(0, 143, 145, 1)\",\n    name: \"green\",\n    title: \"Green\",\n  },\n\n  {\n    id: 3,\n    color: \"rgba(241, 100, 100, 1)\",\n    name: \"red\",\n    title: \"Red\",\n  },\n  {\n    id: 4,\n    color: \"rgba(104, 103, 209, 1)\",\n    name: \"purple\",\n    title: \"Purple\",\n  },\n];\n","import React from \"react\";\nimport \"./settingDialog.css\";\nimport { SettingInfoProps, SettingInfoState } from \"./interface\";\nimport { Trans } from \"react-i18next\";\nimport i18n from \"../../../i18n\";\nimport { version } from \"../../../../package.json\";\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\nimport { changePath } from \"../../../utils/syncUtils/common\";\nimport { isElectron } from \"react-device-detect\";\nimport { dropdownList } from \"../../../constants/dropdownList\";\nimport { Tooltip } from \"react-tippy\";\nimport { restore } from \"../../../utils/syncUtils/restoreUtil\";\nimport {\n  settingList,\n  langList,\n  searchList,\n  skinList,\n} from \"../../../constants/settingList\";\nimport { themeList } from \"../../../constants/themeList\";\nimport _ from \"underscore\";\nimport toast from \"react-hot-toast\";\nimport { openExternalUrl } from \"../../../utils/serviceUtils/urlUtil\";\nclass SettingDialog extends React.Component<\n  SettingInfoProps,\n  SettingInfoState\n> {\n  constructor(props: SettingInfoProps) {\n    super(props);\n    this.state = {\n      isTouch: StorageUtil.getReaderConfig(\"isTouch\") === \"yes\",\n      isImportPath: StorageUtil.getReaderConfig(\"isImportPath\") === \"yes\",\n      isMergeWord: StorageUtil.getReaderConfig(\"isMergeWord\") === \"yes\",\n      isPreventTrigger:\n        StorageUtil.getReaderConfig(\"isPreventTrigger\") === \"yes\",\n      isAutoFullscreen:\n        StorageUtil.getReaderConfig(\"isAutoFullscreen\") === \"yes\",\n      isPreventAdd: StorageUtil.getReaderConfig(\"isPreventAdd\") === \"yes\",\n      isOpenBook: StorageUtil.getReaderConfig(\"isOpenBook\") === \"yes\",\n      isExpandContent: StorageUtil.getReaderConfig(\"isExpandContent\") === \"yes\",\n      isPreventSleep: StorageUtil.getReaderConfig(\"isPreventSleep\") === \"yes\",\n      isOpenInMain: StorageUtil.getReaderConfig(\"isOpenInMain\") === \"yes\",\n      isDisableUpdate: StorageUtil.getReaderConfig(\"isDisableUpdate\") === \"yes\",\n      appSkin: StorageUtil.getReaderConfig(\"appSkin\"),\n      isDisableAnalytics:\n        StorageUtil.getReaderConfig(\"isDisableAnalytics\") === \"yes\",\n      isUseBuiltIn: StorageUtil.getReaderConfig(\"isUseBuiltIn\") === \"yes\",\n      isPDFCover: StorageUtil.getReaderConfig(\"isPDFCover\") === \"yes\",\n      currentThemeIndex: _.findLastIndex(themeList, {\n        name: StorageUtil.getReaderConfig(\"themeColor\"),\n      }),\n    };\n  }\n  componentDidMount() {\n    StorageUtil.getReaderConfig(\"systemFont\") &&\n      document\n        .getElementsByClassName(\"lang-setting-dropdown\")[0]\n        ?.children[\n          dropdownList[0].option.indexOf(\n            StorageUtil.getReaderConfig(\"systemFont\")\n          )\n        ]?.setAttribute(\"selected\", \"selected\");\n    document\n      .getElementsByClassName(\"lang-setting-dropdown\")[1]\n      ?.children[\n        langList\n          .map((item) => item.value)\n          .indexOf(\n            StorageUtil.getReaderConfig(\"lang\") ||\n              (navigator.language.indexOf(\"zh\") > -1 ? \"zh\" : \"en\")\n          )\n      ]?.setAttribute(\"selected\", \"selected\");\n    document.getElementsByClassName(\"lang-setting-dropdown\")[2]?.children[\n      _.findLastIndex(searchList, {\n        value:\n          StorageUtil.getReaderConfig(\"searchEngine\") ||\n          (navigator.language === \"zh-CN\" ? \"baidu\" : \"google\"),\n      })\n    ]?.setAttribute(\"selected\", \"selected\");\n    document.getElementsByClassName(\"lang-setting-dropdown\")[3]?.children[\n      _.findLastIndex(skinList, {\n        value: StorageUtil.getReaderConfig(\"appSkin\") || \"system\",\n      })\n    ]?.setAttribute(\"selected\", \"selected\");\n  }\n  handleRest = (bool: boolean) => {\n    toast.success(this.props.t(\"Change Successfully\"));\n  };\n  changeLanguage = (lng: string) => {\n    i18n.changeLanguage(lng);\n    StorageUtil.setReaderConfig(\"lang\", lng);\n  };\n  changeSearch = (searchEngine: string) => {\n    StorageUtil.setReaderConfig(\"searchEngine\", searchEngine);\n  };\n  changeSkin = (skin: string) => {\n    StorageUtil.setReaderConfig(\"appSkin\", skin);\n\n    if (\n      skin === \"night\" ||\n      (StorageUtil.getReaderConfig(\"appSkin\") === \"system\" &&\n        StorageUtil.getReaderConfig(\"isOSNight\") === \"yes\")\n    ) {\n      StorageUtil.setReaderConfig(\"backgroundColor\", \"rgba(44,47,49,1)\");\n      StorageUtil.setReaderConfig(\"textColor\", \"rgba(255,255,255,1)\");\n    } else if (\n      skin === \"light\" ||\n      (StorageUtil.getReaderConfig(\"appSkin\") === \"system\" &&\n        StorageUtil.getReaderConfig(\"isOSNight\") !== \"yes\")\n    ) {\n      StorageUtil.setReaderConfig(\"backgroundColor\", \"rgba(255,255,255,1)\");\n      StorageUtil.setReaderConfig(\"textColor\", \"rgba(0,0,0,1)\");\n    }\n\n    if (isElectron) {\n      toast(this.props.t(\"Try refresh or restart\"));\n    } else {\n      window.location.reload();\n    }\n  };\n  changeFont = (font: string) => {\n    let body = document.getElementsByTagName(\"body\")[0];\n    body?.setAttribute(\"style\", \"font-family:\" + font + \"!important\");\n    StorageUtil.setReaderConfig(\"systemFont\", font);\n  };\n  handleJump = (url: string) => {\n    openExternalUrl(url);\n  };\n  handleSetting = (stateName: string) => {\n    this.setState({ [stateName]: !this.state[stateName] } as any);\n    StorageUtil.setReaderConfig(\n      stateName,\n      this.state[stateName] ? \"no\" : \"yes\"\n    );\n    this.handleRest(this.state[stateName]);\n  };\n  syncFromLocation = async () => {\n    const fs = window.require(\"fs\");\n    const path = window.require(\"path\");\n    const { zip } = window.require(\"zip-a-folder\");\n    let storageLocation = localStorage.getItem(\"storageLocation\")\n      ? localStorage.getItem(\"storageLocation\")\n      : window\n          .require(\"electron\")\n          .ipcRenderer.sendSync(\"storage-location\", \"ping\");\n    let sourcePath = path.join(storageLocation, \"config\");\n    let outPath = path.join(storageLocation, \"config.zip\");\n    await zip(sourcePath, outPath);\n\n    var data = fs.readFileSync(outPath);\n\n    let blobTemp = new Blob([data], { type: \"application/epub+zip\" });\n    let fileTemp = new File([blobTemp], \"config.zip\", {\n      lastModified: new Date().getTime(),\n      type: blobTemp.type,\n    });\n\n    let result = await restore(fileTemp, true);\n    if (result) {\n      toast.success(this.props.t(\"Change Successfully\"));\n    } else {\n      toast.error(this.props.t(\"Change Failed\"));\n    }\n  };\n  handleChangeLocation = async () => {\n    const { ipcRenderer } = window.require(\"electron\");\n    const path = await ipcRenderer.invoke(\"change-path\");\n    if (!path.filePaths[0]) {\n      return;\n    }\n    let result = await changePath(\n      localStorage.getItem(\"storageLocation\")\n        ? localStorage.getItem(\"storageLocation\")\n        : ipcRenderer.sendSync(\"storage-location\", \"ping\"),\n      path.filePaths[0]\n    );\n    if (result === 1) {\n      this.syncFromLocation();\n    } else if (result === 2) {\n      this.props.handleFetchBooks();\n      toast.success(this.props.t(\"Change Successfully\"));\n    } else {\n      toast.error(this.props.t(\"Change Failed\"));\n    }\n    localStorage.setItem(\"storageLocation\", path.filePaths[0]);\n    document.getElementsByClassName(\n      \"setting-dialog-location-title\"\n    )[0].innerHTML =\n      path.filePaths[0] ||\n      localStorage.getItem(\"storageLocation\") ||\n      ipcRenderer.sendSync(\"storage-location\", \"ping\");\n  };\n\n  handleTheme = (name: string, index: number) => {\n    this.setState({ currentThemeIndex: index });\n    StorageUtil.setReaderConfig(\"themeColor\", name);\n    if (isElectron) {\n      toast(this.props.t(\"Try refresh or restart\"));\n    } else {\n      window.location.reload();\n    }\n  };\n  handleMergeWord = () => {\n    if (this.state.isOpenInMain && !this.state.isMergeWord) {\n      toast(this.props.t(\"Please turn off open books in the main window\"));\n      return;\n    }\n    this.handleSetting(\"isMergeWord\");\n  };\n  handleOpenInMain = () => {\n    if (this.state.isMergeWord && !this.state.isOpenInMain) {\n      toast(this.props.t(\"Please turn off merge with word first\"));\n      return;\n    }\n    this.handleSetting(\"isOpenInMain\");\n  };\n  render() {\n    return (\n      <div className=\"setting-dialog-container\">\n        <p className=\"setting-dialog-title\">\n          <Trans>Setting</Trans>\n        </p>\n        <p className=\"setting-subtitle\">\n          <Trans>Version</Trans>\n          {version}\n          &nbsp;&nbsp;\n          <Trans>\n            {StorageUtil.getReaderConfig(\"appInfo\") === \"new\"\n              ? \"New Version Available\"\n              : StorageUtil.getReaderConfig(\"appInfo\") === \"stable\"\n              ? \"Latest Stable Version\"\n              : StorageUtil.getReaderConfig(\"appInfo\") === \"dev\"\n              ? \"Developer Version\"\n              : \"\"}\n          </Trans>\n        </p>\n        <div\n          className=\"setting-close-container\"\n          onClick={() => {\n            this.props.handleSetting(false);\n          }}\n        >\n          <span className=\"icon-close setting-close\"></span>\n        </div>\n\n        <div className=\"setting-dialog-info\">\n          {settingList.map((item, index) => {\n            return (\n              <div\n                style={\n                  item.isElectron ? (isElectron ? {} : { display: \"none\" }) : {}\n                }\n                key={item.propName}\n              >\n                <div className=\"setting-dialog-new-title\" key={item.title}>\n                  <span style={{ width: \"250px\" }}>\n                    <Trans>{item.title}</Trans>\n                  </span>\n\n                  <span\n                    className=\"single-control-switch\"\n                    onClick={() => {\n                      switch (item.propName) {\n                        case \"isMergeWord\":\n                          this.handleMergeWord();\n                          break;\n                        case \"isOpenInMain\":\n                          this.handleOpenInMain();\n                          break;\n                        default:\n                          this.handleSetting(item.propName);\n                          break;\n                      }\n                    }}\n                    style={this.state[item.propName] ? {} : { opacity: 0.6 }}\n                  >\n                    <span\n                      className=\"single-control-button\"\n                      style={\n                        this.state[item.propName]\n                          ? {\n                              transform: \"translateX(20px)\",\n                              transition: \"transform 0.5s ease\",\n                            }\n                          : {\n                              transform: \"translateX(0px)\",\n                              transition: \"transform 0.5s ease\",\n                            }\n                      }\n                    ></span>\n                  </span>\n                </div>\n                <p className=\"setting-option-subtitle\">\n                  <Trans>{item.desc}</Trans>\n                </p>\n              </div>\n            );\n          })}\n          <div className=\"setting-dialog-new-title\">\n            <Trans>Theme Color</Trans>\n            <ul className=\"theme-setting-container\">\n              {themeList.map((item, index) => (\n                <Tooltip\n                  key={item.id}\n                  title={this.props.t(item.title)}\n                  position=\"top\"\n                  trigger=\"mouseenter\"\n                >\n                  <li\n                    className={\n                      index === this.state.currentThemeIndex\n                        ? \"active-color theme-setting-item\"\n                        : \"theme-setting-item\"\n                    }\n                    onClick={() => {\n                      this.handleTheme(item.name, index);\n                    }}\n                    style={{ backgroundColor: item.color }}\n                  ></li>\n                </Tooltip>\n              ))}\n            </ul>\n          </div>\n\n          {isElectron && (\n            <>\n              <div className=\"setting-dialog-new-title\">\n                <Trans>Change storage location</Trans>\n\n                <span\n                  className=\"change-location-button\"\n                  onClick={() => {\n                    this.handleChangeLocation();\n                  }}\n                >\n                  <Trans>Select</Trans>\n                </span>\n              </div>\n              <div className=\"setting-dialog-location-title\">\n                {localStorage.getItem(\"storageLocation\")\n                  ? localStorage.getItem(\"storageLocation\")\n                  : window\n                      .require(\"electron\")\n                      .ipcRenderer.sendSync(\"storage-location\", \"ping\")}\n              </div>\n            </>\n          )}\n\n          <div className=\"setting-dialog-new-title\">\n            <Trans>System Font</Trans>\n            <select\n              name=\"\"\n              className=\"lang-setting-dropdown\"\n              onChange={(event) => {\n                this.changeFont(event.target.value);\n              }}\n            >\n              {dropdownList[0].option.map((item) => (\n                <option value={item} key={item} className=\"lang-setting-option\">\n                  {this.props.t(item)}\n                </option>\n              ))}\n            </select>\n          </div>\n\n          <div className=\"setting-dialog-new-title\">\n            <Trans>Language</Trans>\n            <select\n              name=\"\"\n              className=\"lang-setting-dropdown\"\n              onChange={(event) => {\n                this.changeLanguage(event.target.value);\n              }}\n            >\n              {langList.map((item) => (\n                <option\n                  value={item.value}\n                  key={item.value}\n                  className=\"lang-setting-option\"\n                >\n                  {item.label}\n                </option>\n              ))}\n            </select>\n          </div>\n          <div className=\"setting-dialog-new-title\">\n            <Trans>Default search engine</Trans>\n            <select\n              name=\"\"\n              className=\"lang-setting-dropdown\"\n              onChange={(event) => {\n                this.changeSearch(event.target.value);\n              }}\n            >\n              {searchList.map((item) => (\n                <option\n                  value={item.value}\n                  key={item.value}\n                  className=\"lang-setting-option\"\n                >\n                  {this.props.t(item.label)}\n                </option>\n              ))}\n            </select>\n          </div>\n          <div className=\"setting-dialog-new-title\">\n            <Trans>Appearance</Trans>\n            <select\n              name=\"\"\n              className=\"lang-setting-dropdown\"\n              onChange={(event) => {\n                this.changeSkin(event.target.value);\n              }}\n            >\n              {skinList.map((item) => (\n                <option\n                  value={item.value}\n                  key={item.value}\n                  className=\"lang-setting-option\"\n                >\n                  {this.props.t(item.label)}\n                </option>\n              ))}\n            </select>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default SettingDialog;\n","import { connect } from \"react-redux\";\nimport SettingDialog from \"./component\";\nimport { withTranslation } from \"react-i18next\";\nimport {\n  handleSetting,\n  handleTipDialog,\n  handleTip,\n  handleFetchBooks,\n} from \"../../../store/actions\";\nimport { stateType } from \"../../../store\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    bookmarks: state.reader.bookmarks,\n    books: state.manager.books,\n    notes: state.reader.notes,\n  };\n};\nconst actionCreator = {\n  handleSetting,\n  handleTipDialog,\n  handleTip,\n  handleFetchBooks,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(SettingDialog as any));\n","import React from \"react\";\nimport \"./actionDialog.css\";\nimport { Trans } from \"react-i18next\";\nimport { ActionDialogProps } from \"./interface\";\nimport AddTrash from \"../../../utils/readUtils/addTrash\";\nimport FileSaver from \"file-saver\";\nimport Parser from \"html-react-parser\";\nimport ShelfUtil from \"../../../utils/readUtils/shelfUtil\";\nimport toast from \"react-hot-toast\";\nimport BookUtil from \"../../../utils/fileUtils/bookUtil\";\nclass ActionDialog extends React.Component<ActionDialogProps> {\n  handleDeleteBook = () => {\n    this.props.handleReadingBook(this.props.currentBook);\n    this.props.handleDeleteDialog(true);\n    this.props.handleActionDialog(false);\n  };\n  handleEditBook = () => {\n    this.props.handleEditDialog(true);\n    this.props.handleReadingBook(this.props.currentBook);\n    this.props.handleActionDialog(false);\n  };\n  handleAddShelf = () => {\n    this.props.handleAddDialog(true);\n    this.props.handleReadingBook(this.props.currentBook);\n    this.props.handleActionDialog(false);\n  };\n  handleRestoreBook = () => {\n    AddTrash.clear(this.props.currentBook.key);\n    this.props.handleActionDialog(false);\n    toast.success(this.props.t(\"Restore Successfully\"));\n    this.props.handleFetchBooks();\n  };\n  render() {\n    if (this.props.mode === \"trash\") {\n      return (\n        <div\n          className=\"action-dialog-container\"\n          onMouseLeave={() => {\n            this.props.handleActionDialog(false);\n          }}\n          onMouseEnter={() => {\n            this.props.handleActionDialog(true);\n          }}\n          style={{\n            left: this.props.left,\n            top: this.props.top,\n          }}\n        >\n          <div className=\"action-dialog-actions-container\">\n            <div\n              className=\"action-dialog-add\"\n              onClick={() => {\n                this.handleRestoreBook();\n              }}\n            >\n              <span className=\"icon-clockwise view-icon\"></span>\n              <span className=\"action-name\">\n                <Trans>Restore</Trans>\n              </span>\n              <p className=\"action-name\"></p>\n            </div>\n          </div>\n        </div>\n      );\n    }\n    return (\n      <div\n        className=\"action-dialog-container\"\n        onMouseLeave={() => {\n          this.props.handleActionDialog(false);\n        }}\n        onMouseEnter={() => {\n          this.props.handleActionDialog(true);\n        }}\n        style={{ left: this.props.left, top: this.props.top }}\n      >\n        <div className=\"action-dialog-actions-container\">\n          <div\n            className=\"action-dialog-add\"\n            onClick={() => {\n              this.handleAddShelf();\n            }}\n          >\n            <span className=\"icon-shelf view-icon\"></span>\n            <p className=\"action-name\">\n              <Trans>Add to Shelf</Trans>\n            </p>\n            <p className=\"action-name\"></p>\n          </div>\n          <div\n            className=\"action-dialog-delete\"\n            onClick={() => {\n              this.handleDeleteBook();\n            }}\n          >\n            <span className=\"icon-trash view-icon\"></span>\n            <p className=\"action-name\">\n              <Trans>Delete</Trans>\n            </p>\n            <p className=\"action-name\"></p>\n          </div>\n          <div\n            className=\"action-dialog-edit\"\n            onClick={() => {\n              this.handleEditBook();\n            }}\n          >\n            <span className=\"icon-edit view-icon\"></span>\n            <p className=\"action-name\">\n              <Trans>Edit</Trans>\n            </p>\n            <p className=\"action-name\"></p>\n          </div>\n          \n        </div>\n        <div className=\"sort-dialog-seperator\"></div>\n\n        <div className=\"action-dialog-book-info\">\n          <div>\n            <p className=\"action-dialog-book-publisher\">\n              <Trans>Book Name</Trans>:\n            </p>\n            <p className=\"action-dialog-book-title\">\n              {this.props.currentBook.name}\n            </p>\n            <p className=\"action-dialog-book-publisher\">\n              <Trans>Author</Trans>:\n            </p>\n            <p className=\"action-dialog-book-title\">\n              <Trans>{this.props.currentBook.author}</Trans>\n            </p>\n          </div>\n          <div>\n            <p className=\"action-dialog-book-publisher\">\n              <Trans>Publisher</Trans>:\n            </p>\n            <p className=\"action-dialog-book-title\">\n              {this.props.currentBook.publisher}\n            </p>\n          </div>\n          <div>\n            <p className=\"action-dialog-book-publisher\">\n              <Trans>File size</Trans>:\n            </p>\n            <p className=\"action-dialog-book-title\">\n              {this.props.currentBook.size\n                ? this.props.currentBook.size / 1024 / 1024 > 1\n                  ? parseFloat(\n                      this.props.currentBook.size / 1024 / 1024 + \"\"\n                    ).toFixed(2) + \"Mb\"\n                  : parseInt(this.props.currentBook.size / 1024 + \"\") + \"Kb\"\n                : // eslint-disable-next-line\n                  \"0\" + \"Kb\"}\n            </p>\n          </div>\n          <div>\n            <p className=\"action-dialog-book-added\">\n              <Trans>Added at</Trans>:\n            </p>\n            <p className=\"action-dialog-book-title\">\n              {new Date(parseInt(this.props.currentBook.key))\n                .toLocaleString()\n                .replace(/:\\d{1,2}$/, \" \")}\n            </p>\n          </div>\n          <div>\n            <p className=\"action-dialog-book-publisher\">\n              <Trans>Shelf</Trans>:\n            </p>\n            <p className=\"action-dialog-book-title\">\n              {ShelfUtil.getBookPosition(this.props.currentBook.key).map(\n                (item) => (\n                  <>\n                    #<Trans>{item}</Trans>&nbsp;\n                  </>\n                )\n              )}\n            </p>\n          </div>\n          <div>\n            <p className=\"action-dialog-book-desc\">\n              <Trans>Description</Trans>:\n            </p>\n            <div className=\"action-dialog-book-detail\">\n              {Parser(this.props.currentBook.description || \" \")}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ActionDialog;\n","import { connect } from \"react-redux\";\nimport {\n  handleEditDialog,\n  handleDeleteDialog,\n  handleAddDialog,\n  handleActionDialog,\n  handleReadingBook,\n  handleFetchBooks,\n} from \"../../../store/actions\";\n\nimport { stateType } from \"../../../store\";\nimport { withTranslation } from \"react-i18next\";\nimport ActionDialog from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    mode: state.sidebar.mode,\n    currentBook: state.book.currentBook,\n  };\n};\nconst actionCreator = {\n  handleEditDialog,\n  handleAddDialog,\n  handleDeleteDialog,\n  handleReadingBook,\n  handleActionDialog,\n  handleFetchBooks,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(ActionDialog as any) as any);\n","import React from \"react\";\nimport \"./emptyCover.css\";\n\nconst emptyCover = (props) => (\n  <div className=\"empty-cover\" style={{ transform: `scale(${props.scale})` }}>\n    <div\n      className=\"cover-banner\"\n      style={{\n        backgroundColor:\n          props.format === \"PDF\"\n            ? \"rgba(55, 170, 81, 0.7)\"\n            : props.format === \"TXT\"\n            ? \"rgba(251, 191, 16,1)\"\n            : props.format === \"EPUB\"\n            ? \"rgba(33, 165, 241,1)\"\n            : props.format === \"MOBI\"\n            ? \"rgba(255, 108, 110,1)\"\n            : props.format === \"AZW3\"\n            ? \" #ff9900\"\n            : props.format === \"MD\"\n            ? \"#5e7fff\"\n            : props.format === \"DJVU\"\n            ? \"#109870\"\n            : props.format === \"FB2\"\n            ? \"#0063b1\"\n            : props.format === \"DOCX\" || props.format === \"RTF\"\n            ? \" #6867d1\"\n            : props.format === \"CBT\" ||\n              props.format === \"CBZ\" ||\n              props.format === \"CBR\"\n            ? \"#00b6c2\"\n            : \"rgba(104, 103, 209, 1)\",\n      }}\n    >\n      {props.format || \"BOOK\"}\n    </div>\n    <div\n      className=\"cover-title\"\n      style={{ fontSize: props.scale === 1.15 ? \"13px\" : \"\" }}\n    >\n      {props.title}\n    </div>\n    <div className=\"cover-footer\">Koodo Reader</div>\n  </div>\n);\n\nexport default emptyCover;\n","import React from \"react\";\nimport RecentBooks from \"../../utils/readUtils/recordRecent\";\nimport \"./bookCardItem.css\";\nimport { BookCardProps, BookCardState } from \"./interface\";\nimport AddFavorite from \"../../utils/readUtils/addFavorite\";\nimport ActionDialog from \"../dialogs/actionDialog\";\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\nimport { withRouter } from \"react-router-dom\";\nimport RecordLocation from \"../../utils/readUtils/recordLocation\";\nimport { isElectron } from \"react-device-detect\";\nimport EmptyCover from \"../emptyCover\";\nimport BookUtil from \"../../utils/fileUtils/bookUtil\";\nimport toast from \"react-hot-toast\";\n\ndeclare var window: any;\n\nclass BookCardItem extends React.Component<BookCardProps, BookCardState> {\n  constructor(props: BookCardProps) {\n    super(props);\n    this.state = {\n      isOpenConfig: false,\n      isFavorite:\n        AddFavorite.getAllFavorite().indexOf(this.props.book.key) > -1,\n      left: 0,\n      top: 0,\n      direction: \"horizontal\",\n    };\n  }\n\n  componentDidMount() {\n    let filePath = \"\";\n    //控制是否自动打开本书\n    if (isElectron) {\n      const { ipcRenderer } = window.require(\"electron\");\n      filePath = ipcRenderer.sendSync(\"get-file-data\");\n    }\n\n    if (\n      StorageUtil.getReaderConfig(\"isOpenBook\") === \"yes\" &&\n      RecentBooks.getAllRecent()[0] === this.props.book.key &&\n      !this.props.currentBook.key &&\n      !filePath\n    ) {\n      this.props.handleReadingBook(this.props.book);\n      if (StorageUtil.getReaderConfig(\"isOpenInMain\") === \"yes\") {\n        this.props.history.push(BookUtil.getBookUrl(this.props.book));\n      } else {\n        BookUtil.RedirectBook(this.props.book);\n      }\n    }\n  }\n\n  handleMoreAction = (event: any) => {\n    event.preventDefault();\n    const e = event || window.event;\n    let x = e.clientX;\n    if (x > document.body.clientWidth - 300) {\n      x = x - 180;\n    }\n    this.setState(\n      {\n        left: x,\n        top:\n          document.body.clientHeight - e.clientY > 300\n            ? e.clientY\n            : e.clientY - 300,\n      },\n      () => {\n        this.props.handleActionDialog(true);\n        this.props.handleReadingBook(this.props.book);\n      }\n    );\n  };\n  handleDeleteBook = () => {\n    this.props.handleReadingBook(this.props.book);\n    this.props.handleDeleteDialog(true);\n    this.props.handleActionDialog(false);\n  };\n  handleLoveBook = () => {\n    AddFavorite.setFavorite(this.props.book.key);\n    this.setState({ isFavorite: true });\n    toast.success(this.props.t(\"Add Successfully\"));\n  };\n  handleCancelLoveBook = () => {\n    AddFavorite.clear(this.props.book.key);\n    this.setState({ isFavorite: false });\n    if (Object.keys(AddFavorite.getAllFavorite()).length === 0) {\n      this.props.history.push(\"/manager/empty\");\n      document.title = \"Koodo Reader\";\n    }\n    toast.success(this.props.t(\"Cancel Successfully\"));\n  };\n  //控制按钮的弹出\n  handleConfig = (mode: boolean) => {\n    this.setState({ isOpenConfig: mode });\n  };\n  handleJump = () => {\n    if (this.props.isSelectBook) {\n      this.props.handleSelectedBooks(\n        this.props.isSelected\n          ? this.props.selectedBooks.filter(\n              (item) => item !== this.props.book.key\n            )\n          : [...this.props.selectedBooks, this.props.book.key]\n      );\n      return;\n    }\n    RecentBooks.setRecent(this.props.book.key);\n    this.props.handleReadingBook(this.props.book);\n    if (StorageUtil.getReaderConfig(\"isOpenInMain\") === \"yes\") {\n      this.props.history.push(BookUtil.getBookUrl(this.props.book));\n    } else {\n      BookUtil.RedirectBook(this.props.book);\n    }\n  };\n  render() {\n    let percentage = RecordLocation.getHtmlLocation(this.props.book.key)\n      ? RecordLocation.getHtmlLocation(this.props.book.key).percentage\n      : 0;\n    const actionProps = { left: this.state.left, top: this.state.top };\n\n    return (\n      <>\n        <div\n          className=\"book-list-item\"\n          onMouseOver={() => {\n            this.handleConfig(true);\n          }}\n          onMouseLeave={() => {\n            this.handleConfig(false);\n            this.props.handleActionDialog(false);\n          }}\n          onContextMenu={(event) => {\n            this.handleMoreAction(event);\n          }}\n        >\n          {!this.props.book.cover ||\n          this.props.book.cover === \"noCover\" ||\n          (this.props.book.format === \"PDF\" &&\n            StorageUtil.getReaderConfig(\"isPDFCover\") !== \"yes\") ? (\n            <div\n              className=\"book-item-cover\"\n              onClick={() => {\n                this.handleJump();\n              }}\n              style={{ display: \"block\" }}\n            >\n              <EmptyCover\n                {...{\n                  format: this.props.book.format,\n                  title: this.props.book.name,\n                  scale: 1,\n                }}\n              />\n            </div>\n          ) : (\n            <div\n              className=\"book-item-cover\"\n              onClick={() => {\n                this.handleJump();\n              }}\n            >\n              <img\n                src={this.props.book.cover}\n                alt=\"\"\n                style={\n                  this.state.direction === \"horizontal\"\n                    ? { width: \"100%\" }\n                    : { height: \"100%\" }\n                }\n                onLoad={(res: any) => {\n                  if (\n                    res.target.naturalHeight / res.target.naturalWidth >\n                    137 / 105\n                  ) {\n                    this.setState({ direction: \"horizontal\" });\n                  } else {\n                    this.setState({ direction: \"vertical\" });\n                  }\n                }}\n              />\n            </div>\n          )}\n\n          <p className=\"book-item-title\">{this.props.book.name}</p>\n\n          {this.state.isFavorite && !this.props.isSelectBook ? (\n            <span\n              className=\"icon-love book-loved-icon\"\n              onClick={() => {\n                this.handleCancelLoveBook();\n              }}\n            ></span>\n          ) : null}\n          {this.props.isSelectBook ? (\n            <span\n              className=\"icon-message book-selected-icon\"\n              style={this.props.isSelected ? {} : { color: \"#eee\" }}\n            ></span>\n          ) : null}\n\n          {this.state.isOpenConfig && !this.props.isSelectBook ? (\n            <>\n              {this.props.book.format !== \"PDF\" && (\n                <div className=\"reading-progress-icon\">\n                  <div style={{ position: \"relative\", left: \"4px\" }}>\n                    {percentage\n                      ? Math.floor(percentage * 100) < 10\n                        ? \"0\" + Math.floor(percentage * 100)\n                        : Math.floor(percentage * 100) === 100\n                        ? \"完\"\n                        : Math.floor(percentage * 100)\n                      : \"00\"}\n                    <span className=\"reading-percentage-char\">%</span>\n                  </div>\n                </div>\n              )}\n              <span\n                className=\"icon-more book-more-action\"\n                onClick={(event) => {\n                  this.handleMoreAction(event);\n                }}\n              ></span>\n              <span\n                className=\"icon-love book-love-icon\"\n                onClick={() => {\n                  this.handleLoveBook();\n                }}\n              ></span>\n            </>\n          ) : null}\n        </div>\n\n        {this.props.isOpenActionDialog &&\n        this.props.book.key === this.props.currentBook.key ? (\n          <div className=\"action-dialog-parent\">\n            <ActionDialog {...actionProps} />\n          </div>\n        ) : null}\n      </>\n    );\n  }\n}\nexport default withRouter(BookCardItem as any);\n","import { connect } from \"react-redux\";\nimport {\n  handleActionDialog,\n  handleReadingBook,\n  handleDragItem,\n  handleDeleteDialog,\n  handleSelectedBooks,\n} from \"../../store/actions\";\nimport { withTranslation } from \"react-i18next\";\nimport BookCardItem from \"./component\";\nimport { stateType } from \"../../store\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    isOpenActionDialog: state.book.isOpenActionDialog,\n    dragItem: state.book.dragItem,\n    currentBook: state.book.currentBook,\n    isSelectBook: state.manager.isSelectBook,\n    selectedBooks: state.manager.selectedBooks,\n  };\n};\nconst actionCreator = {\n  handleReadingBook,\n  handleActionDialog,\n  handleDragItem,\n  handleDeleteDialog,\n  handleSelectedBooks,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(BookCardItem as any) as any);\n","import React from \"react\";\nimport \"./bookListItem.css\";\nimport RecordLocation from \"../../utils/readUtils/recordLocation\";\nimport { BookItemProps, BookItemState } from \"./interface\";\nimport { Trans } from \"react-i18next\";\nimport AddFavorite from \"../../utils/readUtils/addFavorite\";\nimport { withRouter } from \"react-router-dom\";\nimport RecentBooks from \"../../utils/readUtils/recordRecent\";\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\nimport AddTrash from \"../../utils/readUtils/addTrash\";\nimport EmptyCover from \"../emptyCover\";\nimport BookUtil from \"../../utils/fileUtils/bookUtil\";\nimport FileSaver from \"file-saver\";\nimport { isElectron } from \"react-device-detect\";\nimport toast from \"react-hot-toast\";\nclass BookListItem extends React.Component<BookItemProps, BookItemState> {\n  constructor(props: BookItemProps) {\n    super(props);\n    this.state = {\n      isDeleteDialog: false,\n      isFavorite:\n        AddFavorite.getAllFavorite().indexOf(this.props.book.key) > -1,\n      direction: \"horizontal\",\n    };\n  }\n  componentDidMount() {\n    let filePath = \"\";\n    //控制是否自动打开本书\n    if (isElectron) {\n      const { ipcRenderer } = window.require(\"electron\");\n      filePath = ipcRenderer.sendSync(\"get-file-data\");\n    }\n    if (\n      StorageUtil.getReaderConfig(\"isOpenBook\") === \"yes\" &&\n      RecentBooks.getAllRecent()[0] === this.props.book.key &&\n      !this.props.currentBook.key &&\n      !filePath\n    ) {\n      this.props.handleReadingBook(this.props.book);\n      if (StorageUtil.getReaderConfig(\"isOpenInMain\") === \"yes\") {\n        this.props.history.push(BookUtil.getBookUrl(this.props.book));\n      } else {\n        BookUtil.RedirectBook(this.props.book);\n      }\n    }\n  }\n\n  handleDeleteBook = () => {\n    this.props.handleDeleteDialog(true);\n    this.props.handleReadingBook(this.props.book);\n  };\n  handleEditBook = () => {\n    this.props.handleEditDialog(true);\n    this.props.handleReadingBook(this.props.book);\n  };\n  handleAddShelf = () => {\n    this.props.handleAddDialog(true);\n    this.props.handleReadingBook(this.props.book);\n  };\n  handleLoveBook = () => {\n    AddFavorite.setFavorite(this.props.book.key);\n    this.setState({ isFavorite: true });\n    toast.success(this.props.t(\"Add Successfully\"));\n  };\n  handleCancelLoveBook = () => {\n    AddFavorite.clear(this.props.book.key);\n    this.setState({ isFavorite: false });\n    toast.success(this.props.t(\"Cancel Successfully\"));\n  };\n  handleRestoreBook = () => {\n    AddTrash.clear(this.props.book.key);\n    toast.success(this.props.t(\"Restore Successfully\"));\n    this.props.handleFetchBooks();\n  };\n  handleJump = () => {\n    if (this.props.isSelectBook) {\n      this.props.handleSelectedBooks(\n        this.props.isSelected\n          ? this.props.selectedBooks.filter(\n              (item) => item !== this.props.book.key\n            )\n          : [...this.props.selectedBooks, this.props.book.key]\n      );\n      return;\n    }\n    RecentBooks.setRecent(this.props.book.key);\n    this.props.handleReadingBook(this.props.book);\n    if (StorageUtil.getReaderConfig(\"isOpenInMain\") === \"yes\") {\n      this.props.history.push(BookUtil.getBookUrl(this.props.book));\n    } else {\n      BookUtil.RedirectBook(this.props.book);\n    }\n  };\n  handleExportBook() {\n    BookUtil.fetchBook(this.props.book.key, true, this.props.book.path).then(\n      (result: any) => {\n        console.log('export');\n        window.export_book(result);\n        // toast.success(this.props.t(\"Export Successfully\"));\n        // FileSaver.saveAs(\n        //   new Blob([result]),\n        //   this.props.book.name +\n        //     `.${this.props.book.format.toLocaleLowerCase()}`\n        // );\n      }\n    );\n  }\n  render() {\n    let percentage = RecordLocation.getHtmlLocation(this.props.book.key)\n      ? RecordLocation.getHtmlLocation(this.props.book.key).percentage\n      : 0;\n\n    return (\n      <div className=\"book-list-item-container\">\n        {!this.props.book.cover ||\n        this.props.book.cover === \"noCover\" ||\n        (this.props.book.format === \"PDF\" &&\n          StorageUtil.getReaderConfig(\"isPDFCover\") !== \"yes\") ? (\n          <div\n            className=\"book-item-list-cover\"\n            onClick={() => {\n              this.handleJump();\n            }}\n            style={{ display: \"block\" }}\n          >\n            <EmptyCover\n              {...{\n                format: this.props.book.format,\n                title: this.props.book.name,\n                scale: 0.54,\n              }}\n            />\n          </div>\n        ) : (\n          <div\n            className=\"book-item-list-cover\"\n            onClick={() => {\n              this.handleJump();\n            }}\n          >\n            <img\n              src={this.props.book.cover}\n              alt=\"\"\n              style={\n                this.state.direction === \"horizontal\"\n                  ? { width: \"100%\" }\n                  : { height: \"100%\" }\n              }\n              onLoad={(res: any) => {\n                if (\n                  res.target.naturalHeight / res.target.naturalWidth >\n                  74 / 57\n                ) {\n                  this.setState({ direction: \"horizontal\" });\n                } else {\n                  this.setState({ direction: \"vertical\" });\n                }\n              }}\n            />\n          </div>\n        )}\n        {this.props.isSelectBook ? (\n          <span\n            className=\"icon-message book-selected-icon\"\n            style={\n              this.props.isSelected\n                ? { left: \"35px\", bottom: \"5px\" }\n                : { left: \"35px\", bottom: \"5px\", color: \"#eee\" }\n            }\n          ></span>\n        ) : null}\n        <p\n          className=\"book-item-list-title\"\n          onClick={() => {\n            this.handleJump();\n          }}\n        >\n          <span className=\"book-item-list-subtitle\">\n            {this.props.book.name}\n          </span>\n        </p>\n\n        <p className=\"book-item-list-author\">\n          <span className=\"book-item-list-subtitle\">\n            <Trans>\n              {this.props.book.author\n                ? this.props.book.author\n                : \"Unknown Author\"}\n            </Trans>\n          </span>\n        </p>\n        <p className=\"book-item-list-percentage\">\n          {percentage ? Math.round(percentage * 100) : 0}%\n        </p>\n        {this.props.mode === \"trash\" ? (\n          <div className=\"book-item-list-config\">\n            <span\n              className=\"icon-clockwise list-icon\"\n              onClick={() => {\n                this.handleRestoreBook();\n              }}\n            ></span>\n          </div>\n        ) : (\n          <div className=\"book-item-list-config\">\n            {this.state.isFavorite ? (\n              <span\n                className=\"icon-love list-icon\"\n                onClick={() => {\n                  this.handleCancelLoveBook();\n                }}\n                style={{ color: \"#f87356\" }}\n              ></span>\n            ) : (\n              <span\n                className=\"icon-love list-icon\"\n                onClick={() => {\n                  this.handleLoveBook();\n                }}\n              ></span>\n            )}\n\n            <span\n              className=\"icon-shelf list-icon\"\n              onClick={() => {\n                this.handleAddShelf();\n              }}\n            ></span>\n            <span\n              className=\"icon-trash list-icon\"\n              onClick={() => {\n                this.handleDeleteBook();\n              }}\n            ></span>\n            <span\n              className=\"icon-edit list-icon\"\n              onClick={() => {\n                this.handleEditBook();\n              }}\n            ></span>\n            <span\n              className=\"icon-export list-icon\"\n              onClick={() => {\n                this.handleExportBook();\n              }}\n            ></span>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default withRouter(BookListItem as any);\n","import { connect } from \"react-redux\";\nimport {\n  handleEditDialog,\n  handleDeleteDialog,\n  handleAddDialog,\n  handleReadingBook,\n  handleDragItem,\n  handleFetchBooks,\n  handleSelectedBooks,\n} from \"../../store/actions\";\nimport { withTranslation } from \"react-i18next\";\n\nimport { stateType } from \"../../store\";\nimport BookListItem from \"./component\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    isReading: state.book.isReading,\n    percentage: state.progressPanel.percentage,\n    currentBook: state.book.currentBook,\n    dragItem: state.book.dragItem,\n    mode: state.sidebar.mode,\n    isSelectBook: state.manager.isSelectBook,\n    selectedBooks: state.manager.selectedBooks,\n  };\n};\nconst actionCreator = {\n  handleReadingBook,\n  handleEditDialog,\n  handleDeleteDialog,\n  handleAddDialog,\n  handleDragItem,\n  handleFetchBooks,\n  handleSelectedBooks,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(BookListItem as any) as any);\n","import React from \"react\";\nimport RecentBooks from \"../../utils/readUtils/recordRecent\";\nimport \"./bookCoverItem.css\";\nimport { BookCoverProps, BookCoverState } from \"./interface\";\nimport AddFavorite from \"../../utils/readUtils/addFavorite\";\nimport ActionDialog from \"../dialogs/actionDialog\";\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\nimport { withRouter } from \"react-router-dom\";\nimport RecordLocation from \"../../utils/readUtils/recordLocation\";\nimport { isElectron } from \"react-device-detect\";\nimport EmptyCover from \"../emptyCover\";\nimport Parser from \"html-react-parser\";\nimport { Trans } from \"react-i18next\";\nimport BookUtil from \"../../utils/fileUtils/bookUtil\";\nimport toast from \"react-hot-toast\";\ndeclare var window: any;\n\nclass BookCoverItem extends React.Component<BookCoverProps, BookCoverState> {\n  constructor(props: BookCoverProps) {\n    super(props);\n    this.state = {\n      isOpenConfig: false,\n      isFavorite:\n        AddFavorite.getAllFavorite().indexOf(this.props.book.key) > -1,\n      left: 0,\n      top: 0,\n      direction: \"horizontal\",\n    };\n  }\n\n  componentDidMount() {\n    let filePath = \"\";\n    //控制是否自动打开本书\n    if (isElectron) {\n      const { ipcRenderer } = window.require(\"electron\");\n      filePath = ipcRenderer.sendSync(\"get-file-data\");\n    }\n\n    if (\n      StorageUtil.getReaderConfig(\"isOpenBook\") === \"yes\" &&\n      RecentBooks.getAllRecent()[0] === this.props.book.key &&\n      !this.props.currentBook.key &&\n      !filePath\n    ) {\n      this.props.handleReadingBook(this.props.book);\n      if (StorageUtil.getReaderConfig(\"isOpenInMain\") === \"yes\") {\n        this.props.history.push(BookUtil.getBookUrl(this.props.book));\n      } else {\n        BookUtil.RedirectBook(this.props.book);\n      }\n    }\n  }\n\n  handleMoreAction = (event: any) => {\n    event.preventDefault();\n    const e = event || window.event;\n    let x = e.clientX;\n    if (x > document.body.clientWidth - 300 && !this.props.isCollapsed) {\n      x = x - 180;\n    }\n    this.setState(\n      {\n        left: x,\n        top:\n          document.body.clientHeight - e.clientY > 300\n            ? e.clientY\n            : e.clientY - 300,\n      },\n      () => {\n        this.props.handleActionDialog(true);\n        this.props.handleReadingBook(this.props.book);\n      }\n    );\n  };\n  handleDeleteBook = () => {\n    this.props.handleReadingBook(this.props.book);\n    this.props.handleDeleteDialog(true);\n    this.props.handleActionDialog(false);\n  };\n  handleLoveBook = () => {\n    AddFavorite.setFavorite(this.props.book.key);\n    this.setState({ isFavorite: true });\n    toast.success(this.props.t(\"Add Successfully\"));\n  };\n  handleCancelLoveBook = () => {\n    AddFavorite.clear(this.props.book.key);\n    this.setState({ isFavorite: false });\n    toast.success(this.props.t(\"Cancel Successfully\"));\n  };\n  //控制按钮的弹出\n  handleConfig = (mode: boolean) => {\n    this.setState({ isOpenConfig: mode });\n  };\n  handleJump = () => {\n    if (this.props.isSelectBook) {\n      this.props.handleSelectedBooks(\n        this.props.isSelected\n          ? this.props.selectedBooks.filter(\n              (item) => item !== this.props.book.key\n            )\n          : [...this.props.selectedBooks, this.props.book.key]\n      );\n      return;\n    }\n    RecentBooks.setRecent(this.props.book.key);\n    this.props.handleReadingBook(this.props.book);\n    if (StorageUtil.getReaderConfig(\"isOpenInMain\") === \"yes\") {\n      this.props.history.push(BookUtil.getBookUrl(this.props.book));\n    } else {\n      BookUtil.RedirectBook(this.props.book);\n    }\n  };\n  render() {\n    let percentage = RecordLocation.getHtmlLocation(this.props.book.key)\n      ? RecordLocation.getHtmlLocation(this.props.book.key).percentage\n      : 0;\n    const actionProps = { left: this.state.left, top: this.state.top };\n    return (\n      <>\n        <div\n          className=\"book-list-cover-item\"\n          onMouseOver={() => {\n            this.handleConfig(true);\n          }}\n          onMouseLeave={() => {\n            this.handleConfig(false);\n            this.props.handleActionDialog(false);\n          }}\n          onContextMenu={(event) => {\n            this.handleMoreAction(event);\n          }}\n        >\n          {!this.props.book.cover ||\n          this.props.book.cover === \"noCover\" ||\n          (this.props.book.format === \"PDF\" &&\n            StorageUtil.getReaderConfig(\"isPDFCover\") !== \"yes\") ? (\n            <div\n              className=\"book-cover-item-cover\"\n              onClick={() => {\n                this.handleJump();\n              }}\n              style={{ display: \"block\" }}\n            >\n              <EmptyCover\n                {...{\n                  format: this.props.book.format,\n                  title: this.props.book.name,\n                  scale: 1.15,\n                }}\n              />\n            </div>\n          ) : (\n            <div\n              className=\"book-cover-item-cover\"\n              onClick={() => {\n                this.handleJump();\n              }}\n            >\n              <img\n                src={this.props.book.cover}\n                alt=\"\"\n                style={\n                  this.state.direction === \"horizontal\"\n                    ? { width: \"100%\" }\n                    : { height: \"100%\" }\n                }\n                onLoad={(res: any) => {\n                  if (\n                    res.target.naturalHeight / res.target.naturalWidth >\n                    170 / 120\n                  ) {\n                    this.setState({ direction: \"horizontal\" });\n                  } else {\n                    this.setState({ direction: \"vertical\" });\n                  }\n                }}\n              />\n            </div>\n          )}\n\n          <p className=\"book-cover-item-title\">{this.props.book.name}</p>\n          <p className=\"book-cover-item-author\">\n            <Trans>Author</Trans>:&nbsp;\n            <Trans>{this.props.book.author}</Trans>\n          </p>\n          <p className=\"book-cover-item-author\">\n            <Trans>Publisher</Trans>:&nbsp;\n            <Trans>{this.props.book.publisher}</Trans>\n          </p>\n          <div className=\"book-cover-item-desc\">\n            <Trans>Description</Trans>:&nbsp;\n            {this.props.book.description ? (\n              Parser(this.props.book.description)\n            ) : (\n              <Trans>Empty</Trans>\n            )}\n          </div>\n          {this.props.isSelectBook ? (\n            <span\n              className=\"icon-message book-selected-icon\"\n              style={\n                this.props.isSelected\n                  ? { right: \"274px\", bottom: \"25px\" }\n                  : { right: \"274px\", bottom: \"25px\", color: \"#eee\" }\n              }\n            ></span>\n          ) : null}\n          {this.state.isOpenConfig && !this.props.isSelectBook ? (\n            <>\n              {this.props.book.format !== \"PDF\" && (\n                <div\n                  className=\"reading-progress-icon\"\n                  style={{ right: \"270px\" }}\n                >\n                  <div style={{ position: \"relative\", left: \"4px\" }}>\n                    {percentage\n                      ? Math.floor(percentage * 100) < 10\n                        ? \"0\" + Math.floor(percentage * 100)\n                        : Math.floor(percentage * 100) === 100\n                        ? \"完\"\n                        : Math.floor(percentage * 100)\n                      : \"00\"}\n                    <span className=\"reading-percentage-char\">%</span>\n                  </div>\n                </div>\n              )}\n              <span\n                className=\"icon-more book-more-action\"\n                onClick={(event) => {\n                  this.handleMoreAction(event);\n                }}\n                style={{ right: \"270px\" }}\n              ></span>\n              <span\n                className=\"icon-love book-love-icon\"\n                onClick={() => {\n                  this.handleLoveBook();\n                }}\n                style={{ right: \"275px\", bottom: \"25px\" }}\n              ></span>\n            </>\n          ) : null}\n        </div>\n        {this.props.isOpenActionDialog &&\n        this.props.book.key === this.props.currentBook.key ? (\n          <ActionDialog {...actionProps} />\n        ) : null}\n      </>\n    );\n  }\n}\nexport default withRouter(BookCoverItem as any);\n","import { connect } from \"react-redux\";\nimport {\n  handleActionDialog,\n  handleReadingBook,\n  handleDragItem,\n  handleDeleteDialog,\n  handleSelectedBooks,\n} from \"../../store/actions\";\nimport BookCoverItem from \"./component\";\nimport { stateType } from \"../../store\";\nimport { withTranslation } from \"react-i18next\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    isOpenActionDialog: state.book.isOpenActionDialog,\n    isCollapsed: state.sidebar.isCollapsed,\n    dragItem: state.book.dragItem,\n    currentBook: state.book.currentBook,\n    isSelectBook: state.manager.isSelectBook,\n    selectedBooks: state.manager.selectedBooks,\n  };\n};\nconst actionCreator = {\n  handleReadingBook,\n  handleActionDialog,\n  handleDragItem,\n  handleDeleteDialog,\n  handleSelectedBooks,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(BookCoverItem as any) as any);\n","/**\n * EPUB (.epub)\nScanned document (.pdf, .djvu)\nDRM-free Mobipocket (.mobi) and Kindle (.azw3)\nPlain text (.txt)\nFictionBook (.fb2)\nComic book archive (.cbr, .cbz, .cbt)\nRich text (.md, .docx, .rtf)\nHyper Text (.html, .xml, .xhtml, .htm)\n */\nexport const emptyList = [\n  {\n    mode: \"home\",\n    main: \"Empty Library\",\n    sub: \"Click the import button to add books\",\n    subsub: \".epub, .pdf, .djvu, .mobi, .azw3, .docx, .rtf, .html, .md, .fb2, .cbr, .cbz, etc.\"\n  },\n  {\n    mode: \"favorite\",\n    main: \"No Favorite Books\",\n    sub: \"Move your mouse on the top of any book, click the heart icon to add it to your favorite books\",\n  },\n  {\n    mode: \"bookmark\",\n    main: \"Empty Bookmark\",\n    sub: \"Move your mouse on the top edge of the reader\",\n  },\n  {\n    mode: \"note\",\n    main: \"Empty Note\",\n    sub: \"Select any text and click the Note button on the popup menu\",\n  },\n  {\n    mode: \"digest\",\n    main: \"Empty Highlight\",\n    sub: \"Select any text and click the Highlight button on the popup menu\",\n  },\n  {\n    mode: \"shelf\",\n    main: \"Empty Shelf\",\n    sub: \"Move your mouse on top of any book, then click the more icon to add the book to the shelf\",\n  },\n\n  {\n    mode: \"trash\",\n    main: \"Empty Recycle Bin\",\n    sub: \"The deleted books will show up here\",\n  },\n];\n","import React from \"react\";\nimport \"./emptyPage.css\";\nimport { emptyList } from \"../../constants/emptyList\";\nimport { Trans } from \"react-i18next\";\nimport { EmptyPageProps, EmptyPageState } from \"./interface\";\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\n\nclass EmptyPage extends React.Component<EmptyPageProps, EmptyPageState> {\n  render() {\n    const renderEmptyList = () => {\n      return emptyList.map((item) => {\n        let subsub;\n        if(item.subsub != null){\n          subsub = <div className=\"empty-page-info-subsub\">{item.subsub}</div>\n        }\n        return (\n          <div\n            className=\"empty-page-info-container\"\n            key={item.mode}\n            style={\n              this.props.mode === item.mode ? {} : { visibility: \"hidden\" }\n            }\n          >\n            <div className=\"empty-page-info-main\">\n              <Trans>{item.main}</Trans>\n            </div>\n            <div className=\"empty-page-info-sub\">\n              <Trans>{item.sub}</Trans>\n            </div>\n            {subsub}\n          </div>\n        );\n      });\n    };\n    return (\n      <div\n        className=\"empty-page-container\"\n        style={\n          this.props.isCollapsed\n            ? { width: \"calc(100vw - 100px)\", left: \"100px\" }\n            : {}\n        }\n      >\n        <div\n          className=\"empty-illustration-container\"\n          style={{ width: \"calc(100% - 50px)\" }}\n        >\n          <img\n            src={\n              StorageUtil.getReaderConfig(\"appSkin\") === \"night\" ||\n              (StorageUtil.getReaderConfig(\"appSkin\") === \"system\" &&\n                StorageUtil.getReaderConfig(\"isOSNight\") === \"yes\")\n                ? \"./assets/empty_light.svg\"\n                : \"./assets/empty.svg\"\n            }\n            alt=\"\"\n            className=\"empty-page-illustration\"\n          />\n        </div>\n\n        {renderEmptyList()}\n      </div>\n    );\n  }\n}\n\nexport default EmptyPage;\n","import { connect } from \"react-redux\";\nimport { stateType } from \"../../store\";\nimport EmptyPage from \"./component\";\nimport { withTranslation } from \"react-i18next\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    mode: state.sidebar.mode,\n    isCollapsed: state.sidebar.isCollapsed,\n  };\n};\nconst actionCreator = {};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(EmptyPage as any));\n","export const viewMode = [\n  {\n    name: \"Card\",\n    icon: \"grid\",\n    mode: \"card\",\n  },\n  {\n    name: \"List\",\n    icon: \"menu\",\n    mode: \"list\",\n  },\n\n  {\n    name: \"Cover\",\n    icon: \"cover\",\n    mode: \"cover\",\n  },\n];\n","import React from \"react\";\nimport \"./viewMode.css\";\nimport { ViewModeProps, ViewModeState } from \"./interface\";\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\nimport { Tooltip } from \"react-tippy\";\nimport { viewMode } from \"../../constants/viewMode\";\n\nclass ViewMode extends React.Component<ViewModeProps, ViewModeState> {\n  constructor(props: ViewModeProps) {\n    super(props);\n    this.state = {};\n  }\n  handleChange = (mode: string) => {\n    StorageUtil.setReaderConfig(\"viewMode\", mode);\n    this.props.handleFetchList();\n  };\n  render() {\n    return (\n      <div className=\"book-list-view\">\n        {viewMode.map((item) => (\n          <Tooltip\n            key={item.name}\n            title={this.props.t(item.name)}\n            position=\"top\"\n            trigger=\"mouseenter\"\n          >\n            <div\n              className=\"card-list-mode\"\n              onClick={() => {\n                this.handleChange(item.mode);\n              }}\n              style={this.props.viewMode !== item.mode ? { opacity: 0.5 } : {}}\n            >\n              <span className={`icon-${item.icon}`}></span>\n            </div>\n          </Tooltip>\n        ))}\n      </div>\n    );\n  }\n}\n\nexport default ViewMode;\n","import { connect } from \"react-redux\";\nimport { stateType } from \"../../store\";\nimport { withTranslation } from \"react-i18next\";\nimport ViewMode from \"./component\";\nimport { handleFetchList } from \"../../store/actions\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    viewMode: state.manager.viewMode,\n  };\n};\nconst actionCreator = { handleFetchList };\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(ViewMode as any));\n","import React from \"react\";\nimport AddFavorite from \"../../utils/readUtils/addFavorite\";\nimport BookModel from \"../../model/Book\";\nimport { Trans } from \"react-i18next\";\nimport { BookListProps, BookListState } from \"./interface\";\nimport localforage from \"localforage\";\nimport { withRouter } from \"react-router-dom\";\nimport FileSaver from \"file-saver\";\nimport toast from \"react-hot-toast\";\nclass SelectBook extends React.Component<BookListProps, BookListState> {\n  constructor(props: BookListProps) {\n    super(props);\n    this.state = {\n      isOpenDelete: false,\n      favoriteBooks: Object.keys(AddFavorite.getAllFavorite()).length,\n    };\n  }\n\n  render() {\n    return (\n      <div\n        className=\"booklist-manage-container\"\n        style={this.props.isCollapsed ? { left: \"75px\" } : {}}\n      >\n        <span\n          onClick={() => {\n            this.props.handleSelectBook(!this.props.isSelectBook);\n            if (this.props.isSelectBook) {\n              this.props.handleSelectedBooks([]);\n            }\n          }}\n          className=\"book-manage-title\"\n        >\n          <Trans>{this.props.isSelectBook ? \"Cancel\" : \"Select\"}</Trans>\n        </span>\n        {this.props.isSelectBook && (\n          <>\n            <span\n              className=\"book-manage-title\"\n              onClick={() => {\n                this.props.handleAddDialog(true);\n              }}\n            >\n              <Trans>Add to Shelf</Trans>\n            </span>\n            <span\n              className=\"book-manage-title\"\n              onClick={() => {\n                this.props.handleDeleteDialog(true);\n              }}\n            >\n              <Trans>Delete</Trans>\n            </span>\n            <span\n              className=\"book-manage-title\"\n              onClick={() => {\n                this.props.books\n                  .filter(\n                    (item: BookModel) =>\n                      this.props.selectedBooks.indexOf(item.key) > -1\n                  )\n                  .forEach(async (item: BookModel) => {\n                    let result: any = await localforage.getItem(item.key);\n\n                    FileSaver.saveAs(\n                      new Blob([result]),\n                      item.name + `.${item.format.toLocaleLowerCase()}`\n                    );\n                  });\n                this.props.handleSelectBook(!this.props.isSelectBook);\n                if (this.props.isSelectBook) {\n                  this.props.handleSelectedBooks([]);\n                }\n                toast.success(this.props.t(\"Export Successfully\"));\n              }}\n            >\n              <Trans>Export</Trans>\n            </span>\n            <span\n              className=\"book-manage-title\"\n              onClick={() => {\n                if (\n                  this.props.selectedBooks.length === this.props.books.length\n                ) {\n                  this.props.handleSelectedBooks([]);\n                } else {\n                  this.props.handleSelectedBooks(\n                    this.props.books.map((item) => item.key)\n                  );\n                }\n              }}\n            >\n              {this.props.selectedBooks.length === this.props.books.length ? (\n                <Trans>Deselect All</Trans>\n              ) : (\n                <Trans>Select All</Trans>\n              )}\n            </span>{\" \"}\n          </>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default withRouter(SelectBook);\n","import { connect } from \"react-redux\";\nimport {\n  handleDeleteDialog,\n  handleSelectBook,\n  handleAddDialog,\n  handleSelectedBooks,\n} from \"../../store/actions\";\nimport { stateType } from \"../../store\";\nimport { withTranslation } from \"react-i18next\";\nimport SelectBook from \"./component\";\n\nconst mappropsToProps = (state: stateType) => {\n  return {\n    books: state.manager.books,\n    selectedBooks: state.manager.selectedBooks,\n    isCollapsed: state.sidebar.isCollapsed,\n    isSelectBook: state.manager.isSelectBook,\n  };\n};\nconst actionCreator = {\n  handleDeleteDialog,\n  handleSelectBook,\n  handleAddDialog,\n  handleSelectedBooks,\n};\nexport default connect(\n  mappropsToProps,\n  actionCreator\n)(withTranslation()(SelectBook as any));\n","import React from \"react\";\nimport ShelfUtil from \"../../utils/readUtils/shelfUtil\";\nimport { Trans } from \"react-i18next\";\nimport { ShelfChooserProps, ShelfChooserState } from \"./interface\";\nimport localforage from \"localforage\";\nimport DeletePopup from \"../dialogs/deletePopup\";\nimport { withRouter } from \"react-router-dom\";\nimport { backup } from \"../../utils/syncUtils/backupUtil\";\nimport { isElectron } from \"react-device-detect\";\nclass ShelfChooser extends React.Component<\n  ShelfChooserProps,\n  ShelfChooserState\n> {\n  constructor(props: ShelfChooserProps) {\n    super(props);\n    this.state = {\n      shelfIndex: 0,\n      isOpenDelete: false,\n    };\n  }\n\n  //切换书架\n  handleShelfItem = (event: any) => {\n    let index = event.target.value.split(\",\")[1];\n    this.setState({ shelfIndex: index });\n    this.props.handleShelfIndex(index);\n    if (index > 0) {\n      this.props.handleMode(\"shelf\");\n    } else {\n      this.props.handleMode(\"home\");\n    }\n  };\n  handleDeleteShelf = () => {\n    if (this.state.shelfIndex < 1) return;\n    let shelfTitles = Object.keys(ShelfUtil.getShelf());\n    //获取当前书架名\n    let currentShelfTitle = shelfTitles[this.state.shelfIndex];\n    ShelfUtil.removeShelf(currentShelfTitle);\n    this.setState({ shelfIndex: 0 }, () => {\n      this.props.handleShelfIndex(0);\n      this.props.handleMode(\"shelf\");\n    });\n  };\n  renderShelfList = () => {\n    let shelfList = ShelfUtil.getShelf();\n    let shelfTitle = Object.keys(shelfList);\n\n    return shelfTitle.map((item, index) => {\n      return (\n        <option\n          value={[item, index.toString()]}\n          key={index}\n          className=\"add-dialog-shelf-list-option\"\n          selected={this.props.shelfIndex === index ? true : false}\n        >\n          {this.props.t(item === \"New\" ? \"Books\" : item)}\n        </option>\n      );\n    });\n  };\n  handleDeletePopup = (isOpenDelete: boolean) => {\n    this.setState({ isOpenDelete });\n  };\n  render() {\n    if (isElectron) {\n      //兼容之前的版本\n      localforage.getItem(this.props.books[0].key).then((result) => {\n        if (result) {\n          backup(\n            this.props.books,\n            this.props.notes,\n            this.props.bookmarks,\n            false\n          );\n        }\n      });\n    }\n    const deletePopupProps = {\n      mode: \"shelf\",\n      name: Object.keys(ShelfUtil.getShelf())[this.state.shelfIndex],\n      title: \"Delete this shelf\",\n      description: \"This action will clear and remove this shelf\",\n      handleDeletePopup: this.handleDeletePopup,\n      handleDeleteOpearion: this.handleDeleteShelf,\n    };\n\n    return (\n      <>\n        {this.state.isOpenDelete && <DeletePopup {...deletePopupProps} />}\n        <div\n          className=\"booklist-shelf-container\"\n          style={this.props.isCollapsed ? {} : { left: \"calc(50% - 60px)\" }}\n        >\n          <p className=\"general-setting-title\" style={{ display: \"inline\" }}>\n            <Trans>Shelf</Trans>\n          </p>\n          <select\n            className=\"booklist-shelf-list\"\n            onChange={(event: React.ChangeEvent<HTMLSelectElement>) => {\n              this.handleShelfItem(event);\n            }}\n          >\n            {this.renderShelfList()}\n          </select>\n          {this.state.shelfIndex > 0 ? (\n            <span\n              className=\"icon-trash delete-shelf-icon\"\n              onClick={() => {\n                this.handleDeletePopup(true);\n              }}\n            ></span>\n          ) : null}\n        </div>\n      </>\n    );\n  }\n}\n\nexport default withRouter(ShelfChooser);\n","import { connect } from \"react-redux\";\nimport {\n  handleFetchList,\n  handleFetchBooks,\n  handleMode,\n  handleShelfIndex,\n  handleDeleteDialog,\n} from \"../../store/actions\";\nimport { stateType } from \"../../store\";\nimport { withTranslation } from \"react-i18next\";\nimport ShelfChooser from \"./component\";\n\nconst mappropsToProps = (state: stateType) => {\n  return {\n    books: state.manager.books,\n    mode: state.sidebar.mode,\n    bookmarks: state.reader.bookmarks,\n    notes: state.reader.notes,\n    selectedBooks: state.manager.selectedBooks,\n    shelfIndex: state.sidebar.shelfIndex,\n    isCollapsed: state.sidebar.isCollapsed,\n    searchResults: state.manager.searchResults,\n    isSearch: state.manager.isSearch,\n    isSelectBook: state.manager.isSelectBook,\n    isBookSort: state.manager.isBookSort,\n    viewMode: state.manager.viewMode,\n    bookSortCode: state.manager.bookSortCode,\n    noteSortCode: state.manager.noteSortCode,\n  };\n};\nconst actionCreator = {\n  handleFetchList,\n  handleMode,\n  handleShelfIndex,\n  handleDeleteDialog,\n  handleFetchBooks,\n};\nexport default connect(\n  mappropsToProps,\n  actionCreator\n)(withTranslation()(ShelfChooser));\n","import React from \"react\";\nimport \"./booklist.css\";\nimport BookCardItem from \"../../../components/bookCardItem\";\nimport BookListItem from \"../../../components/bookListItem\";\nimport BookCoverItem from \"../../../components/bookCoverItem\";\nimport AddFavorite from \"../../../utils/readUtils/addFavorite\";\nimport ShelfUtil from \"../../../utils/readUtils/shelfUtil\";\nimport SortUtil from \"../../../utils/readUtils/sortUtil\";\nimport BookModel from \"../../../model/Book\";\nimport { BookListProps, BookListState } from \"./interface\";\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\nimport localforage from \"localforage\";\nimport Empty from \"../../emptyPage\";\nimport { Redirect, withRouter } from \"react-router-dom\";\nimport ViewMode from \"../../../components/viewMode\";\nimport { backup } from \"../../../utils/syncUtils/backupUtil\";\nimport { isElectron } from \"react-device-detect\";\nimport SelectBook from \"../../../components/selectBook\";\nimport ShelfSelector from \"../../../components/shelfSelector\";\nclass BookList extends React.Component<BookListProps, BookListState> {\n  constructor(props: BookListProps) {\n    super(props);\n    this.state = {\n      favoriteBooks: Object.keys(AddFavorite.getAllFavorite()).length,\n    };\n  }\n  UNSAFE_componentWillMount() {\n    if (this.props.mode === \"trash\") {\n      this.props.handleFetchBooks(true);\n    } else {\n      this.props.handleFetchBooks(false);\n    }\n  }\n  componentDidMount() {\n    if (!this.props.books || !this.props.books[0]) {\n      return <Redirect to=\"manager/empty\" />;\n    }\n  }\n\n  handleKeyFilter = (items: any[], arr: string[]) => {\n    let itemArr: any[] = [];\n    arr.forEach((item) => {\n      items.forEach((subItem: any) => {\n        if (subItem.key === item) {\n          itemArr.push(subItem);\n        }\n      });\n    });\n    return itemArr;\n  };\n\n  //获取书架数据\n  handleShelf(items: any, index: number) {\n    //获取书架名\n    if (index < 1) return items;\n    let shelfTitle = Object.keys(ShelfUtil.getShelf());\n    //获取当前书架名\n    let currentShelfTitle = shelfTitle[index];\n    if (!currentShelfTitle) return items;\n    //获取当前书架的图书列表\n    let currentShelfList = ShelfUtil.getShelf()[currentShelfTitle];\n    //根据图书列表获取到图书数据\n    let shelfItems = items.filter((item: { key: number }) => {\n      return currentShelfList.indexOf(item.key) > -1;\n    });\n    return shelfItems;\n  }\n\n  //根据搜索图书index获取到搜索出的图书\n  handleIndexFilter = (items: any, arr: number[]) => {\n    let itemArr: any[] = [];\n    arr.forEach((item) => {\n      items[item] && itemArr.push(items[item]);\n    });\n    return itemArr;\n  };\n  renderBookList = () => {\n    //根据不同的场景获取不同的图书数据\n\n    let books = this.props.isSearch //搜索图书\n      ? this.handleIndexFilter(this.props.books, this.props.searchResults)\n      : this.props.shelfIndex > 0 //展示书架\n      ? this.handleIndexFilter(\n          this.handleShelf(this.props.books, this.props.shelfIndex),\n          //返回排序后的图书index\n          SortUtil.sortBooks(this.props.books, this.props.bookSortCode) || []\n        )\n      : this.props.mode === \"favorite\"\n      ? this.handleIndexFilter(\n          this.handleKeyFilter(this.props.books, AddFavorite.getAllFavorite()),\n          //返回排序后的图书index\n          SortUtil.sortBooks(this.props.books, this.props.bookSortCode) || []\n        )\n      : this.handleIndexFilter(\n          this.props.books,\n          //返回排序后的图书index\n          SortUtil.sortBooks(this.props.books, this.props.bookSortCode) || []\n        );\n\n    if (this.props.mode === \"shelf\" && books.length === 0) {\n      return (\n        <div\n          style={{\n            position: \"fixed\",\n            left: 0,\n            top: 0,\n            width: \"100%\",\n            height: \"100%\",\n            zIndex: -1,\n          }}\n        >\n          <Empty />\n        </div>\n      );\n    }\n    return books.map((item: BookModel, index: number) => {\n      return this.props.viewMode === \"list\" ? (\n        <BookListItem\n          {...{\n            key: index,\n            book: item,\n            isSelected: this.props.selectedBooks.indexOf(item.key) > -1,\n          }}\n        />\n      ) : this.props.viewMode === \"card\" ? (\n        <BookCardItem\n          {...{\n            key: index,\n            book: item,\n            isSelected: this.props.selectedBooks.indexOf(item.key) > -1,\n          }}\n        />\n      ) : (\n        <BookCoverItem\n          {...{\n            key: index,\n            book: item,\n            isSelected: this.props.selectedBooks.indexOf(item.key) > -1,\n          }}\n        />\n      );\n    });\n  };\n\n  render() {\n    if (\n      (this.state.favoriteBooks === 0 && this.props.mode === \"favorite\") ||\n      !this.props.books ||\n      !this.props.books[0]\n    ) {\n      return <Redirect to=\"/manager/empty\" />;\n    }\n    if (isElectron) {\n      //兼容之前的版本\n      localforage.getItem(this.props.books[0].key).then((result) => {\n        if (result) {\n          backup(\n            this.props.books,\n            this.props.notes,\n            this.props.bookmarks,\n            false\n          );\n        }\n      });\n    }\n\n    StorageUtil.setReaderConfig(\n      \"totalBooks\",\n      this.props.books.length.toString()\n    );\n    return (\n      <>\n        <ViewMode />\n        <SelectBook />\n        {!this.props.isSelectBook && <ShelfSelector />}\n        <div\n          className=\"book-list-container-parent\"\n          style={\n            this.props.isCollapsed\n              ? { width: \"calc(100vw - 70px)\", left: \"70px\" }\n              : {}\n          }\n        >\n          <div className=\"book-list-container\">\n            <ul className=\"book-list-item-box\">{this.renderBookList()}</ul>\n          </div>\n        </div>\n      </>\n    );\n  }\n}\n\nexport default withRouter(BookList);\n","import { connect } from \"react-redux\";\nimport {\n  handleFetchList,\n  handleFetchBooks,\n  handleMode,\n  handleShelfIndex,\n} from \"../../../store/actions\";\nimport { stateType } from \"../../../store\";\nimport { withTranslation } from \"react-i18next\";\nimport BookList from \"./component\";\n\nconst mappropsToProps = (state: stateType) => {\n  return {\n    books: state.manager.books,\n    mode: state.sidebar.mode,\n    bookmarks: state.reader.bookmarks,\n    notes: state.reader.notes,\n    selectedBooks: state.manager.selectedBooks,\n    shelfIndex: state.sidebar.shelfIndex,\n    isCollapsed: state.sidebar.isCollapsed,\n    searchResults: state.manager.searchResults,\n    isSearch: state.manager.isSearch,\n    isSelectBook: state.manager.isSelectBook,\n    isBookSort: state.manager.isBookSort,\n    viewMode: state.manager.viewMode,\n    bookSortCode: state.manager.bookSortCode,\n    noteSortCode: state.manager.noteSortCode,\n  };\n};\nconst actionCreator = {\n  handleFetchList,\n  handleMode,\n  handleShelfIndex,\n  handleFetchBooks,\n};\nexport default connect(\n  mappropsToProps,\n  actionCreator\n)(withTranslation()(BookList as any));\n","import React from \"react\";\nimport \"./booklist.css\";\nimport BookCardItem from \"../../../components/bookCardItem\";\nimport BookCoverItem from \"../../../components/bookCoverItem\";\nimport BookListItem from \"../../../components/bookListItem\";\nimport AddTrash from \"../../../utils/readUtils/addTrash\";\nimport RecordRecent from \"../../../utils/readUtils/recordRecent\";\nimport SortUtil from \"../../../utils/readUtils/sortUtil\";\nimport BookModel from \"../../../model/Book\";\nimport { Trans } from \"react-i18next\";\nimport { BookListProps, BookListState } from \"./interface\";\nimport Empty from \"../../emptyPage\";\nimport { withRouter } from \"react-router-dom\";\nimport ViewMode from \"../../../components/viewMode\";\n\nclass BookList extends React.Component<BookListProps, BookListState> {\n  constructor(props: BookListProps) {\n    super(props);\n    this.state = {};\n  }\n  UNSAFE_componentWillMount() {\n    this.props.handleFetchBooks(true);\n  }\n  handleKeyFilter = (items: any[], arr: string[]) => {\n    let itemArr: any[] = [];\n    arr.forEach((item) => {\n      items.forEach((subItem: any) => {\n        if (subItem.key === item) {\n          itemArr.push(subItem);\n        }\n      });\n    });\n\n    return itemArr;\n  };\n\n  //根据搜索图书index获取到搜索出的图书\n  handleIndexFilter = (items: any, arr: number[]) => {\n    let itemArr: any[] = [];\n    arr.forEach((item) => {\n      items[item] && itemArr.push(items[item]);\n    });\n\n    return itemArr;\n  };\n  renderBookList = () => {\n    //根据不同的场景获取不同的图书数据\n    let books = !this.props.isBookSort\n      ? this.handleKeyFilter(this.props.deletedBooks, AddTrash.getAllTrash())\n      : this.props.isBookSort\n      ? this.handleIndexFilter(\n          this.handleKeyFilter(this.props.deletedBooks, AddTrash.getAllTrash()),\n          //返回排序后的图书index\n          SortUtil.sortBooks(\n            this.props.deletedBooks,\n            this.props.bookSortCode\n          ) || []\n        )\n      : this.props.isBookSort\n      ? this.handleIndexFilter(\n          this.props.deletedBooks,\n          //返回排序后的图书index\n          SortUtil.sortBooks(\n            this.props.deletedBooks,\n            this.props.bookSortCode\n          ) || []\n        )\n      : this.handleKeyFilter(\n          this.props.deletedBooks,\n          RecordRecent.getAllRecent()\n        );\n    if (books.length === 0) {\n      return (\n        <div\n          style={{\n            position: \"fixed\",\n            left: 0,\n            top: 0,\n            width: \"100%\",\n            height: \"100%\",\n            zIndex: -1,\n          }}\n        >\n          <Empty />\n        </div>\n      );\n    }\n\n    return books.map((item: BookModel, index: number) => {\n      return this.props.viewMode === \"list\" ? (\n        <BookListItem\n          {...{\n            key: index,\n            book: item,\n          }}\n        />\n      ) : this.props.viewMode === \"card\" ? (\n        <BookCardItem\n          {...{\n            key: index,\n            book: item,\n            isSelected: this.props.selectedBooks.indexOf(item.key) > -1,\n          }}\n        />\n      ) : (\n        <BookCoverItem\n          {...{\n            key: index,\n            book: item,\n            isSelected: this.props.selectedBooks.indexOf(item.key) > -1,\n          }}\n        />\n      );\n    });\n  };\n\n  render() {\n    return (\n      <>\n        <ViewMode />\n        <div\n          className=\"booklist-delete-container\"\n          onClick={() => {\n            this.props.handleDeleteDialog(true);\n          }}\n          style={this.props.isCollapsed ? { left: \"calc(50% - 60px)\" } : {}}\n        >\n          <Trans>Delete All Books</Trans>\n        </div>\n\n        <div\n          className=\"book-list-container-parent\"\n          style={\n            this.props.isCollapsed\n              ? { width: \"calc(100vw - 70px)\", left: \"70px\" }\n              : {}\n          }\n        >\n          <div className=\"book-list-container\">\n            <ul className=\"book-list-item-box\">{this.renderBookList()}</ul>\n          </div>\n        </div>\n      </>\n    );\n  }\n}\n\nexport default withRouter(BookList);\n","import { connect } from \"react-redux\";\nimport {\n  handleFetchList,\n  handleFetchBooks,\n  handleMode,\n  handleShelfIndex,\n  handleDeleteDialog,\n} from \"../../../store/actions\";\nimport { stateType } from \"../../../store\";\nimport BookList from \"./component\";\n\nconst mappropsToProps = (state: stateType) => {\n  return {\n    books: state.manager.books,\n    deletedBooks: state.manager.deletedBooks,\n    mode: state.sidebar.mode,\n    isBookSort: state.manager.isBookSort,\n    isCollapsed: state.sidebar.isCollapsed,\n    viewMode: state.manager.viewMode,\n    bookSortCode: state.manager.bookSortCode,\n    noteSortCode: state.manager.noteSortCode,\n    selectedBooks: state.manager.selectedBooks,\n  };\n};\nconst actionCreator = {\n  handleFetchList,\n  handleMode,\n  handleShelfIndex,\n  handleDeleteDialog,\n  handleFetchBooks,\n};\nexport default connect(mappropsToProps, actionCreator)(BookList);\n","import React from \"react\";\nimport \"./cardList.css\";\nimport NoteModel from \"../../../model/Note\";\nimport { Trans } from \"react-i18next\";\nimport { CardListProps, CardListStates } from \"./interface\";\nimport DeleteIcon from \"../../../components/deleteIcon\";\nimport RecordLocation from \"../../../utils/readUtils/recordLocation\";\nimport { withRouter } from \"react-router-dom\";\nimport SortUtil from \"../../../utils/readUtils/sortUtil\";\nimport { Redirect } from \"react-router-dom\";\nimport NoteTag from \"../../../components/noteTag\";\nimport BookUtil from \"../../../utils/fileUtils/bookUtil\";\nimport toast from \"react-hot-toast\";\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\nimport BookModel from \"../../../model/Book\";\nclass CardList extends React.Component<CardListProps, CardListStates> {\n  constructor(props: CardListProps) {\n    super(props);\n    this.state = { deleteKey: \"\" };\n  }\n  //根据bookkey获取\n  handleBookName = (bookKey: string) => {\n    let { books } = this.props;\n    let bookName = \"\";\n    for (let i = 0; i < this.props.books.length; i++) {\n      if (books[i].key === bookKey) {\n        bookName = books[i].name;\n        break;\n      }\n    }\n    return bookName;\n  };\n  handleShowDelete = (deleteKey: string) => {\n    this.setState({ deleteKey });\n  };\n  handleJump = (note: NoteModel) => {\n    let { books } = this.props;\n    let book: BookModel | null = null;\n    //根据bookKey获取指定的book和epub\n    for (let i = 0; i < books.length; i++) {\n      if (books[i].key === note.bookKey) {\n        book = books[i];\n        break;\n      }\n    }\n    if (!book) {\n      toast(this.props.t(\"Book not exist\"));\n      return;\n    }\n\n    if (book.format === \"PDF\") {\n      let bookLocation = JSON.parse(note.cfi) || {};\n      RecordLocation.recordPDFLocation(book.md5.split(\"-\")[0], bookLocation);\n    } else {\n      let bookLocation: any = {};\n      //兼容1.4.2之前的版本\n      try {\n        bookLocation = JSON.parse(note.cfi) || {};\n      } catch (error) {\n        bookLocation.cfi = note.cfi;\n        bookLocation.chapterTitle = note.chapter;\n      }\n      RecordLocation.recordHtmlLocation(\n        note.bookKey,\n        bookLocation.text,\n        bookLocation.chapterTitle,\n        bookLocation.count,\n        bookLocation.percentage,\n        bookLocation.cfi\n      );\n    }\n\n    if (StorageUtil.getReaderConfig(\"isOpenInMain\") === \"yes\") {\n      this.props.history.push(BookUtil.getBookUrl(book));\n    } else {\n      BookUtil.RedirectBook(book);\n    }\n  };\n  render() {\n    let { cards } = this.props;\n    if (cards.length === 0) {\n      return <Redirect to=\"/manager/empty\" />;\n    }\n\n    let noteObj = SortUtil.sortNotes(\n      cards,\n      this.props.noteSortCode,\n      this.props.books\n    );\n    const renderCardListItem = (title: string) => {\n      return noteObj![title].map((item: NoteModel, index: number) => {\n        const cardProps = {\n          itemKey: item.key,\n          mode: \"notes\",\n        };\n        return (\n          <li\n            className=\"card-list-item\"\n            key={index}\n            onMouseOver={() => {\n              this.handleShowDelete(item.key);\n            }}\n            onMouseLeave={() => {\n              this.handleShowDelete(\"\");\n            }}\n            style={\n              this.props.mode === \"note\" && !this.props.isCollapsed\n                ? { height: \"250px\" }\n                : this.props.mode === \"note\" && this.props.isCollapsed\n                ? { height: \"250px\", width: \"calc(50vw - 70px)\" }\n                : this.props.isCollapsed\n                ? { width: \"calc(50vw - 70px)\" }\n                : {}\n            }\n          >\n            <div className=\"card-list-item-card\">\n              <div style={{ position: \"relative\", bottom: \"25px\" }}>\n                {this.state.deleteKey === item.key ? (\n                  <DeleteIcon {...cardProps} />\n                ) : null}\n              </div>\n              <div className=\"card-list-item-text-parent\">\n                <div className=\"card-list-item-note\">\n                  {this.props.mode === \"note\" ? item.notes : item.text}\n                </div>\n              </div>\n              {this.props.mode === \"note\" ? (\n                <div className=\"card-list-item-text-note\">\n                  <div className=\"card-list-item-text\">{item.text}</div>\n                </div>\n              ) : null}\n\n              <div className=\"card-list-item-citation\">\n                <div className=\"card-list-item-title\">\n                  <Trans>From</Trans>《\n                </div>\n                <div className=\"card-list-item-chapter card-list-item-title\">\n                  {this.handleBookName(item.bookKey)}\n                </div>\n                <div className=\"card-list-item-chapter card-list-item-title\">\n                  》{item.chapter}\n                </div>\n              </div>\n              <div\n                className=\"note-tags\"\n                style={{\n                  position: \"absolute\",\n                  bottom: \"60px\",\n                  height: \"30px\",\n                  overflow: \"hidden\",\n                }}\n              >\n                <NoteTag\n                  {...{\n                    handleTag: () => {},\n                    tag: item.tag || [],\n                    isCard: true,\n                  }}\n                />\n              </div>\n              <div\n                onClick={() => {\n                  this.handleJump(item);\n                }}\n              >\n                <div\n                  className=\"card-list-item-show-more\"\n                  style={{ bottom: \"10px\" }}\n                >\n                  {this.props.mode === \"note\" ? (\n                    <Trans>{\"More Notes\"}</Trans>\n                  ) : (\n                    <Trans>{\"Show in the book\"}</Trans>\n                  )}\n\n                  <span className=\"icon-dropdown icon-card-right\"></span>\n                </div>\n              </div>\n            </div>\n          </li>\n        );\n      });\n    };\n    const renderCardList = () => {\n      return Object.keys(noteObj!).map((item, index) => {\n        return (\n          <li className=\"card-page-item\" key={index}>\n            <div className=\"card-page-item-date\">{item}</div>\n            <ul className=\"card-list-container-box\">\n              {renderCardListItem(item)}\n            </ul>\n          </li>\n        );\n      });\n    };\n    return <div className=\"card-list-container\">{renderCardList()}</div>;\n  }\n}\n\nexport default withRouter(CardList);\n","import { connect } from \"react-redux\";\nimport { stateType } from \"../../../store\";\nimport { withTranslation } from \"react-i18next\";\nimport CardList from \"./component\";\nimport { handleReadingBook } from \"../../../store/actions\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    digests: state.reader.digests,\n    isCollapsed: state.sidebar.isCollapsed,\n    currentBook: state.book.currentBook,\n    bookmarks: state.reader.bookmarks,\n    chapters: state.reader.chapters,\n    books: state.manager.books,\n    noteSortCode: state.manager.noteSortCode,\n  };\n};\nconst actionCreator = {\n  handleReadingBook,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(CardList as any));\n","import React from \"react\";\nimport \"./noteList.css\";\nimport { NoteListProps, NoteListState } from \"./interface\";\nimport CardList from \"../cardList\";\nimport NoteTag from \"../../../components/noteTag\";\nimport NoteModel from \"../../../model/Note\";\nimport Empty from \"../../emptyPage\";\n\nclass NoteList extends React.Component<NoteListProps, NoteListState> {\n  constructor(props: NoteListProps) {\n    super(props);\n    this.state = {\n      tag: [],\n    };\n  }\n  UNSAFE_componentWillMount() {\n    this.props.handleFetchNotes();\n  }\n  handleTag = (tag: string[]) => {\n    this.setState({ tag });\n  };\n  handleFilter = (items: any, arr: number[]) => {\n    let itemArr: any[] = [];\n    arr.forEach((item) => {\n      items[item] && itemArr.push(items[item]);\n    });\n    return itemArr;\n  };\n  filterTag = (notes: NoteModel[]) => {\n    let temp: NoteModel[] = [];\n    for (let i = 0; i < notes.length; i++) {\n      let flag = false;\n      for (let j = 0; j < this.state.tag.length; j++) {\n        if (notes[i].tag && notes[i].tag.indexOf(this.state.tag[j]) > -1) {\n          flag = true;\n          break;\n        }\n      }\n      if (flag) {\n        temp.push(notes[i]);\n      }\n    }\n    return temp;\n  };\n  render() {\n    const noteProps = {\n      cards: this.props.isSearch\n        ? this.handleFilter(\n            this.props.notes.filter((item) => item.notes !== \"\"),\n            this.props.searchResults\n          )\n        : this.state.tag.length > 0\n        ? this.filterTag(this.props.notes.filter((item) => item.notes !== \"\"))\n        : this.props.notes.filter((item) => item.notes !== \"\"),\n      mode: \"note\",\n    };\n    return (\n      <div\n        className=\"note-list-container-parent\"\n        style={\n          this.props.isCollapsed\n            ? { width: \"calc(100vw - 70px)\", left: \"70px\" }\n            : {}\n        }\n      >\n        <div className=\"note-tags\">\n          <NoteTag {...{ handleTag: this.handleTag }} />\n        </div>\n        {noteProps.cards.length === 0 ? (\n          <div\n            style={{\n              position: \"fixed\",\n              left: 0,\n              top: 0,\n              width: \"100%\",\n              height: \"100%\",\n              zIndex: -1,\n            }}\n          >\n            {this.state.tag.length === 0 && <Empty />}\n          </div>\n        ) : (\n          <CardList {...noteProps} />\n        )}\n      </div>\n    );\n  }\n}\n\nexport default NoteList;\n","import { connect } from \"react-redux\";\nimport { stateType } from \"../../../store\";\nimport NoteList from \"./component\";\nimport { handleFetchNotes } from \"../../../store/actions\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    notes: state.reader.notes,\n    isSearch: state.manager.isSearch,\n    isCollapsed: state.sidebar.isCollapsed,\n    searchResults: state.manager.searchResults,\n  };\n};\nconst actionCreator = { handleFetchNotes };\nexport default connect(mapStateToProps, actionCreator)(NoteList);\n","import React from \"react\";\nimport \"./digestList.css\";\nimport { DigestListProps, DigestListStates } from \"./interface\";\nimport CardList from \"../cardList\";\nimport NoteTag from \"../../../components/noteTag\";\nimport NoteModel from \"../../../model/Note\";\nimport Empty from \"../../emptyPage\";\n\nclass DigestList extends React.Component<DigestListProps, DigestListStates> {\n  constructor(props: DigestListProps) {\n    super(props);\n    this.state = {\n      tag: [],\n    };\n  }\n  UNSAFE_componentWillMount() {\n    this.props.handleFetchNotes();\n  }\n  handleFilter = (items: any, arr: number[]) => {\n    let itemArr: any[] = [];\n    arr.forEach((item) => {\n      items[item] && itemArr.push(items[item]);\n    });\n    return itemArr;\n  };\n  handleTag = (tag: string[]) => {\n    this.setState({ tag });\n  };\n  filterTag = (digests: NoteModel[]) => {\n    let temp: NoteModel[] = [];\n    for (let i = 0; i < digests.length; i++) {\n      let flag = false;\n      for (let j = 0; j < this.state.tag.length; j++) {\n        if (digests[i].tag && digests[i].tag.indexOf(this.state.tag[j]) > -1) {\n          flag = true;\n          break;\n        }\n      }\n      if (flag) {\n        temp.push(digests[i]);\n      }\n    }\n    return temp;\n  };\n  render() {\n    const noteProps = {\n      cards: this.props.isSearch\n        ? this.handleFilter(this.props.digests, this.props.searchResults)\n        : this.state.tag.length > 0\n        ? this.filterTag(this.props.digests)\n        : this.props.digests,\n      mode: \"digest\",\n    };\n\n    return (\n      <div\n        className=\"digest-list-container-parent\"\n        style={\n          this.props.isCollapsed\n            ? { width: \"calc(100vw - 70px)\", left: \"70px\" }\n            : {}\n        }\n      >\n        <div className=\"note-tags\">\n          <NoteTag {...{ handleTag: this.handleTag }} />\n        </div>\n        {noteProps.cards.length === 0 ? (\n          <div\n            style={{\n              position: \"fixed\",\n              left: 0,\n              top: 0,\n              width: \"100%\",\n              height: \"100%\",\n              zIndex: -1,\n            }}\n          >\n            {this.state.tag.length === 0 && <Empty />}\n          </div>\n        ) : (\n          <CardList {...noteProps} />\n        )}\n      </div>\n    );\n  }\n}\n\nexport default DigestList;\n","import { connect } from \"react-redux\";\nimport { stateType } from \"../../../store\";\nimport DigestList from \"./component\";\nimport { handleFetchNotes } from \"../../../store/actions\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    digests: state.reader.digests,\n    isSearch: state.manager.isSearch,\n    isCollapsed: state.sidebar.isCollapsed,\n    searchResults: state.manager.searchResults,\n  };\n};\nconst actionCreator = { handleFetchNotes };\nexport default connect(mapStateToProps, actionCreator)(DigestList);\n","import React from \"react\";\nimport \"./loadingPage.css\";\nimport { LoadingPageProps } from \"./interface\";\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\nimport { Redirect } from \"react-router-dom\";\n\nclass LoadingPage extends React.Component<LoadingPageProps> {\n  render() {\n    if (this.props.books) {\n      return <Redirect to=\"/manager/home\" />;\n    }\n    let arr: number[] = [];\n    for (\n      let i = 0;\n      i < parseInt(StorageUtil.getReaderConfig(\"totalBooks\")) || 0;\n      i++\n    ) {\n      arr.push(i);\n    }\n    if (StorageUtil.getReaderConfig(\"viewMode\") !== \"list\") {\n      const renderLoadingCard = () => {\n        return arr.map((item, index) => {\n          return (\n            <div className=\"loading-page-book\" key={item}>\n              <div\n                className=\"loading-page-cover\"\n                style={{ opacity: `${(index % 7) * 0.2}` }}\n              ></div>\n            </div>\n          );\n        });\n      };\n      return (\n        <div className=\"loading-page-container-parent\">\n          <div className=\"loading-page-container\">{renderLoadingCard()}</div>\n        </div>\n      );\n    } else {\n      const renderLoadingList = () => {\n        return arr.map((item, index) => {\n          return (\n            <div className=\"loading-page-list\" key={item}>\n              <div className=\"loading-page-list-cover\"></div>\n              <div className=\"loading-page-bar\">\n                <div className=\"loading-page-bar1\"></div>\n                <div className=\"loading-page-bar2\"></div>\n                <div className=\"loading-page-bar3\"></div>\n              </div>\n            </div>\n          );\n        });\n      };\n      return (\n        <div className=\"loading-page-container-parent\">\n          <div className=\"loading-page-container\" style={{ marginTop: \"8px\" }}>\n            {renderLoadingList()}\n          </div>\n        </div>\n      );\n    }\n  }\n}\n\nexport default LoadingPage;\n","import { connect } from \"react-redux\";\nimport { stateType } from \"../../store\";\nimport LoadingPage from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    books: state.manager.books,\n  };\n};\nconst actionCreator = {};\nexport default connect(mapStateToProps, actionCreator)(LoadingPage);\n","import BookList from \"../containers/lists/bookList\";\nimport DeletedBookList from \"../containers/lists/deletedBookList\";\nimport NoteList from \"../containers/lists/noteList\";\nimport DigestList from \"../containers/lists/digestList\";\nimport EmptyPage from \"../containers/emptyPage\";\nimport LoadingPage from \"../containers/loadingPage\";\n\nexport const routes = [\n  { path: \"/manager/empty\", component: EmptyPage },\n  { path: \"/manager/loading\", component: LoadingPage },\n  { path: \"/manager/note\", component: NoteList },\n  { path: \"/manager/digest\", component: DigestList },\n  { path: \"/manager/home\", component: BookList },\n  { path: \"/manager/favorite\", component: BookList },\n  { path: \"/manager/trash\", component: DeletedBookList },\n];\n","import React from \"react\";\nimport \"./arrow.css\";\nconst Arrow = () => {\n  return (\n    <div className=\"arrow-container\">\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        width=\"48\"\n        height=\"48\"\n        viewBox=\"0 0 48 48\"\n        className=\"circle\"\n      >\n        <g\n          transform=\"translate(48 48) rotate(180)\"\n          fill=\"none\"\n          stroke=\"rgba(75,75,75)\"\n          strokeWidth=\"1.5\"\n        >\n          <circle cx=\"24\" cy=\"24\" r=\"24\" stroke=\"none\" />\n          <circle cx=\"24\" cy=\"24\" r=\"23.25\" fill=\"none\" />\n        </g>\n      </svg>\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        width=\"7\"\n        height=\"40.5\"\n        viewBox=\"0 0 9 64.5\"\n        className=\"arrow\"\n      >\n        <g transform=\"translate(-799.5 -100)\">\n          <line\n            y2=\"59\"\n            transform=\"translate(804 163.5) rotate(180)\"\n            fill=\"none\"\n            stroke=\"rgba(75,75,75)\"\n            strokeLinecap=\"round\"\n            strokeWidth=\"2\"\n          />\n          <path\n            d=\"M4.5,0,9,8H0Z\"\n            transform=\"translate(799.5 100)\"\n            fill=\"rgba(75,75,75)\"\n          />\n        </g>\n      </svg>\n    </div>\n  );\n};\n\nexport default Arrow;\n","import React from \"react\";\nimport \"./loadingDialog.css\";\nimport Lottie from \"react-lottie\";\nimport animationData from \"../../../assets/lotties/loading.json\";\nimport { Trans } from \"react-i18next\";\nconst defaultOptions = {\n  loop: true,\n  autoplay: true,\n  animationData: animationData,\n  rendererSettings: {\n    preserveAspectRatio: \"xMidYMid slice\",\n  },\n};\nconst LoadingDialog = (props) => {\n  return (\n    <div className=\"loading-dialog\">\n      <div className=\"loading-dialog-title\">\n        <Trans>Please Wait a moment</Trans>\n      </div>\n      <div className=\"loading-animation\">\n        <Lottie options={defaultOptions} height={250} width={280} />\n      </div>\n    </div>\n  );\n};\nexport default LoadingDialog;\n","import React from \"react\";\nimport \"./updateInfo.css\";\nimport { TipDialogProps, TipDialogState } from \"./interface\";\nimport { Trans } from \"react-i18next\";\nimport Lottie from \"react-lottie\";\nimport animationDownload from \"../../../assets/lotties/download.json\";\n\nconst downloadOptions = {\n  loop: true,\n  autoplay: true,\n  animationData: animationDownload,\n  rendererSettings: {\n    preserveAspectRatio: \"xMidYMid slice\",\n  },\n};\n\nclass TipDialog extends React.Component<TipDialogProps, TipDialogState> {\n  constructor(props: TipDialogProps) {\n    super(props);\n    this.state = {};\n  }\n\n  handleClose = () => {\n    this.props.handleTipDialog(false);\n  };\n  render() {\n    return (\n      <div className=\"download-desk-container\">\n        <div\n          className=\"setting-close-container\"\n          onClick={() => {\n            this.handleClose();\n          }}\n        >\n          <span className=\"icon-close tip-close-icon\"></span>\n        </div>\n\n        <div className=\"download-desk-title\">\n          <Trans>Tips</Trans>\n        </div>\n\n        <div className=\"download-desk-feature-container\">\n          <div className=\"download-desk-feature-item\">\n            <Trans>{this.props.tip}</Trans>\n          </div>\n        </div>\n        <div\n          className=\"new-version-open\"\n          onClick={() => {\n            this.handleClose();\n          }}\n          style={{ marginTop: \"-10px\" }}\n        >\n          <Trans>Understand</Trans>\n        </div>\n        <div className=\"download-desk-animation\">\n          <Lottie options={downloadOptions} height={200} width={300} />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default TipDialog;\n","import { connect } from \"react-redux\";\nimport { handleTipDialog } from \"../../../store/actions\";\nimport TipDialog from \"./component\";\nimport { stateType } from \"../../../store\";\n\nconst mapStateToProps = (state: stateType) => {\n  return { tip: state.manager.tip };\n};\nconst actionCreator = {\n  handleTipDialog,\n};\nexport default connect(mapStateToProps, actionCreator)(TipDialog);\n","import React from \"react\";\nimport Sidebar from \"../../containers/sidebar\";\nimport Header from \"../../containers/header\";\nimport DeleteDialog from \"../../components/dialogs/deleteDialog\";\nimport EditDialog from \"../../components/dialogs/editDialog\";\nimport AddDialog from \"../../components/dialogs/addDialog\";\nimport SortDialog from \"../../components/dialogs/sortDialog\";\nimport AboutDialog from \"../../components/dialogs/aboutDialog\";\nimport BackupDialog from \"../../components/dialogs/backupDialog\";\nimport \"./manager.css\";\nimport { ManagerProps, ManagerState } from \"./interface\";\nimport { Trans } from \"react-i18next\";\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\nimport AddFavorite from \"../../utils/readUtils/addFavorite\";\nimport SettingDialog from \"../../components/dialogs/settingDialog\";\nimport { isMobile } from \"react-device-detect\";\nimport { Route, Switch, Redirect } from \"react-router-dom\";\nimport { routes } from \"../../router/routes\";\nimport Arrow from \"../../components/arrow\";\nimport LoadingDialog from \"../../components/dialogs/loadingDialog\";\nimport TipDialog from \"../../components/dialogs/TipDialog\";\nimport { Toaster } from \"react-hot-toast\";\n\n//判断是否为触控设备\nconst is_touch_device = () => {\n  return \"ontouchstart\" in window || navigator.maxTouchPoints > 0;\n};\n\nclass Manager extends React.Component<ManagerProps, ManagerState> {\n  timer!: NodeJS.Timeout;\n  constructor(props: ManagerProps) {\n    super(props);\n    this.state = {\n      totalBooks: parseInt(StorageUtil.getReaderConfig(\"totalBooks\")) || 0,\n      favoriteBooks: Object.keys(AddFavorite.getAllFavorite()).length,\n      isAuthed: false,\n      isError: false,\n      isCopied: false,\n      isUpdated: false,\n      isDrag: false,\n      token: \"\",\n    };\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps: ManagerProps) {\n    if (nextProps.books && this.state.totalBooks !== nextProps.books.length) {\n      this.setState(\n        {\n          totalBooks: nextProps.books.length,\n        },\n        () => {\n          StorageUtil.setReaderConfig(\n            \"totalBooks\",\n            this.state.totalBooks.toString()\n          );\n        }\n      );\n    }\n    if (nextProps.books && nextProps.books.length === 1 && !this.props.books) {\n      this.props.history.push(\"/manager/home\");\n    }\n    if (this.props.mode !== nextProps.mode) {\n      this.setState({\n        favoriteBooks: Object.keys(AddFavorite.getAllFavorite()).length,\n      });\n    }\n  }\n  UNSAFE_componentWillMount() {\n    this.props.handleFetchBooks();\n    this.props.handleFetchNotes();\n    this.props.handleFetchBookmarks();\n    this.props.handleFetchBookSortCode();\n    this.props.handleFetchNoteSortCode();\n    this.props.handleFetchList();\n  }\n  componentDidMount() {\n    if (is_touch_device() && !StorageUtil.getReaderConfig(\"isTouch\")) {\n      StorageUtil.setReaderConfig(\"isTouch\", \"yes\");\n    }\n    this.props.handleReadingState(false);\n  }\n\n  handleDrag = (isDrag: boolean) => {\n    this.setState({ isDrag });\n  };\n  render() {\n    let { books } = this.props;\n    if (isMobile) {\n      return (\n        <>\n          <p className=\"waring-title\">\n            <Trans>Warning</Trans>\n          </p>\n          <div className=\"mobile-warning\">\n            <span>\n              <Trans>\n                For better user experince, please visit this site on a computer\n              </Trans>\n            </span>\n          </div>\n          <div>\n            <img\n              src={\n                StorageUtil.getReaderConfig(\"appSkin\") === \"night\" ||\n                (StorageUtil.getReaderConfig(\"appSkin\") === \"system\" &&\n                  StorageUtil.getReaderConfig(\"isOSNight\") === \"yes\")\n                  ? \"./assets/empty_light.svg\"\n                  : \"./assets/empty.svg\"\n              }\n              alt=\"\"\n              className=\"waring-pic\"\n            />\n          </div>\n        </>\n      );\n    }\n    return (\n      <div\n        className=\"manager\"\n        onDragEnter={() => {\n          !this.props.dragItem && this.handleDrag(true);\n          (\n            document.getElementsByClassName(\"import-from-local\")[0] as any\n          ).style.zIndex = \"50\";\n        }}\n      >\n        {!this.props.dragItem && (\n          <div\n            className=\"drag-background\"\n            onClick={() => {\n              this.props.handleEditDialog(false);\n              this.props.handleDeleteDialog(false);\n              this.props.handleAddDialog(false);\n              this.props.handleTipDialog(false);\n              this.props.handleLoadingDialog(false);\n              this.props.handleNewDialog(false);\n              this.props.handleBackupDialog(false);\n              this.props.handleSetting(false);\n              this.handleDrag(false);\n            }}\n            style={\n              this.props.isSettingOpen ||\n              this.props.isBackup ||\n              this.props.isShowNew ||\n              this.props.isOpenDeleteDialog ||\n              this.props.isOpenEditDialog ||\n              this.props.isOpenAddDialog ||\n              this.props.isTipDialog ||\n              this.props.isShowLoading ||\n              this.state.isDrag\n                ? {}\n                : {\n                    display: \"none\",\n                  }\n            }\n          >\n            {this.state.isDrag && (\n              <div className=\"drag-info\">\n                <Arrow />\n                <p className=\"arrow-text\">\n                  <Trans>Drop your books here</Trans>\n                </p>\n              </div>\n            )}\n          </div>\n        )}\n        <Sidebar />\n        <Header {...{ handleDrag: this.handleDrag }} />\n        {this.props.isOpenDeleteDialog && <DeleteDialog />}\n        {this.props.isOpenEditDialog && <EditDialog />}\n        {this.props.isOpenAddDialog && <AddDialog />}\n        {this.props.isShowLoading && <LoadingDialog />}\n        <Toaster />\n        {this.props.isSortDisplay && <SortDialog />}\n        {this.props.isAboutOpen && <AboutDialog />}\n        {this.props.isBackup && <BackupDialog />}\n        {this.props.isSettingOpen && <SettingDialog />}\n        {this.props.isTipDialog && <TipDialog />}\n        {(!books || books.length === 0) && this.state.totalBooks ? (\n          <Redirect to=\"/manager/loading\" />\n        ) : (\n          <Switch>\n            {routes.map((ele) => (\n              <Route\n                render={() => <ele.component />}\n                key={ele.path}\n                path={ele.path}\n              />\n            ))}\n          </Switch>\n        )}\n      </div>\n    );\n  }\n}\nexport default Manager;\n","import { connect } from \"react-redux\";\nimport {\n  handleFetchBooks,\n  handleFetchBookSortCode,\n  handleFetchNoteSortCode,\n  handleFetchList,\n  handleTipDialog,\n  handleLoadingDialog,\n  handleNewDialog,\n  handleSetting,\n  handleBackupDialog,\n  handleFetchNotes,\n  handleFetchBookmarks,\n  handleEditDialog,\n  handleDeleteDialog,\n  handleAddDialog,\n  handleReadingState,\n} from \"../../store/actions\";\nimport { withTranslation } from \"react-i18next\";\n\nimport \"./manager.css\";\nimport { stateType } from \"../../store\";\nimport Manager from \"./component\";\nimport { withRouter } from \"react-router-dom\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    books: state.manager.books,\n    notes: state.reader.notes,\n    digests: state.reader.digests,\n    bookmarks: state.reader.bookmarks,\n    isReading: state.book.isReading,\n    mode: state.sidebar.mode,\n    dragItem: state.book.dragItem,\n    shelfIndex: state.sidebar.shelfIndex,\n    isOpenEditDialog: state.book.isOpenEditDialog,\n    isOpenDeleteDialog: state.book.isOpenDeleteDialog,\n    isOpenAddDialog: state.book.isOpenAddDialog,\n    isSettingOpen: state.manager.isSettingOpen,\n    isAboutOpen: state.manager.isAboutOpen,\n    isBookSort: state.manager.isBookSort,\n    isSortDisplay: state.manager.isSortDisplay,\n    isShowLoading: state.manager.isShowLoading,\n    isShowNew: state.manager.isShowNew,\n    isTipDialog: state.manager.isTipDialog,\n    isBackup: state.backupPage.isBackup,\n  };\n};\nconst actionCreator = {\n  handleFetchBooks,\n  handleFetchNotes,\n  handleSetting,\n  handleFetchBookmarks,\n  handleFetchBookSortCode,\n  handleFetchNoteSortCode,\n  handleFetchList,\n  handleEditDialog,\n  handleDeleteDialog,\n  handleAddDialog,\n  handleTipDialog,\n  handleLoadingDialog,\n  handleNewDialog,\n  handleBackupDialog,\n  handleReadingState,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(withRouter(Manager)));\n","import React from \"react\";\nimport \"./background.css\";\nimport { BackgroundProps, BackgroundState } from \"./interface\";\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\nimport { Trans } from \"react-i18next\";\nimport RecordLocation from \"../../utils/readUtils/recordLocation\";\nclass Background extends React.Component<BackgroundProps, BackgroundState> {\n  isFirst: Boolean;\n  constructor(props: any) {\n    super(props);\n    this.state = {\n      isSingle:\n        StorageUtil.getReaderConfig(\"readerMode\") &&\n        StorageUtil.getReaderConfig(\"readerMode\") !== \"double\",\n      prevPage: 0,\n      nextPage: 0,\n      scale: StorageUtil.getReaderConfig(\"scale\") || 1,\n      isHideFooter: StorageUtil.getReaderConfig(\"isHideFooter\") === \"yes\",\n      isHideHeader: StorageUtil.getReaderConfig(\"isHideHeader\") === \"yes\",\n    };\n    this.isFirst = true;\n  }\n\n  async UNSAFE_componentWillReceiveProps(nextProps: BackgroundProps) {\n    if (nextProps.htmlBook !== this.props.htmlBook && nextProps.htmlBook) {\n      await this.handlePageNum(nextProps.htmlBook.rendition);\n      nextProps.htmlBook.rendition.on(\"page-changed\", async () => {\n        await this.handlePageNum(nextProps.htmlBook.rendition);\n        await this.handleLocation();\n      });\n    }\n  }\n  handleLocation = async () => {\n    let position = await this.props.htmlBook.rendition.getPosition();\n    RecordLocation.recordHtmlLocation(\n      this.props.currentBook.key,\n      position.text,\n      position.chapterTitle,\n      position.count,\n      position.percentage,\n      position.cfi\n    );\n  };\n  async handlePageNum(rendition) {\n    let pageInfo = await rendition.getProgress();\n    this.setState({\n      prevPage: this.state.isSingle\n        ? pageInfo.currentPage\n        : pageInfo.currentPage * 2 - 1,\n      nextPage: this.state.isSingle\n        ? pageInfo.currentPage\n        : pageInfo.currentPage * 2,\n    });\n  }\n\n  render() {\n    return (\n      <div\n        className=\"background\"\n        style={{\n          color: StorageUtil.getReaderConfig(\"textColor\")\n            ? StorageUtil.getReaderConfig(\"textColor\")\n            : \"\",\n        }}\n      >\n        <div className=\"header-container\">\n          {!this.state.isHideHeader && this.props.currentChapter && (\n            <p\n              className=\"header-chapter-name\"\n              style={\n                this.state.isSingle\n                  ? {\n                      left: `calc(50vw - \n                      270px)`,\n                    }\n                  : {}\n              }\n            >\n              {this.props.currentChapter}\n            </p>\n          )}\n          {!this.state.isHideHeader &&\n            this.props.currentChapter &&\n            !this.state.isSingle && (\n              <p\n                className=\"header-book-name\"\n                style={\n                  this.state.isSingle\n                    ? {\n                        right: `calc(50vw - \n                      270px)`,\n                      }\n                    : {}\n                }\n              >\n                {this.props.currentBook.name}\n              </p>\n            )}\n        </div>\n        <div className=\"footer-container\">\n          {!this.state.isHideFooter && this.state.prevPage > 0 && (\n            <p\n              className=\"background-page-left\"\n              style={\n                this.state.isSingle\n                  ? {\n                      left: `calc(50vw - \n                      270px)`,\n                    }\n                  : {}\n              }\n            >\n              <Trans i18nKey=\"Book Page\" count={this.state.prevPage}>\n                Page\n                {{\n                  count: this.state.prevPage,\n                }}\n              </Trans>\n            </p>\n          )}\n          {!this.state.isHideFooter &&\n            this.state.nextPage > 0 &&\n            !this.state.isSingle && (\n              <p className=\"background-page-right\">\n                <Trans i18nKey=\"Book Page\" count={this.state.nextPage}>\n                  Page\n                  {{\n                    count: this.state.nextPage,\n                  }}\n                </Trans>\n              </p>\n            )}\n        </div>\n        <>\n          {this.props.isShowBookmark ? <div className=\"bookmark\"></div> : null}\n        </>\n      </div>\n    );\n  }\n}\n\nexport default Background;\n","import { connect } from \"react-redux\";\nimport { stateType } from \"../../store\";\nimport Background from \"./component\";\nimport {\n  handleCurrentChapter,\n  handleCurrentChapterIndex,\n} from \"../../store/actions\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentBook: state.book.currentBook,\n    locations: state.progressPanel.locations,\n    currentChapter: state.reader.currentChapter,\n    currentChapterIndex: state.reader.currentChapterIndex,\n    htmlBook: state.reader.htmlBook,\n    isShowBookmark: state.viewArea.isShowBookmark,\n  };\n};\nconst actionCreator = { handleCurrentChapter, handleCurrentChapterIndex };\nexport default connect(mapStateToProps, actionCreator)(Background);\n","class ThemeUtil {\n  static setThemes(themeName: string) {\n    let themeArr =\n      localStorage.getItem(\"themeColors\") !== \"{}\" &&\n      localStorage.getItem(\"themeColors\")\n        ? JSON.parse(localStorage.getItem(\"themeColors\") || \"\")\n        : [];\n    const index = themeArr.indexOf(themeName);\n    if (index > -1) {\n      themeArr.splice(index, 1);\n      themeArr.unshift(themeName);\n    } else {\n      themeArr.unshift(themeName);\n    }\n\n    localStorage.setItem(\"themeColors\", JSON.stringify(themeArr));\n  }\n\n  static clear(themeName: string) {\n    let themeArr =\n      localStorage.getItem(\"themeColors\") !== \"{}\" &&\n      localStorage.getItem(\"themeColors\")\n        ? JSON.parse(localStorage.getItem(\"themeColors\") || \"\")\n        : [];\n    const index = themeArr.indexOf(themeName);\n    if (index > -1) {\n      themeArr.splice(index, 1);\n    }\n    localStorage.setItem(\"themeColors\", JSON.stringify(themeArr));\n  }\n  static getAllThemes() {\n    let themeArr =\n      localStorage.getItem(\"themeColors\") !== \"{}\" &&\n      localStorage.getItem(\"themeColors\")\n        ? JSON.parse(localStorage.getItem(\"themeColors\") || \"\")\n        : [];\n    return themeArr || [];\n  }\n}\n\nexport default ThemeUtil;\n","import React from \"react\";\nimport { backgroundList, textList } from \"../../../constants/themeList\";\nimport StyleUtil from \"../../../utils/readUtils/styleUtil\";\nimport \"./themeList.css\";\nimport { Trans } from \"react-i18next\";\nimport { ThemeListProps, ThemeListState } from \"./interface\";\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\nimport { Panel as ColorPickerPanel } from \"rc-color-picker\";\nimport \"rc-color-picker/assets/index.css\";\nimport ThemeUtil from \"../../../utils/readUtils/themeUtil\";\nimport { Tooltip } from \"react-tippy\";\nimport toast from \"react-hot-toast\";\nimport { isElectron } from \"react-device-detect\";\n\nclass ThemeList extends React.Component<ThemeListProps, ThemeListState> {\n  constructor(props: ThemeListProps) {\n    super(props);\n    this.state = {\n      currentBackgroundIndex: backgroundList\n        .concat(ThemeUtil.getAllThemes())\n        .findIndex((item) => {\n          return (\n            item ===\n            (StorageUtil.getReaderConfig(\"backgroundColor\") ||\n              \"rgba(255,255,255,1)\")\n          );\n        }),\n      currentTextIndex: textList\n        .concat(ThemeUtil.getAllThemes())\n        .findIndex((item) => {\n          return (\n            item ===\n            (StorageUtil.getReaderConfig(\"textColor\") || \"rgba(0,0,0,1)\")\n          );\n        }),\n      isShowTextPicker: false,\n      isShowBgPicker: false,\n    };\n  }\n  handleChangeBgColor = (color: string, index: number = -1) => {\n    StorageUtil.setReaderConfig(\"backgroundColor\", color);\n    this.setState({\n      currentBackgroundIndex: index,\n    });\n    if (index === 1) {\n      StorageUtil.setReaderConfig(\"textColor\", \"rgba(255,255,255,1)\");\n    } else if (\n      index === 0 &&\n      StorageUtil.getReaderConfig(\"backgroundColor\") === \"rgba(255,255,255,1)\"\n    ) {\n      StorageUtil.setReaderConfig(\"textColor\", \"rgba(0,0,0,1)\");\n    }\n    if (isElectron) {\n      toast(this.props.t(\"Take effect at next startup\"));\n    } else {\n      window.location.reload();\n    }\n  };\n\n  handleChooseBgColor = (color) => {\n    StorageUtil.setReaderConfig(\"backgroundColor\", color.color);\n    StyleUtil.addDefaultCss();\n  };\n  handleColorTextPicker = (isShowTextPicker: boolean) => {\n    if (\n      !isShowTextPicker &&\n      textList.concat(ThemeUtil.getAllThemes()).findIndex((item) => {\n        return (\n          item === (StorageUtil.getReaderConfig(\"textColor\") || \"rgba(0,0,0,1)\")\n        );\n      }) === -1\n    ) {\n      ThemeUtil.setThemes(StorageUtil.getReaderConfig(\"textColor\"));\n    }\n    this.setState({ isShowTextPicker });\n  };\n  handleColorBgPicker = (isShowBgPicker: boolean) => {\n    if (\n      !isShowBgPicker &&\n      backgroundList.concat(ThemeUtil.getAllThemes()).findIndex((item) => {\n        return (\n          item ===\n          (StorageUtil.getReaderConfig(\"backgroundColor\") ||\n            \"rgba(255,255,255,1)\")\n        );\n      }) === -1\n    ) {\n      ThemeUtil.setThemes(StorageUtil.getReaderConfig(\"backgroundColor\"));\n    }\n    this.setState({ isShowBgPicker });\n  };\n  handleChooseTextColor = (color) => {\n    if (typeof color !== \"object\") {\n      this.setState({\n        currentTextIndex: textList\n          .concat(ThemeUtil.getAllThemes())\n          .indexOf(color),\n      });\n    }\n    StorageUtil.setReaderConfig(\n      \"textColor\",\n      typeof color === \"object\" ? color.color : color\n    );\n    this.props.renderBookFunc();\n  };\n  render() {\n    const renderBackgroundColorList = () => {\n      return backgroundList\n        .concat(ThemeUtil.getAllThemes())\n        .map((item, index) => {\n          return (\n            <li\n              key={item + index}\n              className={\n                index === this.state.currentBackgroundIndex\n                  ? \"active-color background-color-circle\"\n                  : \"background-color-circle\"\n              }\n              onClick={() => {\n                this.handleChangeBgColor(item, index);\n              }}\n              style={{ backgroundColor: item }}\n            >\n              {index > 3 && index === this.state.currentBackgroundIndex && (\n                <span\n                  className=\"icon-close\"\n                  onClick={() => {\n                    ThemeUtil.clear(item);\n                  }}\n                ></span>\n              )}\n            </li>\n          );\n        });\n    };\n    const renderTextColorList = () => {\n      return textList.concat(ThemeUtil.getAllThemes()).map((item, index) => {\n        return (\n          <li\n            key={item + index}\n            className={\n              index === this.state.currentTextIndex\n                ? \"active-color background-color-circle\"\n                : \"background-color-circle\"\n            }\n            onClick={() => {\n              this.handleChooseTextColor(item);\n            }}\n            style={{ backgroundColor: item }}\n          >\n            {index > 3 && index === this.state.currentTextIndex && (\n              <span\n                className=\"icon-close\"\n                onClick={() => {\n                  ThemeUtil.clear(item);\n                }}\n              ></span>\n            )}\n          </li>\n        );\n      });\n    };\n    return (\n      <div className=\"background-color-setting\">\n        <div className=\"background-color-text\">\n          <Trans>Background Color</Trans>\n        </div>\n        <ul className=\"background-color-list\">\n          <Tooltip\n            title={this.props.t(\"Customize\")}\n            position=\"top\"\n            trigger=\"mouseenter\"\n            style={{ display: \"inline-block\" }}\n          >\n            <li\n              className=\"background-color-circle\"\n              onClick={() => {\n                this.handleColorBgPicker(!this.state.isShowBgPicker);\n              }}\n            >\n              <span\n                className={\n                  this.state.isShowBgPicker ? \"icon-check\" : \"icon-more\"\n                }\n              ></span>\n            </li>\n          </Tooltip>\n\n          {renderBackgroundColorList()}\n        </ul>\n        {this.state.isShowBgPicker && (\n          <ColorPickerPanel\n            enableAlpha={false}\n            color={StorageUtil.getReaderConfig(\"backgroundColor\")}\n            onChange={this.handleChooseBgColor}\n            mode=\"RGB\"\n            style={{\n              margin: 20,\n              animation: \"fade-in 0.2s ease-in-out 0s 1\",\n            }}\n          />\n        )}\n        <div className=\"background-color-text\">\n          <Trans>Text Color</Trans>\n        </div>\n        <ul className=\"background-color-list\">\n          <Tooltip\n            title={this.props.t(\"Customize\")}\n            position=\"top\"\n            trigger=\"mouseenter\"\n            style={{ display: \"inline-block\" }}\n          >\n            <li\n              className=\"background-color-circle\"\n              onClick={() => {\n                this.handleColorTextPicker(!this.state.isShowTextPicker);\n              }}\n            >\n              <span\n                className={\n                  this.state.isShowTextPicker ? \"icon-check\" : \"icon-more\"\n                }\n              ></span>\n            </li>\n          </Tooltip>\n\n          {renderTextColorList()}\n        </ul>\n        {this.state.isShowTextPicker && (\n          <ColorPickerPanel\n            enableAlpha={false}\n            color={StorageUtil.getReaderConfig(\"textColor\")}\n            onChange={this.handleChooseTextColor}\n            mode=\"RGB\"\n            style={{\n              margin: 20,\n              animation: \"fade-in 0.2s ease-in-out 0s 1\",\n            }}\n          />\n        )}\n      </div>\n    );\n  }\n}\n\nexport default ThemeList;\n","import { connect } from \"react-redux\";\nimport { withTranslation } from \"react-i18next\";\nimport ThemeList from \"./component\";\nimport { stateType } from \"../../../store\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    renderBookFunc: state.book.renderBookFunc,\n  };\n};\nconst actionCreator = {};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(ThemeList as any));\n","import React from \"react\";\nimport { Trans } from \"react-i18next\";\nimport { SliderListProps, SliderListState } from \"./interface\";\nimport \"./sliderList.css\";\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\nimport { isElectron } from \"react-device-detect\";\nimport toast from \"react-hot-toast\";\nclass SliderList extends React.Component<SliderListProps, SliderListState> {\n  constructor(props: SliderListProps) {\n    super(props);\n    this.state = {\n      value:\n        this.props.mode === \"fontSize\"\n          ? StorageUtil.getReaderConfig(\"fontSize\") || \"17\"\n          : this.props.mode === \"scale\"\n          ? StorageUtil.getReaderConfig(\"scale\") || \"1\"\n          : this.props.mode === \"letterSpacing\"\n          ? StorageUtil.getReaderConfig(\"letterSpacing\") || \"0\"\n          : this.props.mode === \"paraSpacing\"\n          ? StorageUtil.getReaderConfig(\"paraSpacing\") || \"0\"\n          : this.props.mode === \"brightness\"\n          ? StorageUtil.getReaderConfig(\"brightness\") || \"1\"\n          : StorageUtil.getReaderConfig(\"margin\") || \"60\",\n    };\n  }\n  handleRest = () => {\n    if (this.props.mode === \"scale\" || this.props.mode === \"margin\") {\n      if (isElectron) {\n        toast(this.props.t(\"Take effect at next startup\"));\n      } else {\n        window.location.reload();\n      }\n      return;\n    }\n    this.props.renderBookFunc();\n  };\n  onValueChange = (event: any) => {\n    if (this.props.mode === \"fontSize\") {\n      const fontSize = event.target.value;\n      this.setState({ value: fontSize });\n      StorageUtil.setReaderConfig(\"fontSize\", fontSize);\n    } else if (this.props.mode === \"scale\") {\n      const scale = event.target.value;\n      this.setState({ value: scale });\n      StorageUtil.setReaderConfig(\"scale\", scale);\n    } else if (this.props.mode === \"letterSpacing\") {\n      const letterSpacing = event.target.value;\n      this.setState({ value: letterSpacing });\n      StorageUtil.setReaderConfig(\"letterSpacing\", letterSpacing);\n    } else if (this.props.mode === \"paraSpacing\") {\n      const paraSpacing = event.target.value;\n      this.setState({ value: paraSpacing });\n      StorageUtil.setReaderConfig(\"paraSpacing\", paraSpacing);\n    } else if (this.props.mode === \"brightness\") {\n      const brightness = event.target.value;\n      this.setState({ value: brightness });\n      StorageUtil.setReaderConfig(\"brightness\", brightness);\n    } else {\n      const margin = event.target.value;\n      this.setState({ value: margin });\n      StorageUtil.setReaderConfig(\"margin\", margin);\n    }\n  };\n  //使进度百分比随拖动实时变化\n  onValueInput = (event: any) => {\n    this.setState({ value: event.target.value });\n  };\n  handleMinus = (step: number) => {\n    this.setState({ value: parseFloat(this.state.value) - step + \"\" });\n    this.onValueChange({\n      target: { value: parseFloat(this.state.value) - step + \"\" },\n    });\n  };\n  handleAdd = (step: number) => {\n    this.setState({ value: parseFloat(this.state.value) + step + \"\" });\n    this.onValueChange({\n      target: { value: parseFloat(this.state.value) + step + \"\" },\n    });\n  };\n  render() {\n    return (\n      <div className=\"font-size-setting\">\n        <div className=\"font-size-title\">\n          <Trans>{this.props.title}</Trans>\n          <input\n            className=\"input-value\"\n            defaultValue={this.state.value}\n            type=\"number\"\n            step={\n              this.props.title === \"Page Width\" ||\n              this.props.title === \"Brightness\"\n                ? \"0.1\"\n                : \"1\"\n            }\n            onBlur={(event) => {\n              this.onValueChange(event);\n              this.handleRest();\n            }}\n          />\n          <span style={{ marginLeft: \"10px\" }}>{this.state.value}</span>\n        </div>\n\n        <span className=\"ultra-small-size\">{this.props.minLabel}</span>\n        <div className=\"font-size-selector\">\n          <input\n            className=\"input-progress\"\n            defaultValue={this.state.value}\n            type=\"range\"\n            max={this.props.maxValue}\n            min={this.props.minValue}\n            step={this.props.step}\n            onInput={(event) => {\n              this.onValueChange(event);\n            }}\n            onChange={(event) => {\n              this.onValueInput(event);\n            }}\n            onMouseUp={() => {\n              this.handleRest();\n            }}\n          />\n        </div>\n        {\n          <span\n            className=\"ultra-large-size\"\n            style={{ fontSize: \"16px\", right: \"5px\" }}\n          >\n            {this.props.maxLabel}\n          </span>\n        }\n      </div>\n    );\n  }\n}\n\nexport default SliderList;\n","import { connect } from \"react-redux\";\nimport { withTranslation } from \"react-i18next\";\nimport SliderList from \"./component\";\nimport { stateType } from \"../../../store\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    renderBookFunc: state.book.renderBookFunc,\n  };\n};\nconst actionCreator = {};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(SliderList as any));\n","//图书样式设置的下拉菜单页面\nimport React from \"react\";\nimport { dropdownList } from \"../../../constants/dropdownList\";\nimport \"./dropdownList.css\";\nimport { Trans } from \"react-i18next\";\nimport { DropdownListProps, DropdownListState } from \"./interface\";\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\nimport { isElectron } from \"react-device-detect\";\nclass DropdownList extends React.Component<\n  DropdownListProps,\n  DropdownListState\n> {\n  constructor(props: DropdownListProps) {\n    super(props);\n    this.state = {\n      currentFontFamilyIndex: dropdownList[0].option.findIndex((item: any) => {\n        return (\n          item ===\n          (StorageUtil.getReaderConfig(\"fontFamily\") || \"Built-in font\")\n        );\n      }),\n      currentLineHeightIndex: dropdownList[1].option.findIndex((item: any) => {\n        return (\n          item === (StorageUtil.getReaderConfig(\"lineHeight\") || \"Default\")\n        );\n      }),\n      currentTextAlignIndex: dropdownList[2].option.findIndex((item: any) => {\n        return item === (StorageUtil.getReaderConfig(\"textAlign\") || \"Default\");\n      }),\n      chineseConversionIndex: dropdownList[3].option.findIndex((item: any) => {\n        return (\n          item === (StorageUtil.getReaderConfig(\"convertChinese\") || \"Default\")\n        );\n      }),\n    };\n  }\n  componentDidMount() {\n    //使下拉菜单选中预设的值\n    if (isElectron) {\n      const fontList = window.require(\"font-list\");\n      fontList.getFonts({ disableQuoting: true }).then((result) => {\n        if (!result || result.length === 0) return;\n        dropdownList[0].option = result;\n        dropdownList[0].option.push(\"Built-in font\");\n        this.setState(\n          {\n            currentFontFamilyIndex: dropdownList[0].option.findIndex(\n              (item: any) => {\n                return (\n                  item ===\n                  (StorageUtil.getReaderConfig(\"fontFamily\") || \"Built-in font\")\n                );\n              }\n            ),\n          },\n          () => {\n            document\n              .querySelector(\".paragraph-character-setting\")!\n              .children[0].children[1].children[\n                this.state.currentFontFamilyIndex === -1\n                  ? 0\n                  : this.state.currentFontFamilyIndex\n              ]?.setAttribute(\"selected\", \"selected\");\n          }\n        );\n      });\n    }\n\n    document\n      .querySelector(\".paragraph-character-setting\")!\n      .children[1].children[1].children[\n        this.state.currentLineHeightIndex\n      ]?.setAttribute(\"selected\", \"selected\");\n    document\n      .querySelector(\".paragraph-character-setting\")!\n      .children[2].children[1].children[\n        this.state.currentTextAlignIndex\n      ]?.setAttribute(\"selected\", \"selected\");\n    document\n      .querySelector(\".paragraph-character-setting\")!\n      .children[3].children[1].children[\n        this.state.chineseConversionIndex\n      ]?.setAttribute(\"selected\", \"selected\");\n  }\n\n  //切换不同的样式\n  handleView(event: any, option: string) {\n    let arr = event.target.value.split(\",\");\n    StorageUtil.setReaderConfig(option, arr[0]);\n    switch (option) {\n      case \"fontFamily\":\n        this.setState({\n          currentFontFamilyIndex: arr[1],\n        });\n\n        break;\n\n      case \"lineHeight\":\n        this.setState({\n          currentLineHeightIndex: arr[1],\n        });\n\n        break;\n      case \"textAlign\":\n        this.setState({\n          currentTextAlignIndex: arr[1],\n        });\n\n        break;\n      case \"convertChinese\":\n        this.setState({\n          chineseConversionIndex: arr[1],\n        });\n\n        break;\n      default:\n        break;\n    }\n    this.props.renderBookFunc();\n  }\n  render() {\n    const renderParagraphCharacter = () => {\n      return dropdownList.map((item) => (\n        <li className=\"paragraph-character-container\" key={item.id}>\n          <p className=\"general-setting-title\">\n            <Trans>{item.title}</Trans>\n          </p>\n          <select\n            name=\"\"\n            className=\"general-setting-dropdown\"\n            onChange={(event) => {\n              this.handleView(event, item.value);\n            }}\n          >\n            {item.option.map((subItem: string, index: number) => (\n              <option\n                value={[subItem, index.toString()]}\n                key={index}\n                className=\"general-setting-option\"\n              >\n                {this.props.t(subItem)}\n              </option>\n            ))}\n          </select>\n        </li>\n      ));\n    };\n\n    return (\n      <ul className=\"paragraph-character-setting\">\n        {renderParagraphCharacter()}\n      </ul>\n    );\n  }\n}\n\nexport default DropdownList;\n","import { connect } from \"react-redux\";\nimport { withTranslation } from \"react-i18next\";\nimport DropdownList from \"./component\";\nimport { stateType } from \"../../../store\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    renderBookFunc: state.book.renderBookFunc,\n  };\n};\nconst actionCreator = {};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(DropdownList as any));\n","import React from \"react\";\nimport \"./modeControl.css\";\nimport { ModeControlProps, ModeControlState } from \"./interface\";\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\nimport { Trans } from \"react-i18next\";\nimport { Tooltip } from \"react-tippy\";\nimport { isElectron } from \"react-device-detect\";\nimport toast from \"react-hot-toast\";\n\nclass ModeControl extends React.Component<ModeControlProps, ModeControlState> {\n  constructor(props: ModeControlProps) {\n    super(props);\n    this.state = {\n      readerMode: StorageUtil.getReaderConfig(\"readerMode\") || \"double\",\n    };\n  }\n\n  handleChangeMode = (mode: string) => {\n    this.setState({ readerMode: mode });\n    StorageUtil.setReaderConfig(\"readerMode\", mode);\n    if (isElectron) {\n      toast(this.props.t(\"Take effect at next startup\"));\n    } else {\n      window.location.reload();\n    }\n  };\n  render() {\n    return (\n      <div className=\"background-color-setting\">\n        <div\n          className=\"background-color-text\"\n          style={{ position: \"relative\", bottom: \"15px\" }}\n        >\n          <Trans>View Mode</Trans>\n        </div>\n        <div className=\"single-control-container\">\n          <Tooltip\n            title={this.props.t(\"Single-Page Mode\")}\n            position=\"top\"\n            trigger=\"mouseenter\"\n          >\n            <div\n              className=\"single-mode-container\"\n              onClick={() => {\n                this.handleChangeMode(\"single\");\n              }}\n              style={this.state.readerMode === \"single\" ? {} : { opacity: 0.4 }}\n            >\n              <span className=\"icon-single-page single-page-icon\"></span>\n            </div>\n          </Tooltip>\n          <Tooltip\n            title={this.props.t(\"Double-Page Mode\")}\n            position=\"top\"\n            trigger=\"mouseenter\"\n          >\n            <div\n              className=\"double-mode-container\"\n              onClick={() => {\n                this.handleChangeMode(\"double\");\n              }}\n              style={this.state.readerMode === \"double\" ? {} : { opacity: 0.4 }}\n            >\n              <span className=\"icon-two-page two-page-icon\"></span>\n            </div>\n          </Tooltip>\n          <Tooltip\n            title={this.props.t(\"Scroll Mode\")}\n            position=\"top\"\n            trigger=\"mouseenter\"\n          >\n            <div\n              className=\"double-mode-container\"\n              onClick={() => {\n                this.handleChangeMode(\"scroll\");\n              }}\n              style={this.state.readerMode === \"scroll\" ? {} : { opacity: 0.4 }}\n            >\n              <span className=\"icon-scroll two-page-icon\"></span>\n            </div>\n          </Tooltip>\n        </div>\n      </div>\n    );\n  }\n}\nexport default ModeControl;\n","import { connect } from \"react-redux\";\nimport { withTranslation } from \"react-i18next\";\nimport ModeControl from \"./component\";\nimport { stateType } from \"../../../store\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    renderBookFunc: state.book.renderBookFunc,\n  };\n};\nconst actionCreator = {};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(ModeControl as any));\n","export const sleep = (time: number) => {\n  return new Promise((resolve) => setTimeout(resolve, time));\n};\n","import React from \"react\";\nimport { TextToSpeechProps, TextToSpeechState } from \"./interface\";\nimport { Trans } from \"react-i18next\";\nimport { speedList } from \"../../constants/dropdownList\";\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\nimport { sleep } from \"../../utils/commonUtil\";\n\nclass TextToSpeech extends React.Component<\n  TextToSpeechProps,\n  TextToSpeechState\n> {\n  constructor(props: TextToSpeechProps) {\n    super(props);\n    this.state = {\n      isSupported: false,\n      isAudioOn: false,\n      voices: [],\n    };\n  }\n  componentDidMount() {\n    if (\"speechSynthesis\" in window) {\n      this.setState({ isSupported: true });\n    }\n    if (this.state.isAudioOn) {\n      window.speechSynthesis && window.speechSynthesis.cancel();\n      this.setState({ isAudioOn: false });\n    }\n    let synth = window.speechSynthesis;\n    synth.getVoices();\n  }\n  handleChangeAudio = () => {\n    if (this.state.isAudioOn) {\n      window.speechSynthesis.cancel();\n      this.setState({ isAudioOn: false });\n    } else {\n      const setSpeech = () => {\n        return new Promise((resolve, reject) => {\n          let synth = window.speechSynthesis;\n          let id;\n\n          id = setInterval(() => {\n            if (synth.getVoices().length !== 0) {\n              resolve(synth.getVoices());\n              clearInterval(id);\n            } else {\n              this.setState({ isSupported: false });\n            }\n          }, 10);\n        });\n      };\n\n      let s = setSpeech();\n      s.then((voices) => {\n        this.setState({ voices }, () => {\n          this.setState({ isAudioOn: true }, () => {\n            this.handleAudio();\n            if (\n              document.querySelector(\"#text-speech-speed\") &&\n              document.querySelector(\"#text-speech-voice\") &&\n              document.querySelector(\"#text-speech-speed\")!.children[0] &&\n              document.querySelector(\"#text-speech-voice\")!.children[0]\n            ) {\n              document\n                .querySelector(\"#text-speech-speed\")!\n                .children[\n                  speedList.option.indexOf(\n                    StorageUtil.getReaderConfig(\"voiceSpeed\") || \"1\"\n                  )\n                ]?.setAttribute(\"selected\", \"selected\");\n              document\n                .querySelector(\"#text-speech-voice\")!\n                .children[\n                  StorageUtil.getReaderConfig(\"voiceIndex\") || 0\n                ]?.setAttribute(\"selected\", \"selected\");\n            }\n          });\n        });\n      });\n    }\n  };\n  handleAudio = async () => {\n    let text = \"\";\n    if (StorageUtil.getReaderConfig(\"isSliding\") === \"yes\") {\n      await sleep(1000);\n    }\n    text = await this.props.htmlBook.rendition.visibleText();\n    text = text\n      .replace(/\\s\\s/g, \"\")\n      .replace(/\\r/g, \"\")\n      .replace(/\\n/g, \"\")\n      .replace(/\\t/g, \"\")\n      .replace(/\\f/g, \"\");\n    this.handleSpeech(\n      text,\n      StorageUtil.getReaderConfig(\"voiceIndex\") || 0,\n      StorageUtil.getReaderConfig(\"voiceSpeed\") || 1\n    );\n  };\n  handleSpeech = (text: string, voiceIndex: number, speed: number) => {\n    var msg = new SpeechSynthesisUtterance();\n    msg.text = text;\n    msg.voice = window.speechSynthesis.getVoices()[voiceIndex];\n    msg.rate = speed;\n    window.speechSynthesis.speak(msg);\n    msg.onerror = (err) => {\n      console.log(err);\n    };\n\n    msg.onend = (event) => {\n      if (!(this.state.isAudioOn && this.props.isReading)) {\n        return;\n      }\n      this.props.htmlBook.rendition.next();\n      this.handleAudio();\n    };\n  };\n\n  render() {\n    return (\n      <>\n        {this.state.isSupported ? (\n          <>\n            <div className=\"single-control-switch-container\">\n              <span className=\"single-control-switch-title\">\n                <Trans>Turn on text-to-speech</Trans>\n              </span>\n\n              <span\n                className=\"single-control-switch\"\n                onClick={() => {\n                  this.handleChangeAudio();\n                }}\n                style={this.state.isAudioOn ? {} : { opacity: 0.6 }}\n              >\n                <span\n                  className=\"single-control-button\"\n                  style={\n                    this.state.isAudioOn\n                      ? {\n                          transform: \"translateX(20px)\",\n                          transition: \"transform 0.5s ease\",\n                        }\n                      : {\n                          transform: \"translateX(0px)\",\n                          transition: \"transform 0.5s ease\",\n                        }\n                  }\n                ></span>\n              </span>\n            </div>\n            {this.state.isAudioOn && this.state.voices.length > 0 && (\n              <div\n                className=\"setting-dialog-new-title\"\n                style={{\n                  marginLeft: \"20px\",\n                  width: \"88%\",\n                  marginTop: \"20px\",\n                  fontWeight: 500,\n                }}\n              >\n                <Trans>Voice</Trans>\n                <select\n                  name=\"\"\n                  className=\"lang-setting-dropdown\"\n                  id=\"text-speech-voice\"\n                  onChange={(event) => {\n                    StorageUtil.setReaderConfig(\n                      \"voiceIndex\",\n                      event.target.value\n                    );\n                    window.speechSynthesis.cancel();\n                  }}\n                >\n                  {this.state.voices.map((item, index) => {\n                    return (\n                      <option\n                        value={index}\n                        key={item.name}\n                        className=\"lang-setting-option\"\n                      >\n                        {item.name}\n                      </option>\n                    );\n                  })}\n                </select>\n              </div>\n            )}\n            {this.state.isAudioOn && (\n              <div\n                className=\"setting-dialog-new-title\"\n                style={{ marginLeft: \"20px\", width: \"88%\", fontWeight: 500 }}\n              >\n                <Trans>Speed</Trans>\n                <select\n                  name=\"\"\n                  id=\"text-speech-speed\"\n                  className=\"lang-setting-dropdown\"\n                  onChange={(event) => {\n                    StorageUtil.setReaderConfig(\n                      \"voiceSpeed\",\n                      event.target.value\n                    );\n                    window.speechSynthesis.cancel();\n                  }}\n                >\n                  {speedList.option.map((item) => (\n                    <option value={item} className=\"lang-setting-option\">\n                      {item}\n                    </option>\n                  ))}\n                </select>\n              </div>\n            )}\n          </>\n        ) : null}\n      </>\n    );\n  }\n}\n\nexport default TextToSpeech;\n","import { withTranslation } from \"react-i18next\";\nimport { connect } from \"react-redux\";\nimport TextToSpeech from \"./component\";\nimport { stateType } from \"../../store\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentBook: state.book.currentBook,\n    htmlBook: state.reader.htmlBook,\n    locations: state.progressPanel.locations,\n    isReading: state.book.isReading,\n  };\n};\nconst actionCreator = {};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(TextToSpeech as any));\n","import React from \"react\";\nimport { SettingSwitchProps, SettingSwitchState } from \"./interface\";\nimport { Trans } from \"react-i18next\";\nimport TextToSpeech from \"../../textToSpeech\";\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\nimport { readerSettingList } from \"../../../constants/settingList\";\nimport { isElectron } from \"react-device-detect\";\nimport toast from \"react-hot-toast\";\nclass SettingSwitch extends React.Component<\n  SettingSwitchProps,\n  SettingSwitchState\n> {\n  constructor(props: SettingSwitchProps) {\n    super(props);\n    this.state = {\n      isBold: StorageUtil.getReaderConfig(\"isBold\") === \"yes\",\n      isIndent: StorageUtil.getReaderConfig(\"isIndent\") === \"yes\",\n      isSliding: StorageUtil.getReaderConfig(\"isSliding\") === \"yes\",\n      isUnderline: StorageUtil.getReaderConfig(\"isUnderline\") === \"yes\",\n      isShadow: StorageUtil.getReaderConfig(\"isShadow\") === \"yes\",\n      isItalic: StorageUtil.getReaderConfig(\"isItalic\") === \"yes\",\n      isInvert: StorageUtil.getReaderConfig(\"isInvert\") === \"yes\",\n      isHideBackground:\n        StorageUtil.getReaderConfig(\"isHideBackground\") === \"yes\",\n      isHideFooter: StorageUtil.getReaderConfig(\"isHideFooter\") === \"yes\",\n      isHideHeader: StorageUtil.getReaderConfig(\"isHideHeader\") === \"yes\",\n      isHidePageButton:\n        StorageUtil.getReaderConfig(\"isHidePageButton\") === \"yes\",\n      isHideMenuButton:\n        StorageUtil.getReaderConfig(\"isHideMenuButton\") === \"yes\",\n    };\n  }\n\n  _handleRest = () => {\n    if (isElectron) {\n      toast(this.props.t(\"Take effect at next startup\"));\n    } else {\n      window.location.reload();\n    }\n  };\n\n  _handleChange = (stateName: string) => {\n    this.setState({ [stateName]: !this.state[stateName] } as any, () => {\n      StorageUtil.setReaderConfig(\n        stateName,\n        this.state[stateName] ? \"yes\" : \"no\"\n      );\n      toast(this.props.t(\"Change Successfully\"));\n      setTimeout(() => {\n        this.props.renderBookFunc();\n      }, 500);\n    });\n  };\n\n  handleChange = (stateName: string) => {\n    this.setState({ [stateName]: !this.state[stateName] } as any);\n    StorageUtil.setReaderConfig(\n      stateName,\n      this.state[stateName] ? \"no\" : \"yes\"\n    );\n\n    toast(this.props.t(\"Change Successfully\"));\n    setTimeout(() => {\n      this._handleRest();\n    }, 500);\n  };\n  render() {\n    return (\n      <>\n        <TextToSpeech />\n        {readerSettingList.map((item) => (\n          <div className=\"single-control-switch-container\" key={item.title}>\n            <span className=\"single-control-switch-title\">\n              <Trans>{item.title}</Trans>\n            </span>\n\n            <span\n              className=\"single-control-switch\"\n              onClick={() => {\n                switch (item.propName) {\n                  case \"isBold\":\n                    this._handleChange(\"isBold\");\n                    break;\n                  case \"isIndent\":\n                    this._handleChange(\"isIndent\");\n                    break;\n                  case \"isSliding\":\n                    this._handleChange(\"isSliding\");\n                    break;\n                  case \"isItalic\":\n                    this._handleChange(\"isItalic\");\n                    break;\n                  case \"isUnderline\":\n                    this._handleChange(\"isUnderline\");\n                    break;\n                  case \"isShadow\":\n                    this._handleChange(\"isShadow\");\n                    break;\n                  case \"isInvert\":\n                    this._handleChange(\"isInvert\");\n                    break;\n                  case \"isHideFooter\":\n                    this.handleChange(\"isHideFooter\");\n                    break;\n                  case \"isHideHeader\":\n                    this.handleChange(\"isHideHeader\");\n                    break;\n                  case \"isHideBackground\":\n                    this.handleChange(\"isHideBackground\");\n                    break;\n                  case \"isHidePageButton\":\n                    this.handleChange(\"isHidePageButton\");\n                    break;\n                  case \"isHideMenuButton\":\n                    this.handleChange(\"isHideMenuButton\");\n                    break;\n                  default:\n                    break;\n                }\n              }}\n              style={this.state[item.propName] ? {} : { opacity: 0.6 }}\n            >\n              <span\n                className=\"single-control-button\"\n                style={\n                  !this.state[item.propName]\n                    ? {\n                        transform: \"translateX(0px)\",\n                        transition: \"transform 0.5s ease\",\n                      }\n                    : {\n                        transform: \"translateX(20px)\",\n                        transition: \"transform 0.5s ease\",\n                      }\n                }\n              ></span>\n            </span>\n          </div>\n        ))}\n      </>\n    );\n  }\n}\n\nexport default SettingSwitch;\n","import { withTranslation } from \"react-i18next\";\nimport { connect } from \"react-redux\";\nimport SettingSwitch from \"./component\";\nimport { stateType } from \"../../../store\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentBook: state.book.currentBook,\n    locations: state.progressPanel.locations,\n    isReading: state.book.isReading,\n    renderBookFunc: state.book.renderBookFunc,\n  };\n};\nconst actionCreator = {};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(SettingSwitch as any));\n","import React from \"react\";\nimport \"./settingPanel.css\";\nimport ThemeList from \"../../../components/readerSettings/themeList\";\nimport SliderList from \"../../../components/readerSettings/sliderList\";\nimport DropdownList from \"../../../components/readerSettings/dropdownList\";\nimport ModeControl from \"../../../components/readerSettings/modeControl\";\nimport SettingSwitch from \"../../../components/readerSettings/settingSwitch\";\nimport { SettingPanelProps, SettingPanelState } from \"./interface\";\nimport { Trans } from \"react-i18next\";\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\nimport { Tooltip } from \"react-tippy\";\n\nclass SettingPanel extends React.Component<\n  SettingPanelProps,\n  SettingPanelState\n> {\n  constructor(props: SettingPanelProps) {\n    super(props);\n    this.state = {\n      readerMode: StorageUtil.getReaderConfig(\"readerMode\") || \"double\",\n      isSettingLocked:\n        StorageUtil.getReaderConfig(\"isSettingLocked\") === \"yes\" ? true : false,\n    };\n  }\n\n  handleLock = () => {\n    this.setState({ isSettingLocked: !this.state.isSettingLocked }, () => {\n      StorageUtil.setReaderConfig(\n        \"isSettingLocked\",\n        this.state.isSettingLocked ? \"yes\" : \"no\"\n      );\n    });\n  };\n\n  render() {\n    return (\n      <div className=\"setting-panel-parent\">\n        <Tooltip\n          title={this.props.t(this.state.isSettingLocked ? \"Unlock\" : \"Lock\")}\n          position=\"bottom\"\n          trigger=\"mouseenter\"\n          style={{ height: \"30px\", display: \"inline-block\", float: \"left\" }}\n        >\n          <span\n            className={\n              this.state.isSettingLocked\n                ? \"icon-lock lock-icon\"\n                : \"icon-unlock lock-icon\"\n            }\n            onClick={() => {\n              this.handleLock();\n            }}\n          ></span>\n        </Tooltip>\n        <div className=\"setting-panel-title\">\n          <Trans>Reading Option</Trans>\n        </div>\n        <div className=\"setting-panel\">\n          <ModeControl />\n          <ThemeList />\n          <SliderList\n            {...{\n              maxValue: 40,\n              minValue: 13,\n              mode: \"fontSize\",\n              minLabel: \"13\",\n              maxLabel: \"40\",\n              step: 1,\n              title: \"Font Size\",\n            }}\n          />\n\n          {this.state.readerMode && this.state.readerMode === \"double\" && (\n            <SliderList\n              {...{\n                maxValue: 80,\n                minValue: 0,\n                mode: \"margin\",\n                minLabel: \"0\",\n                maxLabel: \"80\",\n                step: 5,\n                title: \"Margin\",\n              }}\n            />\n          )}\n\n          <SliderList\n            {...{\n              maxValue: 20,\n              minValue: 0,\n              mode: \"letterSpacing\",\n              minLabel: \"0\",\n              maxLabel: \"20\",\n              step: 1,\n              title: \"Letter Spacing\",\n            }}\n          />\n\n          <SliderList\n            {...{\n              maxValue: 60,\n              minValue: 0,\n              mode: \"paraSpacing\",\n              minLabel: \"0\",\n              maxLabel: \"60\",\n              step: 1,\n              title: \"Paragraph Spacing\",\n            }}\n          />\n\n          {this.state.readerMode && this.state.readerMode !== \"double\" ? (\n            <SliderList\n              {...{\n                maxValue: 3,\n                minValue: 0.5,\n                mode: \"scale\",\n                minLabel: \"0.5\",\n                maxLabel: \"3\",\n                step: 0.1,\n                title: \"Page Width\",\n              }}\n            />\n          ) : null}\n          <SliderList\n            {...{\n              maxValue: 2,\n              minValue: 0.5,\n              mode: \"brightness\",\n              minLabel: \"0.5\",\n              maxLabel: \"2\",\n              step: 0.1,\n              title: \"Brightness\",\n            }}\n          />\n          <DropdownList />\n          <SettingSwitch />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default SettingPanel;\n","import { withTranslation } from \"react-i18next\";\nimport { connect } from \"react-redux\";\nimport SettingPanel from \"./component\";\nimport { stateType } from \"../../../store\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentBook: state.book.currentBook,\n    locations: state.progressPanel.locations,\n    isReading: state.book.isReading,\n  };\n};\nconst actionCreator = {};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(SettingPanel as any));\n","import React from \"react\";\nimport \"./contentList.css\";\nimport { ContentListProps, ContentListState } from \"./interface\";\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\nimport _ from \"underscore\";\nimport RecordLocation from \"../../../utils/readUtils/recordLocation\";\nclass ContentList extends React.Component<ContentListProps, ContentListState> {\n  constructor(props: ContentListProps) {\n    super(props);\n    this.state = {\n      chapters: [],\n      isCollapsed: true,\n      currentIndex: -1,\n      isExpandContent: StorageUtil.getReaderConfig(\"isExpandContent\") === \"yes\",\n    };\n    this.handleJump = this.handleJump.bind(this);\n  }\n  componentDidMount() {\n    this.props.htmlBook &&\n      this.setState({\n        chapters: this.props.htmlBook.chapters,\n      });\n  }\n  flatChapter(chapters: any) {\n    let newChapter: any = [];\n    for (let i = 0; i < chapters.length; i++) {\n      if (chapters[i].subitems[0]) {\n        newChapter.push(chapters[i]);\n        newChapter = newChapter.concat(this.flatChapter(chapters[i].subitems));\n      } else {\n        newChapter.push(chapters[i]);\n      }\n    }\n    return newChapter;\n  }\n  handleJump(event: any) {\n    event.preventDefault();\n    let href = event.target.getAttribute(\"href\");\n    let title =\n      this.props.htmlBook.flattenChapters[\n        _.findIndex(this.props.htmlBook.flattenChapters, { href })\n      ].label;\n    RecordLocation.recordHtmlLocation(\n      this.props.currentBook.key,\n      \"test\",\n      title,\n      \"test\",\n      \"0\",\n      \"\"\n    );\n    this.props.htmlBook.rendition.goToChapter(title);\n    this.props.handleCurrentChapter(title);\n  }\n  UNSAFE_componentWillReceiveProps(nextProps: ContentListProps) {\n    if (nextProps.htmlBook && nextProps.htmlBook !== this.props.htmlBook) {\n      this.setState({ chapters: nextProps.htmlBook.chapters });\n    }\n  }\n  render() {\n    const renderContentList = (items: any, level: number) => {\n      level++;\n      return items.map((item: any, index: number) => {\n        return (\n          <li key={index} className=\"book-content-list\">\n            {item.subitems.length > 0 &&\n              level <= 2 &&\n              !this.state.isExpandContent && (\n                <span\n                  className=\"icon-dropdown content-dropdown\"\n                  onClick={() => {\n                    this.setState({\n                      currentIndex:\n                        this.state.currentIndex === index ? -1 : index,\n                    });\n                  }}\n                  style={\n                    this.state.currentIndex === index\n                      ? {}\n                      : { transform: \"rotate(-90deg)\" }\n                  }\n                ></span>\n              )}\n\n            <a\n              href={item.href}\n              onClick={this.handleJump}\n              className=\"book-content-name\"\n            >\n              {item.label.indexOf(\"#\") > -1\n                ? item.label.split(\"#\")[0]\n                : item.label}\n            </a>\n            {item.subitems.length > 0 &&\n            (this.state.currentIndex === index ||\n              level > 2 ||\n              this.state.isExpandContent) ? (\n              <ul>{renderContentList(item.subitems, level)}</ul>\n            ) : null}\n          </li>\n        );\n      });\n    };\n\n    return (\n      <div className=\"book-content-container\">\n        <ul className=\"book-content\">\n          {this.state.chapters && renderContentList(this.state.chapters, 1)}\n        </ul>\n      </div>\n    );\n  }\n}\n\nexport default ContentList;\n","import { connect } from \"react-redux\";\nimport { stateType } from \"../../../store\";\nimport ContentList from \"./component\";\nimport { handleCurrentChapter } from \"../../../store/actions\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentBook: state.book.currentBook,\n    chapters: state.reader.chapters,\n    htmlBook: state.reader.htmlBook,\n    renderBookFunc: state.book.renderBookFunc,\n  };\n};\nconst actionCreator = { handleCurrentChapter };\nexport default connect(mapStateToProps, actionCreator)(ContentList);\n","import React from \"react\";\nimport \"./navList.css\";\nimport { Trans } from \"react-i18next\";\nimport { NavListProps, NavListState } from \"./interface\";\nimport DeleteIcon from \"../../../components/deleteIcon\";\nimport toast from \"react-hot-toast\";\nclass NavList extends React.Component<NavListProps, NavListState> {\n  constructor(props: NavListProps) {\n    super(props);\n    this.state = {\n      deleteIndex: -1,\n    };\n  }\n  //跳转到图书的指定位置\n  async handleJump(cfi: string) {\n    if (!cfi) {\n      toast(this.props.t(\"Wrong bookmark\"));\n      return;\n    }\n    let bookLocation;\n    try {\n      bookLocation = JSON.parse(cfi) || {};\n    } catch (error) {\n      bookLocation = {\n        cfi: cfi,\n      };\n    }\n\n    await this.props.htmlBook.rendition.goToPosition(\n      JSON.stringify({\n        text: bookLocation.text,\n        chapterTitle: bookLocation.chapterTitle,\n        count: bookLocation.count,\n        percentage: bookLocation.percentage,\n        cfi: bookLocation.cfi,\n      })\n    );\n  }\n  handleShowDelete = (index: number) => {\n    this.setState({ deleteIndex: index });\n  };\n  render() {\n    let currentData: any = (\n      (this.props.currentTab === \"bookmarks\"\n        ? this.props.bookmarks\n        : this.props.currentTab === \"notes\"\n        ? this.props.notes.filter((item) => item.notes !== \"\")\n        : this.props.digests) as any\n    ).filter((item: any) => {\n      return item.bookKey === this.props.currentBook.key;\n    });\n    const renderBookNavList = () => {\n      return currentData.reverse().map((item: any, index: number) => {\n        const bookmarkProps = {\n          itemKey: item.key,\n          mode: this.props.currentTab === \"bookmarks\" ? \"bookmarks\" : \"notes\",\n        };\n        return (\n          <li\n            className=\"book-bookmark-list\"\n            key={item.key}\n            onMouseEnter={() => {\n              this.handleShowDelete(index);\n            }}\n            onMouseLeave={() => {\n              this.handleShowDelete(-1);\n            }}\n          >\n            <p className=\"book-bookmark-digest\">\n              {this.props.currentTab === \"bookmarks\"\n                ? item.label\n                : this.props.currentTab === \"notes\"\n                ? item.notes\n                : item.text}\n            </p>\n            <div className=\"bookmark-page-list-item-title\">\n              <Trans>{item.chapter}</Trans>\n            </div>\n            <div className=\"book-bookmark-progress\">\n              {Math.floor(item.percentage * 100)}%\n            </div>\n            {this.state.deleteIndex === index ? (\n              <DeleteIcon {...bookmarkProps} />\n            ) : null}\n            <div\n              className=\"book-bookmark-link\"\n              onClick={() => {\n                this.handleJump(item.cfi);\n              }}\n              style={{ cursor: \"pointer\" }}\n            >\n              <Trans>Go To</Trans>\n            </div>\n          </li>\n        );\n      });\n    };\n    if (!currentData[0]) {\n      return (\n        <div className=\"navigation-panel-empty-bookmark\">\n          <Trans>Empty</Trans>\n        </div>\n      );\n    }\n    return (\n      <div className=\"book-bookmark-container\">\n        <ul className=\"book-bookmark\">{renderBookNavList()}</ul>\n      </div>\n    );\n  }\n}\n\nexport default NavList;\n","import { connect } from \"react-redux\";\nimport { stateType } from \"../../../store\";\nimport { withTranslation } from \"react-i18next\";\nimport NavList from \"./component\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentBook: state.book.currentBook,\n    htmlBook: state.reader.htmlBook,\n\n    bookmarks: state.reader.bookmarks,\n    notes: state.reader.notes,\n    digests: state.reader.digests,\n  };\n};\nconst actionCreator = {};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(NavList as any));\n","import React from \"react\";\nimport \"./navigationPanel.css\";\nimport ContentList from \"../../lists/contentList\";\nimport BookNavList from \"../../lists/navList\";\nimport { Trans } from \"react-i18next\";\nimport { NavigationPanelProps, NavigationPanelState } from \"./interface\";\nimport SearchBox from \"../../../components/searchBox\";\nimport Parser from \"html-react-parser\";\nimport EmptyCover from \"../../../components/emptyCover\";\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\nimport { Tooltip } from \"react-tippy\";\n\nclass NavigationPanel extends React.Component<\n  NavigationPanelProps,\n  NavigationPanelState\n> {\n  constructor(props: NavigationPanelProps) {\n    super(props);\n    this.state = {\n      currentTab: \"contents\",\n      chapters: [],\n      isSearch: false,\n      searchList: null,\n      startIndex: 0,\n      currentIndex: 0,\n      isNavLocked:\n        StorageUtil.getReaderConfig(\"isNavLocked\") === \"yes\" ? true : false,\n    };\n  }\n  handleSearchState = (isSearch: boolean) => {\n    this.setState({ isSearch });\n  };\n  handleSearchList = (searchList: any) => {\n    this.setState({ searchList });\n  };\n  componentDidMount() {\n    this.props.handleFetchBookmarks();\n  }\n\n  handleChangeTab = (currentTab: string) => {\n    this.setState({ currentTab });\n  };\n  handleLock = () => {\n    this.setState({ isNavLocked: !this.state.isNavLocked }, () => {\n      StorageUtil.setReaderConfig(\n        \"isNavLocked\",\n        this.state.isNavLocked ? \"yes\" : \"no\"\n      );\n    });\n  };\n  renderSearchList = () => {\n    if (!this.state.searchList[0]) {\n      return (\n        <div className=\"navigation-panel-empty-bookmark\">\n          <Trans>Empty</Trans>\n        </div>\n      );\n    }\n    return this.state.searchList\n      .slice(\n        this.state.currentIndex * 10,\n        this.state.currentIndex * 10 + 10 > this.state.searchList.length\n          ? this.state.searchList.length\n          : this.state.currentIndex * 10 + 10\n      )\n      .map((item: any, index: number) => {\n        return (\n          <li\n            className=\"nav-search-list-item\"\n            key={index}\n            onClick={async () => {\n              let bookLocation = JSON.parse(item.cfi) || {};\n              await this.props.htmlBook.rendition.goToPosition(\n                JSON.stringify({\n                  text: bookLocation.text,\n                  chapterTitle: bookLocation.chapterTitle,\n                  count: bookLocation.count,\n                  percentage: bookLocation.percentage,\n                  cfi: bookLocation.cfi,\n                })\n              );\n            }}\n          >\n            {Parser(item.excerpt)}\n          </li>\n        );\n      });\n  };\n  renderSearchPage = () => {\n    let startIndex = this.state.startIndex;\n    let currentIndex =\n      startIndex > 0 ? startIndex + 2 : this.state.currentIndex;\n    let pageList: any[] = [];\n    let total = Math.ceil(this.state.searchList.length / 10);\n    if (total <= 5) {\n      for (let i = 0; i < total; i++) {\n        pageList.push(\n          <li\n            className={\n              currentIndex === i\n                ? \"nav-search-page-item active-page \"\n                : \"nav-search-page-item\"\n            }\n            onClick={() => {\n              this.setState({ currentIndex: i });\n            }}\n          >\n            {i + 1}\n          </li>\n        );\n      }\n    } else {\n      for (\n        let i = 0;\n        i < (total - startIndex < 5 ? total - startIndex : 5);\n        i++\n      ) {\n        let isShow = currentIndex > 2 ? i === 2 : currentIndex === i;\n        pageList.push(\n          <li\n            className={\n              isShow\n                ? \"nav-search-page-item active-page \"\n                : \"nav-search-page-item\"\n            }\n            onClick={() => {\n              if (i === 3 && startIndex === 0) {\n                this.setState({\n                  startIndex: 1,\n                  currentIndex: 3,\n                });\n                return;\n              }\n              this.setState({\n                startIndex: currentIndex > 2 ? i + startIndex - 2 : 0,\n                currentIndex: i + startIndex,\n              });\n            }}\n          >\n            {i + startIndex + 1}\n          </li>\n        );\n      }\n      if (total - startIndex < 5) {\n        for (let i = 0; i < 6 - pageList.length; i++) {\n          pageList.push(<li className=\"nav-search-page-item\">EOF</li>);\n        }\n      }\n    }\n    return pageList;\n  };\n  render() {\n    const searchProps = {\n      mode: this.state.isSearch ? \"\" : \"nav\",\n      width: \"100px\",\n      height: \"35px\",\n      isNavSearch: this.state.isSearch,\n      handleSearchState: this.handleSearchState,\n      handleSearchList: this.handleSearchList,\n    };\n    const bookmarkProps = {\n      currentTab: this.state.currentTab,\n    };\n    return (\n      <div className=\"navigation-panel\">\n        {this.state.isSearch ? (\n          <>\n            <div\n              className=\"nav-close-icon\"\n              onClick={() => {\n                this.handleSearchState(false);\n                this.props.handleSearch(false);\n                this.setState({ searchList: null });\n              }}\n            >\n              <span className=\"icon-close\"></span>\n            </div>\n\n            <div\n              className=\"header-search-container\"\n              style={this.state.isSearch ? { left: 40 } : {}}\n            >\n              <div\n                className=\"navigation-search-title\"\n                style={{ height: \"20px\", margin: \"0px 25px 13px\" }}\n              >\n                <Trans>Search in the book</Trans>\n              </div>\n              <SearchBox {...searchProps} />\n            </div>\n            <ul className=\"nav-search-list\">\n              {this.state.searchList ? this.renderSearchList() : null}\n            </ul>\n            <ul className=\"nav-search-page\">\n              {this.state.searchList ? this.renderSearchPage() : null}\n            </ul>\n          </>\n        ) : (\n          <>\n            <div className=\"navigation-header\">\n              <Tooltip\n                title={this.props.t(this.state.isNavLocked ? \"Unlock\" : \"Lock\")}\n                position=\"bottom\"\n                trigger=\"mouseenter\"\n                style={{\n                  position: \"absolute\",\n                  top: 0,\n                  right: 0,\n                  height: \"30px\",\n                }}\n              >\n                <span\n                  className={\n                    this.state.isNavLocked\n                      ? \"icon-lock nav-lock-icon\"\n                      : \"icon-unlock nav-lock-icon\"\n                  }\n                  onClick={() => {\n                    this.handleLock();\n                  }}\n                ></span>\n              </Tooltip>\n\n              {this.props.currentBook.cover &&\n              this.props.currentBook.cover !== \"noCover\" ? (\n                <img\n                  className=\"book-cover\"\n                  src={this.props.currentBook.cover}\n                  alt=\"\"\n                />\n              ) : (\n                <div className=\"book-cover\">\n                  <EmptyCover\n                    {...{\n                      format: this.props.currentBook.format,\n                      title: this.props.currentBook.name,\n                      scale: 0.86,\n                    }}\n                  />\n                </div>\n              )}\n\n              <p className=\"book-title\">{this.props.currentBook.name}</p>\n              <p className=\"book-arthur\">\n                <Trans>Author</Trans>:{\" \"}\n                <Trans>\n                  {this.props.currentBook.author\n                    ? this.props.currentBook.author\n                    : \"Unknown Author\"}\n                </Trans>\n              </p>\n              <span className=\"reading-duration\">\n                <Trans>Reading Time</Trans>: {Math.floor(this.props.time / 60)}\n                &nbsp; min\n              </span>\n              <div className=\"navigation-search-box\">\n                <SearchBox {...searchProps} />\n              </div>\n\n              <div className=\"navigation-navigation\">\n                <span\n                  className=\"book-content-title\"\n                  onClick={() => {\n                    this.handleChangeTab(\"contents\");\n                  }}\n                  style={\n                    this.state.currentTab === \"contents\" ? {} : { opacity: 0.5 }\n                  }\n                >\n                  <Trans>Content</Trans>\n                </span>\n                <span\n                  className=\"book-bookmark-title\"\n                  style={\n                    this.state.currentTab === \"bookmarks\"\n                      ? {}\n                      : { opacity: 0.5 }\n                  }\n                  onClick={() => {\n                    this.handleChangeTab(\"bookmarks\");\n                  }}\n                >\n                  <Trans>Bookmark</Trans>\n                </span>\n                <span\n                  className=\"book-bookmark-title\"\n                  style={\n                    this.state.currentTab === \"notes\" ? {} : { opacity: 0.5 }\n                  }\n                  onClick={() => {\n                    this.handleChangeTab(\"notes\");\n                  }}\n                >\n                  <Trans>Note</Trans>\n                </span>\n                <span\n                  className=\"book-bookmark-title\"\n                  style={\n                    this.state.currentTab === \"digests\" ? {} : { opacity: 0.5 }\n                  }\n                  onClick={() => {\n                    this.handleChangeTab(\"digests\");\n                  }}\n                >\n                  <Trans>Highlight</Trans>\n                </span>\n              </div>\n            </div>\n            <div className=\"navigation-body-parent\">\n              <div className=\"navigation-body\">\n                {this.state.currentTab === \"contents\" ? (\n                  <ContentList />\n                ) : (\n                  <BookNavList {...bookmarkProps} />\n                )}\n              </div>\n            </div>\n          </>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default NavigationPanel;\n","//图书导航栏\nimport { connect } from \"react-redux\";\nimport { handleFetchBookmarks, handleSearch } from \"../../../store/actions\";\nimport { stateType } from \"../../../store\";\nimport { withTranslation } from \"react-i18next\";\nimport NavigationPanel from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentBook: state.book.currentBook,\n    bookmarks: state.reader.bookmarks,\n    htmlBook: state.reader.htmlBook,\n  };\n};\nconst actionCreator = { handleFetchBookmarks, handleSearch };\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(NavigationPanel as any));\n","class Bookmark {\n  key: string;\n  bookKey: string;\n  cfi: string;\n  label: string;\n  percentage: number;\n  chapter: string;\n  constructor(\n    bookKey: string,\n    cfi: string,\n    label: string,\n    percentage: number,\n    chapter: string\n  ) {\n    this.key = new Date().getTime() + \"\"; // 唯一的键\n    this.bookKey = bookKey; // 所属的书籍的键\n    this.cfi = cfi; // 标记阅读位置的cfi\n    this.label = label; // 此项书签的别名\n    this.percentage = percentage; // 此项书签的摘要\n    this.chapter = chapter; // 此项书签的摘要\n  }\n}\n\nexport default Bookmark;\n","import React from \"react\";\nimport \"./operationPanel.css\";\nimport Bookmark from \"../../../model/Bookmark\";\nimport { Trans } from \"react-i18next\";\nimport localforage from \"localforage\";\nimport RecordLocation from \"../../../utils/readUtils/recordLocation\";\nimport { OperationPanelProps, OperationPanelState } from \"./interface\";\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\nimport ReadingTime from \"../../../utils/readUtils/readingTime\";\nimport { withRouter } from \"react-router-dom\";\nimport toast from \"react-hot-toast\";\nimport { HtmlMouseEvent } from \"../../../utils/serviceUtils/mouseEvent\";\nimport storageUtil from \"../../../utils/serviceUtils/storageUtil\";\ndeclare var document: any;\n\nclass OperationPanel extends React.Component<\n  OperationPanelProps,\n  OperationPanelState\n> {\n  timeStamp: number;\n  speed: number;\n  timer: any;\n\n  constructor(props: OperationPanelProps) {\n    super(props);\n    this.state = {\n      isBookmark: false, // 是否添加书签\n      time: 0,\n      currentPercentage: RecordLocation.getHtmlLocation(\n        this.props.currentBook.key\n      )\n        ? RecordLocation.getHtmlLocation(this.props.currentBook.key).percentage\n        : 0,\n      timeLeft: 0,\n    };\n    this.timeStamp = Date.now();\n    this.speed = 30000;\n  }\n\n  componentDidMount() {\n    this.props.htmlBook.rendition.on(\"page-changed\", async () => {\n      this.speed = Date.now() - this.timeStamp;\n      this.timeStamp = Date.now();\n      let pageProgress = await this.props.htmlBook.rendition.getProgress();\n      this.setState({\n        timeLeft:\n          ((pageProgress.totalPage - pageProgress.currentPage) * this.speed) /\n          1000,\n      });\n      this.props.handleShowBookmark(false);\n\n      HtmlMouseEvent(\n        this.props.htmlBook.rendition,\n        this.props.currentBook.key,\n        storageUtil.getReaderConfig(\"readerMode\")\n      );\n    });\n  }\n  // 点击切换全屏按钮触发\n  handleScreen() {\n    StorageUtil.getReaderConfig(\"isFullscreen\") !== \"yes\"\n      ? this.handleFullScreen()\n      : this.handleExitFullScreen();\n  }\n  // 点击退出按钮的处理程序\n  handleExit() {\n    StorageUtil.setReaderConfig(\"isFullscreen\", \"no\");\n    this.props.handleReadingState(false);\n    window.speechSynthesis.cancel();\n    ReadingTime.setTime(this.props.currentBook.key, this.props.time);\n    this.handleExitFullScreen();\n    if (this.props.htmlBook) {\n      this.props.handleHtmlBook(null);\n    }\n  }\n  //控制进入全屏\n  handleFullScreen() {\n    let de: any = document.documentElement;\n    if (de.requestFullscreen) {\n      de.requestFullscreen();\n    }\n    StorageUtil.setReaderConfig(\"isFullscreen\", \"yes\");\n  }\n  // 退出全屏模式\n  handleExitFullScreen() {\n    //解决使用esc退出全屏，再退出阅读时发生的bug\n    if (!document.fullscreenElement) return;\n\n    if (document.exitFullscreen) {\n      document.exitFullscreen();\n    }\n    StorageUtil.setReaderConfig(\"isFullscreen\", \"no\");\n  }\n  handleAddBookmark = async () => {\n    let bookKey = this.props.currentBook.key;\n    let bookLocation = RecordLocation.getHtmlLocation(bookKey);\n    let text = bookLocation.text;\n    let chapter = bookLocation.chapterTitle;\n    let percentage = bookLocation.percentage;\n\n    let cfi = JSON.stringify(bookLocation);\n    if (!text) {\n      text = await this.props.htmlBook.rendition.visibleText();\n    }\n    text = text\n      .replace(/\\s\\s/g, \"\")\n      .replace(/\\r/g, \"\")\n      .replace(/\\n/g, \"\")\n      .replace(/\\t/g, \"\")\n      .replace(/\\f/g, \"\");\n\n    let bookmark = new Bookmark(\n      bookKey,\n      cfi,\n      text.substr(0, 200),\n      percentage,\n      chapter\n    );\n    let bookmarkArr = this.props.bookmarks;\n    bookmarkArr.push(bookmark);\n    this.props.handleBookmarks(bookmarkArr);\n    localforage.setItem(\"bookmarks\", bookmarkArr);\n    this.setState({ isBookmark: true });\n    toast.success(this.props.t(\"Add Successfully\"));\n    this.props.handleShowBookmark(true);\n  };\n\n  render() {\n    return (\n      <div className=\"book-operation-panel\">\n        <div className=\"book-opeartion-info\">\n          <span>\n            <Trans\n              i18nKey=\"Current Reading Time\"\n              count={Math.floor(Math.abs(Math.floor(this.props.time / 60)))}\n            >\n              Current Reading Time:\n              {{\n                count: Math.abs(Math.floor(this.props.time / 60)),\n              }}\n              min\n            </Trans>\n          </span>\n          &nbsp;&nbsp;&nbsp;\n          <span>\n            <Trans\n              i18nKey=\"Finish Reading Time\"\n              count={Math.ceil(this.state.timeLeft / 60)}\n            >\n              Finish Reading Time:\n              {{\n                count: `${Math.ceil(this.state.timeLeft / 60)}`,\n              }}\n              min\n            </Trans>\n          </span>\n        </div>\n        <div\n          className=\"exit-reading-button\"\n          onClick={() => {\n            this.handleExit();\n\n            if (StorageUtil.getReaderConfig(\"isOpenInMain\") === \"yes\") {\n              this.props.history.push(\"/manager/home\");\n              document.title = \"Koodo Reader\";\n            } else {\n              window.close();\n            }\n          }}\n        >\n          <span className=\"icon-exit exit-reading-icon\"></span>\n          <span className=\"exit-reading-text\">\n            <Trans>Exit</Trans>\n          </span>\n        </div>\n        <div\n          className=\"add-bookmark-button\"\n          onClick={() => {\n            this.handleAddBookmark();\n          }}\n        >\n          <span className=\"icon-add add-bookmark-icon\"></span>\n          <span className=\"add-bookmark-text\">\n            <Trans>Add Bookmark</Trans>\n          </span>\n        </div>\n        <div\n          className=\"enter-fullscreen-button\"\n          onClick={() => {\n            this.handleScreen();\n          }}\n        >\n          <span className=\"icon-fullscreen enter-fullscreen-icon\"></span>\n          {StorageUtil.getReaderConfig(\"isFullscreen\") !== \"yes\" ? (\n            <span className=\"enter-fullscreen-text\">\n              <Trans>Enter Fullscreen</Trans>\n            </span>\n          ) : (\n            <span className=\"enter-fullscreen-text\">\n              <Trans>Exit Fullscreen</Trans>\n            </span>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default withRouter(OperationPanel);\n","import { connect } from \"react-redux\";\nimport {\n  handleBookmarks,\n  handleFetchBookmarks,\n  handleOpenMenu,\n  handleShowBookmark,\n  handleSearch,\n  handleReadingState,\n  handleHtmlBook,\n  handleReadingBook,\n} from \"../../../store/actions\";\nimport { stateType } from \"../../../store\";\nimport { withTranslation } from \"react-i18next\";\nimport OperationPanel from \"./component\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentBook: state.book.currentBook,\n    bookmarks: state.reader.bookmarks,\n    notes: state.reader.notes,\n    books: state.manager.books,\n    htmlBook: state.reader.htmlBook,\n    locations: state.progressPanel.locations,\n  };\n};\nconst actionCreator = {\n  handleBookmarks,\n  handleReadingState,\n  handleFetchBookmarks,\n  handleOpenMenu,\n  handleShowBookmark,\n  handleSearch,\n  handleHtmlBook,\n  handleReadingBook,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(OperationPanel as any));\n","import React from \"react\";\nimport \"./progressPanel.css\";\nimport { Trans } from \"react-i18next\";\nimport { ProgressPanelProps, ProgressPanelState } from \"./interface\";\nimport { Tooltip } from \"react-tippy\";\nimport _ from \"underscore\";\nimport StorageUtil from \"../../../utils/serviceUtils/storageUtil\";\n\nclass ProgressPanel extends React.Component<\n  ProgressPanelProps,\n  ProgressPanelState\n> {\n  constructor(props: ProgressPanelProps) {\n    super(props);\n    this.state = {\n      currentPage: 0,\n      totalPage: 0,\n      isSingle:\n        StorageUtil.getReaderConfig(\"readerMode\") &&\n        StorageUtil.getReaderConfig(\"readerMode\") !== \"double\",\n    };\n  }\n\n  async UNSAFE_componentWillReceiveProps(nextProps: ProgressPanelProps) {\n    if (nextProps.htmlBook !== this.props.htmlBook && nextProps.htmlBook) {\n      await this.handlePageNum(nextProps.htmlBook.rendition);\n      nextProps.htmlBook.rendition.on(\"page-changed\", async () => {\n        await this.handlePageNum(nextProps.htmlBook.rendition);\n      });\n    }\n  }\n  async handlePageNum(rendition) {\n    let pageInfo = await rendition.getProgress();\n    this.setState({\n      currentPage: this.state.isSingle\n        ? pageInfo.currentPage\n        : pageInfo.currentPage * 2 - 1,\n      totalPage: pageInfo.totalPage,\n    });\n  }\n  onProgressChange = (event: any) => {\n    const percentage = event.target.value / 100;\n    if (this.props.htmlBook.flattenChapters.length > 0) {\n      this.props.htmlBook.rendition.goToChapter(\n        this.props.htmlBook.flattenChapters[\n          percentage === 1\n            ? this.props.htmlBook.flattenChapters.length - 1\n            : Math.floor(\n                this.props.htmlBook.flattenChapters.length * percentage\n              )\n        ].label\n      );\n    }\n  };\n  nextChapter = () => {\n    if (this.props.htmlBook.flattenChapters.length > 0) {\n      this.props.htmlBook.rendition.goToChapter(\n        this.props.htmlBook.flattenChapters[\n          _.findIndex(\n            this.props.htmlBook.flattenChapters.map((item) => {\n              item.label = item.label.trim();\n              return item;\n            }),\n            {\n              label: this.props.currentChapter.trim(),\n            }\n          ) <\n          this.props.htmlBook.flattenChapters.length - 1\n            ? _.findIndex(\n                this.props.htmlBook.flattenChapters.map((item) => {\n                  item.label = item.label.trim();\n                  return item;\n                }),\n                {\n                  label: this.props.currentChapter.trim(),\n                }\n              ) + 1\n            : this.props.htmlBook.flattenChapters.length - 1\n        ].label\n      );\n    }\n  };\n  prevChapter = () => {\n    if (this.props.htmlBook.flattenChapters.length > 0) {\n      this.props.htmlBook.rendition.goToChapter(\n        this.props.htmlBook.flattenChapters[\n          _.findIndex(\n            this.props.htmlBook.flattenChapters.map((item) => {\n              item.label = item.label.trim();\n              return item;\n            }),\n            {\n              label: this.props.currentChapter.trim(),\n            }\n          ) > 0\n            ? _.findIndex(\n                this.props.htmlBook.flattenChapters.map((item) => {\n                  item.label = item.label.trim();\n                  return item;\n                }),\n                {\n                  label: this.props.currentChapter.trim(),\n                }\n              ) - 1\n            : 0\n        ].label\n      );\n    }\n  };\n  handleJumpChapter = (event: any) => {\n    if (this.props.htmlBook.flattenChapters.length > 0) {\n      this.props.htmlBook.rendition.goToChapter(\n        this.props.htmlBook.flattenChapters[event.target.value].label\n      );\n    }\n  };\n  render() {\n    if (!this.props.htmlBook) {\n      return <div className=\"progress-panel\">Loading</div>;\n    }\n    return (\n      <div className=\"progress-panel\">\n        <p className=\"progress-text\" style={{ marginTop: 10 }}>\n          <span>\n            <Trans>Progress</Trans>:{\" \"}\n            {Math.round(\n              this.props.percentage > 1 ? 100 : this.props.percentage * 100\n            )}\n            %&nbsp;&nbsp;&nbsp;\n          </span>\n        </p>\n\n        <p className=\"progress-text\" style={{ marginTop: 0 }}>\n          <Trans>Pages</Trans>\n          <input\n            type=\"text\"\n            name=\"jumpPage\"\n            id=\"jumpPage\"\n            defaultValue={this.state.currentPage}\n          />\n          <span>/ {this.state.totalPage}</span>\n          &nbsp;&nbsp;&nbsp;\n          <Trans>Chapters</Trans>\n          <input\n            type=\"text\"\n            name=\"jumpChapter\"\n            id=\"jumpChapter\"\n            onBlur={(event) => {\n              this.handleJumpChapter(event);\n            }}\n            defaultValue={\n              this.props.currentChapterIndex === -1\n                ? this.props.htmlBook.flattenChapters.length\n                : this.props.currentChapterIndex + 1\n            }\n          />\n          <span>/ {this.props.htmlBook.flattenChapters.length}</span>\n        </p>\n        <div>\n          <input\n            className=\"input-progress\"\n            defaultValue={Math.round(this.props.percentage * 100)}\n            type=\"range\"\n            max=\"100\"\n            min=\"0\"\n            step=\"1\"\n            onMouseUp={(event) => {\n              this.onProgressChange(event);\n            }}\n            onTouchEnd={(event) => {\n              this.onProgressChange(event);\n            }}\n            style={{ width: 300, left: 50, top: 73 }}\n          />\n        </div>\n\n        <div\n          className=\"previous-chapter\"\n          onClick={() => {\n            this.prevChapter();\n          }}\n        >\n          <Tooltip\n            title={this.props.t(\"Prev Chapter\")}\n            position=\"top\"\n            trigger=\"mouseenter\"\n          >\n            <span className=\"icon-dropdown previous-chapter-icon\"> </span>\n          </Tooltip>\n        </div>\n\n        <div\n          className=\"next-chapter\"\n          onClick={() => {\n            this.nextChapter();\n          }}\n        >\n          <Tooltip\n            title={this.props.t(\"Next Chapter\")}\n            position=\"top\"\n            trigger=\"mouseenter\"\n          >\n            <span className=\"icon-dropdown next-chapter-icon\"></span>\n          </Tooltip>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ProgressPanel;\n","import { connect } from \"react-redux\";\nimport { stateType } from \"../../../store\";\nimport { withTranslation } from \"react-i18next\";\nimport ProgressPanel from \"./component\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentBook: state.book.currentBook,\n    isReading: state.book.isReading,\n    percentage: state.progressPanel.percentage,\n    htmlBook: state.reader.htmlBook,\n    currentChapterIndex: state.reader.currentChapterIndex,\n    currentChapter: state.reader.currentChapter,\n    renderBookFunc: state.book.renderBookFunc,\n  };\n};\nconst actionCreator = {};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(ProgressPanel as any));\n","import { connect } from \"react-redux\";\nimport {\n  handleActionDialog,\n  handleReadingState,\n  handleReadingBook,\n  handleHtmlBook,\n  handleRenderBookFunc,\n  handleFetchBooks,\n  handleCurrentChapter,\n  handleCurrentChapterIndex,\n  handleFetchNotes,\n  handleFetchBookmarks,\n  handlePercentage,\n  handleFetchPercentage,\n} from \"../../store/actions\";\nimport Viewer from \"./component\";\nimport { stateType } from \"../../store\";\nimport { withTranslation } from \"react-i18next\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    isOpenActionDialog: state.book.isOpenActionDialog,\n    currentBook: state.book.currentBook,\n    isReading: state.book.isReading,\n    renderNoteFunc: state.book.renderNoteFunc,\n    htmlBook: state.reader.htmlBook,\n    books: state.manager.books,\n  };\n};\nconst actionCreator = {\n  handleReadingState,\n  handleReadingBook,\n  handleActionDialog,\n  handleHtmlBook,\n  handleRenderBookFunc,\n  handleFetchBooks,\n  handleCurrentChapter,\n  handleCurrentChapterIndex,\n  handleFetchNotes,\n  handleFetchBookmarks,\n  handleFetchPercentage,\n  handlePercentage,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(Viewer as any));\n","import React from \"react\";\nimport PageWidget from \"../../containers/pageWidget\";\nimport SettingPanel from \"../../containers/panels/settingPanel\";\nimport NavigationPanel from \"../../containers/panels/navigationPanel\";\nimport OperationPanel from \"../../containers/panels/operationPanel\";\nimport { Toaster } from \"react-hot-toast\";\nimport ProgressPanel from \"../../containers/panels/progressPanel\";\nimport { ReaderProps, ReaderState } from \"./interface\";\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\nimport ReadingTime from \"../../utils/readUtils/readingTime\";\nimport Viewer from \"../../containers/htmlViewer\";\nimport _ from \"underscore\";\nimport localforage from \"localforage\";\nimport RecordLocation from \"../../utils/readUtils/recordLocation\";\nimport \"./index.css\";\n\nclass Reader extends React.Component<ReaderProps, ReaderState> {\n  messageTimer!: NodeJS.Timeout;\n  tickTimer!: NodeJS.Timeout;\n  constructor(props: ReaderProps) {\n    super(props);\n    this.state = {\n      isOpenRightPanel:\n        StorageUtil.getReaderConfig(\"isSettingLocked\") === \"yes\" ? true : false,\n      isOpenTopPanel: false,\n      isOpenBottomPanel: false,\n      hoverPanel: \"\",\n      isOpenLeftPanel:\n        StorageUtil.getReaderConfig(\"isNavLocked\") === \"yes\" ? true : false,\n\n      scale: StorageUtil.getReaderConfig(\"scale\") || 1,\n      margin: parseInt(StorageUtil.getReaderConfig(\"margin\")) || 30,\n      time: 0,\n      isTouch: StorageUtil.getReaderConfig(\"isTouch\") === \"yes\",\n      isPreventTrigger:\n        StorageUtil.getReaderConfig(\"isPreventTrigger\") === \"yes\",\n      readerMode: StorageUtil.getReaderConfig(\"readerMode\") || \"double\",\n    };\n  }\n  componentDidMount() {\n    if (StorageUtil.getReaderConfig(\"isMergeWord\") === \"yes\") {\n      document\n        .querySelector(\"body\")\n        ?.setAttribute(\"style\", \"background-color: rgba(0,0,0,0)\");\n    }\n    let time = ReadingTime.getTime(this.props.currentBook.key) || 0;\n    this.tickTimer = setInterval(() => {\n      if (this.props.currentBook.key) {\n        time += 1;\n        this.setState({ time });\n        ReadingTime.setTime(this.props.currentBook.key, time);\n      }\n    }, 1000);\n  }\n  UNSAFE_componentWillMount() {\n    let url = document.location.href.split(\"/\");\n    let key = url[url.length - 1].split(\"?\")[0];\n    this.props.handleFetchBooks();\n    localforage.getItem(\"books\").then((result: any) => {\n      let book;\n      //兼容在主窗口打开\n      if (this.props.currentBook.key) {\n        book = this.props.currentBook;\n      } else {\n        book =\n          result[_.findIndex(result, { key })] ||\n          JSON.parse(localStorage.getItem(\"tempBook\") || \"{}\");\n      }\n      this.props.handleReadingBook(book);\n      this.props.handleFetchPercentage(book);\n    });\n  }\n  //进入阅读器\n  handleEnterReader = (position: string) => {\n    //控制上下左右的菜单的显示\n    switch (position) {\n      case \"right\":\n        this.setState({\n          isOpenRightPanel: this.state.isOpenRightPanel ? false : true,\n        });\n        break;\n      case \"left\":\n        this.setState({\n          isOpenLeftPanel: this.state.isOpenLeftPanel ? false : true,\n        });\n        break;\n      case \"top\":\n        this.setState({\n          isOpenTopPanel: this.state.isOpenTopPanel ? false : true,\n        });\n        break;\n      case \"bottom\":\n        this.setState({\n          isOpenBottomPanel: this.state.isOpenBottomPanel ? false : true,\n        });\n        break;\n      default:\n        break;\n    }\n  };\n  //退出阅读器\n  handleLeaveReader = (position: string) => {\n    //控制上下左右的菜单的显示\n    switch (position) {\n      case \"right\":\n        if (StorageUtil.getReaderConfig(\"isSettingLocked\") === \"yes\") {\n          break;\n        } else {\n          this.setState({ isOpenRightPanel: false });\n          break;\n        }\n\n      case \"left\":\n        if (StorageUtil.getReaderConfig(\"isNavLocked\") === \"yes\") {\n          break;\n        } else {\n          this.setState({ isOpenLeftPanel: false });\n          break;\n        }\n      case \"top\":\n        this.setState({ isOpenTopPanel: false });\n        break;\n      case \"bottom\":\n        this.setState({ isOpenBottomPanel: false });\n        break;\n      default:\n        break;\n    }\n  };\n  handleLocation = async () => {\n    let position = await this.props.htmlBook.rendition.getPosition();\n\n    RecordLocation.recordHtmlLocation(\n      this.props.currentBook.key,\n      position.text,\n      position.chapterTitle,\n      position.count,\n      position.percentage,\n      position.cfi\n    );\n  };\n  render() {\n    const renditionProps = {\n      handleLeaveReader: this.handleLeaveReader,\n      handleEnterReader: this.handleEnterReader,\n      isShow:\n        this.state.isOpenLeftPanel ||\n        this.state.isOpenTopPanel ||\n        this.state.isOpenBottomPanel ||\n        this.state.isOpenRightPanel,\n    };\n    return (\n      <div className=\"viewer\">\n        {StorageUtil.getReaderConfig(\"isHidePageButton\") !== \"yes\" && (\n          <>\n            <div\n              className=\"previous-chapter-single-container\"\n              onClick={async () => {\n                this.props.htmlBook.rendition.prev();\n                await this.handleLocation();\n              }}\n            >\n              <span className=\"icon-dropdown previous-chapter-single\"></span>\n            </div>\n            <div\n              className=\"next-chapter-single-container\"\n              onClick={async () => {\n                this.props.htmlBook.rendition.next();\n                await this.handleLocation();\n              }}\n            >\n              <span className=\"icon-dropdown next-chapter-single\"></span>\n            </div>\n          </>\n        )}\n        {StorageUtil.getReaderConfig(\"isHideMenuButton\") !== \"yes\" && (\n          <div\n            className=\"reader-setting-icon-container\"\n            onClick={() => {\n              this.handleEnterReader(\"left\");\n              this.handleEnterReader(\"right\");\n              this.handleEnterReader(\"bottom\");\n              this.handleEnterReader(\"top\");\n            }}\n          >\n            <span className=\"icon-grid reader-setting-icon\"></span>\n          </div>\n        )}\n        <Toaster />\n\n        <div\n          className=\"left-panel\"\n          onMouseEnter={() => {\n            if (\n              this.state.isTouch ||\n              this.state.isOpenLeftPanel ||\n              this.state.isPreventTrigger\n            ) {\n              this.setState({ hoverPanel: \"left\" });\n              return;\n            }\n            this.handleEnterReader(\"left\");\n          }}\n          onMouseLeave={() => {\n            this.setState({ hoverPanel: \"\" });\n          }}\n          style={this.state.hoverPanel === \"left\" ? { opacity: 0.5 } : {}}\n          onClick={() => {\n            this.handleEnterReader(\"left\");\n          }}\n        >\n          <span className=\"icon-grid panel-icon\"></span>\n        </div>\n        <div\n          className=\"right-panel\"\n          onMouseEnter={() => {\n            if (\n              this.state.isTouch ||\n              this.state.isOpenRightPanel ||\n              this.state.isPreventTrigger\n            ) {\n              this.setState({ hoverPanel: \"right\" });\n              return;\n            }\n            this.handleEnterReader(\"right\");\n          }}\n          onMouseLeave={() => {\n            this.setState({ hoverPanel: \"\" });\n          }}\n          style={this.state.hoverPanel === \"right\" ? { opacity: 0.5 } : {}}\n          onClick={() => {\n            this.handleEnterReader(\"right\");\n          }}\n        >\n          <span className=\"icon-grid panel-icon\"></span>\n        </div>\n        <div\n          className=\"top-panel\"\n          onMouseEnter={() => {\n            if (\n              this.state.isTouch ||\n              this.state.isOpenTopPanel ||\n              this.state.isPreventTrigger\n            ) {\n              this.setState({ hoverPanel: \"top\" });\n              return;\n            }\n            this.handleEnterReader(\"top\");\n          }}\n          style={this.state.hoverPanel === \"top\" ? { opacity: 0.5 } : {}}\n          onMouseLeave={() => {\n            this.setState({ hoverPanel: \"\" });\n          }}\n          onClick={() => {\n            this.handleEnterReader(\"top\");\n          }}\n        >\n          <span className=\"icon-grid panel-icon\"></span>\n        </div>\n        <div\n          className=\"bottom-panel\"\n          onMouseEnter={() => {\n            if (\n              this.state.isTouch ||\n              this.state.isOpenBottomPanel ||\n              this.state.isPreventTrigger\n            ) {\n              this.setState({ hoverPanel: \"bottom\" });\n              return;\n            }\n            this.handleEnterReader(\"bottom\");\n          }}\n          style={this.state.hoverPanel === \"bottom\" ? { opacity: 0.5 } : {}}\n          onMouseLeave={() => {\n            this.setState({ hoverPanel: \"\" });\n          }}\n          onClick={() => {\n            this.handleEnterReader(\"bottom\");\n          }}\n        >\n          <span className=\"icon-grid panel-icon\"></span>\n        </div>\n        {this.props.currentBook.key && <Viewer {...renditionProps} />}\n        <div\n          className=\"setting-panel-container\"\n          onMouseLeave={(event) => {\n            this.handleLeaveReader(\"right\");\n          }}\n          style={\n            this.state.isOpenRightPanel\n              ? {}\n              : {\n                  transform: \"translateX(309px)\",\n                }\n          }\n        >\n          <SettingPanel />\n        </div>\n        <div\n          className=\"navigation-panel-container\"\n          onMouseLeave={(event) => {\n            this.handleLeaveReader(\"left\");\n          }}\n          style={\n            this.state.isOpenLeftPanel\n              ? {}\n              : {\n                  transform: \"translateX(-309px)\",\n                }\n          }\n        >\n          <NavigationPanel {...{ time: this.state.time }} />\n        </div>\n        <div\n          className=\"progress-panel-container\"\n          onMouseLeave={(event) => {\n            this.handleLeaveReader(\"bottom\");\n          }}\n          style={\n            this.state.isOpenBottomPanel\n              ? {}\n              : {\n                  transform: \"translateY(110px)\",\n                }\n          }\n        >\n          <ProgressPanel {...{ time: this.state.time }} />\n        </div>\n        <div\n          className=\"operation-panel-container\"\n          onMouseLeave={(event) => {\n            this.handleLeaveReader(\"top\");\n          }}\n          style={\n            this.state.isOpenTopPanel\n              ? {}\n              : {\n                  transform: \"translateY(-110px)\",\n                }\n          }\n        >\n          {this.props.htmlBook && (\n            <OperationPanel {...{ time: this.state.time }} />\n          )}\n        </div>\n        <PageWidget />\n      </div>\n    );\n  }\n}\n\nexport default Reader;\n","import {\n  handleFetchNotes,\n  handleFetchBookmarks,\n  handleFetchBooks,\n  handleReadingBook,\n  handleFetchPercentage,\n} from \"../../store/actions\";\nimport { connect } from \"react-redux\";\nimport { stateType } from \"../../store\";\nimport Reader from \"./component\";\nimport { withTranslation } from \"react-i18next\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    currentBook: state.book.currentBook,\n    percentage: state.progressPanel.percentage,\n    htmlBook: state.reader.htmlBook,\n  };\n};\nconst actionCreator = {\n  handleFetchNotes,\n  handleFetchBookmarks,\n  handleFetchBooks,\n  handleReadingBook,\n  handleFetchPercentage,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(Reader));\n","import React from \"react\";\nimport \"./style.css\";\nimport { withRouter } from \"react-router-dom\";\nimport { stateType } from \"../../store\";\nimport { connect } from \"react-redux\";\nimport { handleReadingState } from \"../../store/actions\";\nimport { isElectron } from \"react-device-detect\";\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\n\nconst BackToMain = (props: any) => {\n  return (\n    <div\n      className=\"back-main-container\"\n      onClick={() => {\n        if (\n          isElectron &&\n          StorageUtil.getReaderConfig(\"isOpenInMain\") !== \"yes\"\n        ) {\n          if (\n            window\n              .require(\"electron\")\n              .ipcRenderer.sendSync(\"check-main-open\", \"ping\")\n          ) {\n            window\n              .require(\"electron\")\n              .ipcRenderer.invoke(\"focus-on-main\", \"ping\");\n            window.close();\n          } else {\n            window\n              .require(\"electron\")\n              .ipcRenderer.invoke(\"create-new-main\", \"ping\");\n            window.close();\n          }\n        } else {\n          props.history.push(\"/manager/home\");\n          document.title = \"Koodo Reader\";\n          props.handleReadingState(false);\n        }\n      }}\n      style={document.URL.indexOf(\"djvu\") > -1 ? { bottom: \"60px\" } : {}}\n    >\n      <span className=\"icon-home back-home\"></span>\n    </div>\n  );\n};\nconst mapStateToProps = (state: stateType) => {\n  return {};\n};\nconst actionCreator = { handleReadingState };\nexport default connect(mapStateToProps, actionCreator)(withRouter(BackToMain));\n","import React from \"react\";\nimport RecentBooks from \"../../utils/readUtils/recordRecent\";\nimport { ViewerProps, ViewerState } from \"./interface\";\nimport localforage from \"localforage\";\nimport { withRouter } from \"react-router-dom\";\nimport _ from \"underscore\";\nimport BookUtil from \"../../utils/fileUtils/bookUtil\";\nimport { toast } from \"react-hot-toast\";\nimport BackToMain from \"../../components/backToMain\";\nimport { djvuMouseEvent } from \"../../utils/serviceUtils/mouseEvent\";\n\ndeclare var window: any;\n\nclass Viewer extends React.Component<ViewerProps, ViewerState> {\n  constructor(props: ViewerProps) {\n    super(props);\n    this.state = {};\n  }\n\n  componentDidMount() {\n    let url = document.location.href.split(\"/\");\n    let key = url[url.length - 1].split(\"?\")[0];\n\n    localforage.getItem(\"books\").then((result: any) => {\n      let book;\n      //兼容在主窗口打开\n      if (this.props.currentBook.key) {\n        book = this.props.currentBook;\n      } else {\n        book =\n          result[_.findIndex(result, { key })] ||\n          JSON.parse(localStorage.getItem(\"tempBook\") || \"{}\");\n      }\n      BookUtil.fetchBook(key, true, book.path).then((result) => {\n        if (!result) {\n          toast.error(this.props.t(\"Book not exsits\"));\n          return;\n        }\n        this.props.handleReadingBook(book);\n        this.handleDjvu(result as ArrayBuffer);\n        this.props.handleReadingState(true);\n        RecentBooks.setRecent(key);\n        document.title = book.name + \" - Koodo Reader\";\n      });\n    });\n    document\n      .querySelector(\".ebook-viewer\")\n      ?.setAttribute(\"style\", \"height:100vh\");\n  }\n\n  handleDjvu = async (result: ArrayBuffer) => {\n    setTimeout(() => {\n      var ViewerInstance = new window.DjVu.Viewer();\n      ViewerInstance.render(document.querySelector(\".ebook-viewer\"));\n      ViewerInstance.loadDocument(result);\n      djvuMouseEvent();\n    }, 100);\n  };\n\n  render() {\n    return (\n      <div>\n        <div className=\"ebook-viewer\" id=\"page-area\">\n          Loading\n        </div>\n        <BackToMain />\n      </div>\n    );\n  }\n}\nexport default withRouter(Viewer as any);\n","import { connect } from \"react-redux\";\nimport {\n  handleActionDialog,\n  handleReadingState,\n  handleReadingBook,\n} from \"../../store/actions\";\nimport Viewer from \"./component\";\nimport { stateType } from \"../../store\";\nimport { withTranslation } from \"react-i18next\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    isOpenActionDialog: state.book.isOpenActionDialog,\n    currentBook: state.book.currentBook,\n    isReading: state.book.isReading,\n  };\n};\nconst actionCreator = {\n  handleReadingState,\n  handleReadingBook,\n  handleActionDialog,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(Viewer as any));\n","import React from \"react\";\nimport RecentBooks from \"../../utils/readUtils/recordRecent\";\nimport { ViewerProps, ViewerState } from \"./interface\";\nimport localforage from \"localforage\";\nimport { withRouter } from \"react-router-dom\";\nimport _ from \"underscore\";\nimport BookUtil from \"../../utils/fileUtils/bookUtil\";\nimport BackToMain from \"../../components/backToMain\";\nimport PopupMenu from \"../../components/popups/popupMenu\";\nimport { Toaster } from \"react-hot-toast\";\nimport { handleLinkJump } from \"../../utils/readUtils/linkUtil\";\nimport { pdfMouseEvent } from \"../../utils/serviceUtils/mouseEvent\";\nclass Viewer extends React.Component<ViewerProps, ViewerState> {\n  constructor(props: ViewerProps) {\n    super(props);\n    this.state = {\n      href: \"\",\n      title: \"\",\n      cfiRange: null,\n      contents: null,\n      rect: null,\n      pageWidth: 0,\n      pageHeight: 0,\n      loading: true,\n    };\n  }\n  UNSAFE_componentWillMount() {\n    this.props.handleFetchBookmarks();\n    this.props.handleFetchNotes();\n    this.props.handleFetchBooks();\n  }\n  componentDidMount() {\n    let url = document.location.href.split(\"/\");\n    let key = url[url.length - 1].split(\"?\")[0];\n    localforage.getItem(\"books\").then((result: any) => {\n      let book;\n      if (this.props.currentBook.key) {\n        book = this.props.currentBook;\n      } else {\n        book =\n          result[_.findIndex(result, { key })] ||\n          JSON.parse(localStorage.getItem(\"tempBook\") || \"{}\");\n      }\n\n      document.title = book.name + \" - Koodo Reader\";\n      this.props.handleReadingState(true);\n      RecentBooks.setRecent(key);\n      this.props.handleReadingBook(book);\n      this.setState({ title: book.name + \" - Koodo Reader\" });\n      this.setState({ href: BookUtil.getPDFUrl(book) });\n    });\n    document\n      .querySelector(\".ebook-viewer\")\n      ?.setAttribute(\"style\", \"height:100%\");\n    let pageArea = document.getElementById(\"page-area\");\n    if (!pageArea) return;\n    let iframe = pageArea.getElementsByTagName(\"iframe\")[0];\n    if (!iframe) return;\n    iframe.onload = () => {\n      let doc: any =\n        iframe.contentWindow || iframe.contentDocument?.defaultView;\n      this.setState({ loading: false });\n      pdfMouseEvent();\n      doc.document.addEventListener(\"click\", (event: any) => {\n        event.preventDefault();\n        handleLinkJump(event);\n      });\n\n      doc.document.addEventListener(\"mouseup\", () => {\n        if (!doc!.getSelection()) return;\n        var rect = doc!.getSelection()!.getRangeAt(0).getBoundingClientRect();\n        this.setState({\n          rect,\n          pageWidth: doc.document.body.scrollWidth,\n          pageHeight: doc.document.body.scrollHeight,\n        });\n        // iWin.getSelection() && showHighlight(getHightlightCoords());\n      });\n    };\n  }\n\n  render() {\n    return (\n      <div className=\"ebook-viewer\" id=\"page-area\">\n        {!this.state.loading && (\n          <PopupMenu\n            {...{\n              rendition: {\n                on: (status: string, callback: any) => {\n                  callback();\n                },\n              },\n              rect: this.state.rect,\n              pageWidth: this.state.pageWidth,\n              pageHeight: this.state.pageHeight,\n              chapterIndex: 0,\n              chapter: \"0\",\n            }}\n          />\n        )}\n        <iframe\n          src={this.state.href}\n          title={this.state.title}\n          width=\"100%\"\n          height=\"100%\"\n        >\n          Loading\n        </iframe>\n        <BackToMain /> <Toaster />\n      </div>\n    );\n  }\n}\nexport default withRouter(Viewer as any);\n","import { connect } from \"react-redux\";\nimport {\n  handleActionDialog,\n  handleReadingState,\n  handleReadingBook,\n  handleFetchNotes,\n  handleFetchBookmarks,\n  handleFetchBooks,\n} from \"../../store/actions\";\nimport Viewer from \"./component\";\nimport { stateType } from \"../../store\";\nimport { withTranslation } from \"react-i18next\";\n\nconst mapStateToProps = (state: stateType) => {\n  return {\n    isOpenActionDialog: state.book.isOpenActionDialog,\n    currentBook: state.book.currentBook,\n    isReading: state.book.isReading,\n  };\n};\nconst actionCreator = {\n  handleReadingState,\n  handleReadingBook,\n  handleActionDialog,\n  handleFetchNotes,\n  handleFetchBookmarks,\n  handleFetchBooks,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(Viewer as any));\n","import React from \"react\";\nimport \"./manager.css\";\nimport { RedirectProps, RedirectState } from \"./interface\";\nimport { Trans } from \"react-i18next\";\nimport { getParamsFromUrl } from \"../../utils/syncUtils/common\";\nimport copy from \"copy-text-to-clipboard\";\nimport { withRouter } from \"react-router-dom\";\nimport StorageUtil from \"../../utils/serviceUtils/storageUtil\";\nimport Lottie from \"react-lottie\";\nimport animationSuccess from \"../../assets/lotties/success.json\";\nimport toast, { Toaster } from \"react-hot-toast\";\nconst successOptions = {\n  loop: false,\n  autoplay: true,\n  animationData: animationSuccess,\n  rendererSettings: {\n    preserveAspectRatio: \"xMidYMid slice\",\n  },\n};\n\nclass Redirect extends React.Component<RedirectProps, RedirectState> {\n  timer!: NodeJS.Timeout;\n  constructor(props: RedirectProps) {\n    super(props);\n    this.state = {\n      isAuthed: false,\n      isError: false,\n      isCopied: false,\n      token: \"\",\n    };\n  }\n  handleFinish = () => {\n    this.props.handleLoadingDialog(false);\n    alert(\"数据恢复成功\");\n  };\n  showMessage = (message: string) => {\n    toast(this.props.t(message));\n  };\n  componentDidMount() {\n    //判断是否是获取token后的回调页面\n    let url = document.location.href;\n    if (document.location.hash === \"#/\") {\n      this.props.history.push(\"/manager/home\");\n    }\n    if (url.indexOf(\"error\") > -1) {\n      this.setState({ isError: true });\n      return false;\n    }\n    if (url.indexOf(\"code\") > -1) {\n      let params: any = getParamsFromUrl();\n      this.setState({ token: params.code });\n      this.setState({ isAuthed: true });\n      return false;\n    }\n    if (url.indexOf(\"access_token\") > -1) {\n      let params: any = getParamsFromUrl();\n      this.setState({ token: params.access_token });\n      this.setState({ isAuthed: true });\n      return false;\n    }\n  }\n\n  render() {\n    if (this.state.isError || this.state.isAuthed) {\n      return (\n        <div className=\"backup-page-finish-container\">\n          <div className=\"backup-page-finish\">\n            {this.state.isAuthed ? (\n              <Lottie options={successOptions} height={80} width={80} />\n            ) : (\n              <span className=\"icon-close auth-page-close-icon\"></span>\n            )}\n\n            <div className=\"backup-page-finish-text\">\n              <Trans>\n                {this.state.isAuthed\n                  ? \"Authorize Successfully\"\n                  : \"Authorize Failed\"}\n              </Trans>\n            </div>\n            {this.state.isAuthed ? (\n              <div\n                className=\"token-dialog-token-text\"\n                onClick={() => {\n                  copy(this.state.token);\n                  this.setState({ isCopied: true });\n                }}\n              >\n                {this.state.isCopied ? (\n                  <Trans>Copied</Trans>\n                ) : (\n                  <Trans>Copy Token</Trans>\n                )}\n              </div>\n            ) : null}\n          </div>\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"manager\">\n        <div className=\"empty-page-info-container\" style={{ margin: 100 }}>\n          <div className=\"empty-page-info-main\">\n            <Trans>It seems like you're lost</Trans>\n          </div>\n          <div\n            className=\"empty-page-info-sub\"\n            onClick={() => {\n              this.props.history.push(\"/manager/home\");\n            }}\n            style={{ marginTop: 10, cursor: \"pointer\" }}\n          >\n            <Trans>Return to home</Trans>\n          </div>\n        </div>\n        <img\n          src={\n            StorageUtil.getReaderConfig(\"appSkin\") === \"night\" ||\n            (StorageUtil.getReaderConfig(\"appSkin\") === \"system\" &&\n              StorageUtil.getReaderConfig(\"isOSNight\") === \"yes\")\n              ? \"./assets/empty_light.svg\"\n              : \"./assets/empty.svg\"\n          }\n          alt=\"\"\n          className=\"empty-page-illustration\"\n        />\n        <Toaster />\n      </div>\n    );\n  }\n}\n\nexport default withRouter(Redirect);\n","import { connect } from \"react-redux\";\nimport \"./manager.css\";\nimport { stateType } from \"../../store\";\nimport { handleLoadingDialog } from \"../../store/actions\";\nimport Redirect from \"./component\";\nimport { withTranslation } from \"react-i18next\";\nconst mapStateToProps = (state: stateType) => {\n  return {};\n};\nconst actionCreator = { handleLoadingDialog };\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(Redirect));\n","import React, { useEffect } from \"react\";\nimport { Route, Switch, HashRouter } from \"react-router-dom\";\nimport Manager from \"../pages/manager\";\nimport HtmlReader from \"../pages/htmlReader\";\nimport DjvuReader from \"../pages/djvuReader\";\nimport PDFReader from \"../pages/pdfReader\";\nimport _Redirect from \"../pages/redirect\";\nimport i18n from \"../i18n\";\nimport StorageUtil from \"../utils/serviceUtils/storageUtil\";\n\nconst Router = () => {\n  useEffect(() => {\n    const lng = StorageUtil.getReaderConfig(\"lang\");\n    if (lng) {\n      i18n.changeLanguage(lng);\n    } else {\n      if (navigator.language === \"zh-CN\" || navigator.language === \"zh-SG\") {\n        i18n.changeLanguage(\"zh\");\n      } else if (\n        navigator.language === \"zh-TW\" ||\n        navigator.language === \"zh-HK\"\n      ) {\n        i18n.changeLanguage(\"cht\");\n      } else if (navigator.language.startsWith(\"ro\")) {\n        i18n.changeLanguage(\"ro\");\n      } else if (navigator.language.startsWith(\"ru\")) {\n        i18n.changeLanguage(\"ru\");\n      } else if (navigator.language.startsWith(\"jp\")) {\n        i18n.changeLanguage(\"jp\");\n      } else if (navigator.language.startsWith(\"fr\")) {\n        i18n.changeLanguage(\"fr\");\n      } else if (navigator.language.startsWith(\"es\")) {\n        i18n.changeLanguage(\"es\");\n      } else if (navigator.language.startsWith(\"pt\")) {\n        i18n.changeLanguage(\"ptBR\");\n      } else if (navigator.language.startsWith(\"fa\")) {\n        i18n.changeLanguage(\"fa\");\n      } else if (navigator.language.startsWith(\"cs\")) {\n        i18n.changeLanguage(\"cs\");\n      } else if (navigator.language.startsWith(\"de\")) {\n        i18n.changeLanguage(\"de\");\n      } else if (navigator.language.startsWith(\"pl\")) {\n        i18n.changeLanguage(\"pl\");\n      } else {\n        i18n.changeLanguage(\"en\");\n      }\n    }\n  }, []);\n  return (\n    <HashRouter>\n      <Switch>\n        <Route component={Manager} path=\"/manager\" />\n        <Route component={DjvuReader} path=\"/djvu\" />\n        <Route component={HtmlReader} path=\"/epub\" />\n        <Route component={HtmlReader} path=\"/mobi\" />\n        <Route component={HtmlReader} path=\"/cbr\" />\n        <Route component={HtmlReader} path=\"/cbt\" />\n        <Route component={HtmlReader} path=\"/cbz\" />\n        <Route component={HtmlReader} path=\"/azw3\" />\n        <Route component={HtmlReader} path=\"/txt\" />\n        <Route component={HtmlReader} path=\"/docx\" />\n        <Route component={HtmlReader} path=\"/md\" />\n        <Route component={HtmlReader} path=\"/rtf\" />\n        <Route component={HtmlReader} path=\"/fb2\" />\n        <Route component={HtmlReader} path=\"/html\" />\n        <Route component={HtmlReader} path=\"/htm\" />\n        <Route component={HtmlReader} path=\"/xml\" />\n        <Route component={HtmlReader} path=\"/xhtml\" />\n        <Route component={HtmlReader} path=\"/href\" />\n        <Route component={PDFReader} path=\"/pdf\" />\n        <Route component={_Redirect} path=\"/\" />\n      </Switch>\n    </HashRouter>\n  );\n};\n\nexport default Router;\n","import GA from \"electron-google-analytics\";\nimport * as pkg from \"../../../package.json\";\n\nconst isDevelopment = process.env.NODE_ENV === \"development\";\n\ninterface EvOptions {\n  evLabel?: any;\n  evValue?: any;\n}\n\nconst hostname = \"https://reader.960960.xyz\";\n\nclass Analytics {\n  private readonly ga: any;\n\n  private clientId: any;\n\n  constructor() {\n    this.ga = new GA(\"G-LW49EYTQWY\", { debug: isDevelopment });\n\n    this.ga.set(\"version\", (pkg as any).version);\n  }\n\n  public getClientId(callback: any) {\n    if (this.clientId) {\n      callback(this.clientId);\n    }\n    var macaddress = window.require(\"macaddress\");\n    macaddress.one((err: any, mac: string) => {\n      this.clientId = mac;\n      callback(mac);\n    });\n  }\n\n  public async pageView(url: string, title?: string) {\n    this.getClientId(async (clientId: any) => {\n      try {\n        await this.ga.pageview(hostname, url, title, 1, clientId);\n      } catch (e) {\n        console.log(e);\n      }\n    });\n  }\n\n  public async event(evCategory: string, evAction: string, options: EvOptions) {\n    this.getClientId(async (clientId: any) => {\n      try {\n        await this.ga.event(evCategory, evAction, {\n          ...options,\n          clientID: clientId,\n        });\n      } catch (e) {\n        console.log(e);\n      }\n    });\n  }\n\n  public async exception(exDesc: string, exFatal: any) {\n    this.getClientId(async (clientId: any) => {\n      try {\n        await this.ga.exception(exDesc, exFatal);\n      } catch (e) {\n        console.log(e);\n      }\n    });\n  }\n  public removeScript() {\n    let elem = document.getElementById(\"analytic\");\n    if (!elem || !elem.parentNode) return;\n    elem.parentNode.removeChild(elem);\n  }\n}\n\nexport default new Analytics();\n","import { isElectron } from \"react-device-detect\";\nimport StorageUtil from \"./storageUtil\";\n\nexport const initTheme = () => {\n  const style = document.createElement(\"link\");\n  style.rel = \"stylesheet\";\n  let isNight = false;\n  if (isElectron) {\n    const { ipcRenderer } = window.require(\"electron\");\n    isNight = ipcRenderer.sendSync(\"system-color\");\n  } else {\n    isNight =\n      window.matchMedia &&\n      window.matchMedia(\"(prefers-color-scheme: dark)\").matches;\n  }\n  StorageUtil.setReaderConfig(\"isOpenInMain\", \"yes\");\n  StorageUtil.setReaderConfig(\"isDisableAnalytics\", \"yes\");\n  StorageUtil.setReaderConfig(\"isOSNight\", isNight ? \"yes\" : \"no\");\n  if (!StorageUtil.getReaderConfig(\"appSkin\")) {\n    StorageUtil.setReaderConfig(\"appSkin\", \"system\");\n  }\n  if (\n    StorageUtil.getReaderConfig(\"appSkin\") === \"night\" ||\n    (StorageUtil.getReaderConfig(\"appSkin\") === \"system\" &&\n      StorageUtil.getReaderConfig(\"isOSNight\") === \"yes\")\n  ) {\n    style.href = \"./assets/styles/dark.css\";\n  } else {\n    style.href = \"./assets/styles/default.css\";\n  }\n  document.head.appendChild(style);\n};\nexport const initSystemFont = () => {\n  if (StorageUtil.getReaderConfig(\"systemFont\")) {\n    let body = document.getElementsByTagName(\"body\")[0];\n    body.setAttribute(\n      \"style\",\n      \"font-family:\" + StorageUtil.getReaderConfig(\"systemFont\") + \"!important\"\n    );\n  }\n};\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./assets/styles/reset.css\";\nimport \"./assets/styles/global.css\";\nimport \"./assets/styles/style.css\";\nimport \"react-tippy/dist/tippy.css\";\nimport { Provider } from \"react-redux\";\nimport \"./i18n\";\nimport store from \"./store\";\nimport Router from \"./router/index\";\nimport StyleUtil from \"./utils/readUtils/styleUtil\";\nimport { isElectron } from \"react-device-detect\";\nimport { dropdownList } from \"./constants/dropdownList\";\nimport StorageUtil from \"./utils/serviceUtils/storageUtil\";\nimport ga from \"./utils/serviceUtils/analytics\";\nimport { initSystemFont, initTheme } from \"./utils/serviceUtils/launchUtil\";\ninitTheme();\ninitSystemFont();\nReactDOM.render(\n  <Provider store={store}>\n    <Router />\n  </Provider>,\n  document.getElementById(\"root\")\n);\n\nif (isElectron && StorageUtil.getReaderConfig(\"isDisableAnalytics\") !== \"yes\") {\n  ga.event(\"Client\", \"show\", {\n    evLabel: \"startup\",\n  });\n} else if (StorageUtil.getReaderConfig(\"isDisableAnalytics\") === \"yes\") {\n  ga.removeScript();\n}\nif (isElectron) {\n  const fontList = window.require(\"font-list\");\n  fontList.getFonts({ disableQuoting: true }).then((result) => {\n    if (!result || result.length === 0) return;\n    dropdownList[0].option = result;\n    dropdownList[0].option.push(\"Built-in font\");\n  });\n}\nStyleUtil.applyTheme();\n","import { unzipBook, unzipConfig } from \"./common\";\n\nexport const restore = (file: File, isSync = false) => {\n  return new Promise<boolean>(async (resolve, reject) => {\n    const fs = window.require(\"fs\");\n    const path = window.require(\"path\");\n    const AdmZip = window.require(\"adm-zip\");\n    const dataPath = localStorage.getItem(\"storageLocation\")\n      ? localStorage.getItem(\"storageLocation\")\n      : window\n          .require(\"electron\")\n          .ipcRenderer.sendSync(\"storage-location\", \"ping\");\n    var reader = new FileReader();\n    reader.readAsArrayBuffer(file);\n    reader.onload = async (event) => {\n      if (!event.target) return;\n      if (!fs.existsSync(path.join(dataPath))) {\n        fs.mkdirSync(path.join(dataPath));\n      }\n      fs.writeFileSync(\n        path.join(dataPath, file.name),\n        Buffer.from(event.target.result as any)\n      );\n      var zip = new AdmZip(path.join(dataPath, file.name));\n      var zipEntries = zip.getEntries(); // an array of ZipEntry records\n      let result = await unzipConfig(zipEntries);\n      if (result) {\n        if (isSync) {\n          resolve(true);\n        } else {\n          let res = await unzipBook(zipEntries);\n          if (res) {\n            resolve(true);\n          } else {\n            resolve(false);\n          }\n        }\n      } else {\n        resolve(false);\n      }\n      const fs_extra = window.require(\"fs-extra\");\n      fs_extra.remove(path.join(dataPath, file.name), (err) => {\n        if (err) throw err;\n      });\n    };\n  });\n};\n","import { getIframeDoc } from \"../serviceUtils/docUtil\";\nimport StorageUtil from \"../serviceUtils/storageUtil\";\n\nclass styleUtil {\n  // 为 iframe 添加默认的样式\n  static addDefaultCss() {\n    let doc = getIframeDoc();\n    if (!doc) return;\n\n    let css = this.getDefaultCss();\n    let background = document.querySelector(\".viewer\");\n    if (!background) return;\n    background.setAttribute(\n      \"style\",\n      `background-color:${\n        StorageUtil.getReaderConfig(\"isMergeWord\") === \"yes\"\n          ? \"rgba(0,0,0,0)\"\n          : StorageUtil.getReaderConfig(\"backgroundColor\") ||\n            \"rgba(255,255,255,1)\"\n      };filter: brightness(${\n        StorageUtil.getReaderConfig(\"brightness\") || 1\n      }) invert(${StorageUtil.getReaderConfig(\"isInvert\") === \"yes\" ? 1 : 0})`\n    );\n    if (!doc.head) {\n      return;\n    }\n\n    let style = doc.createElement(\"style\");\n    style.id = \"default-style\";\n    style.textContent = css;\n    doc.head.appendChild(style);\n  }\n  // 获取为文档默认应用的css样式\n  static getDefaultCss() {\n    let colors = [\"#FBF1D1\", \"#EFEEB0\", \"#CAEFC9\", \"#76BEE9\"];\n    let lines = [\"#FF0000\", \"#000080\", \"#0000FF\", \"#2EFF2E\"];\n\n    return `::selection{background:#f3a6a68c}::-moz-selection{background:#f3a6a68c}[class*=color-]:hover{cursor:pointer;background-image:linear-gradient(0,rgba(0,0,0,.075),rgba(0,0,0,.075))}.color-0{background-color:${colors[0]}}.color-1{background-color:${colors[1]}}.color-2{background-color:${colors[2]}}.color-3{background-color:${colors[3]}}.line-0{border-bottom:2px solid ${lines[0]}}.line-1{border-bottom:2px solid ${lines[1]}}.line-2{border-bottom:2px solid ${lines[2]}}.line-3{border-bottom:2px solid ${lines[3]}}}img{max-width:100% !important}`;\n  }\n  static getCustomCss(isJSON: boolean = true, isScroll: boolean = false) {\n    if (isJSON) {\n      return `font-size: ${\n        StorageUtil.getReaderConfig(\"fontSize\") || 17\n      }px !important;line-height: ${\n        StorageUtil.getReaderConfig(\"lineHeight\") || \"1.25\"\n      } !important;font-family: ${\n        StorageUtil.getReaderConfig(\"fontFamily\") || \"\"\n      } !important;background-color: transparent;color: ${\n        StorageUtil.getReaderConfig(\"textColor\")\n          ? StorageUtil.getReaderConfig(\"textColor\")\n          : StorageUtil.getReaderConfig(\"backgroundColor\") ===\n              \"rgba(44,47,49,1)\" ||\n            StorageUtil.getReaderConfig(\"appSkin\") === \"night\" ||\n            (StorageUtil.getReaderConfig(\"appSkin\") === \"system\" &&\n              StorageUtil.getReaderConfig(\"isOSNight\") === \"yes\")\n          ? \"white\"\n          : \"\"\n      } !important;letter-spacing: ${\n        StorageUtil.getReaderConfig(\"letterSpacing\")\n          ? StorageUtil.getReaderConfig(\"letterSpacing\")\n          : \"\"\n      }px !important;text-align: ${\n        StorageUtil.getReaderConfig(\"textAlign\")\n          ? StorageUtil.getReaderConfig(\"textAlign\")\n          : \"\"\n      } !important;\n      font-weight: ${\n        StorageUtil.getReaderConfig(\"isBold\") === \"yes\" ? \"bold !important\" : \"\"\n      };font-style: ${\n        StorageUtil.getReaderConfig(\"isItalic\") === \"yes\"\n          ? \"italic !important\"\n          : \"\"\n      };text-shadow: ${\n        StorageUtil.getReaderConfig(\"isShadow\") === \"yes\"\n          ? \"2px 2px 2px #cccccc !important\"\n          : \"\"\n      };text-indent: ${\n        StorageUtil.getReaderConfig(\"isIndent\") === \"yes\" ? \"2rem\" : \"\"\n      };text-decoration: ${\n        StorageUtil.getReaderConfig(\"isUnderline\") === \"yes\"\n          ? \"underline !important\"\n          : \"\"\n      };margin-bottom: ${\n        StorageUtil.getReaderConfig(\"paraSpacing\") || 0\n      }px !important;padding:0px !important;word-wrap: break-word;`;\n    } else {\n      return {\n        \"a, article, cite, code, div, li, p, pre, span, table, body\": {\n          \"font-size\": `${\n            StorageUtil.getReaderConfig(\"fontSize\") || 17\n          }px !important`,\n          \"line-height\": `${\n            StorageUtil.getReaderConfig(\"lineHeight\") || \"1.25\"\n          } !important`,\n          \"font-family\": `${\n            StorageUtil.getReaderConfig(\"fontFamily\") || \"\"\n          } !important`,\n          \"background-color\": \"transparent\",\n          color: `${\n            StorageUtil.getReaderConfig(\"textColor\")\n              ? StorageUtil.getReaderConfig(\"textColor\")\n              : StorageUtil.getReaderConfig(\"backgroundColor\") ===\n                  \"rgba(44,47,49,1)\" ||\n                StorageUtil.getReaderConfig(\"appSkin\") === \"night\" ||\n                (StorageUtil.getReaderConfig(\"appSkin\") === \"system\" &&\n                  StorageUtil.getReaderConfig(\"isOSNight\") === \"yes\")\n              ? \"white\"\n              : \"\"\n          } !important`,\n          \"letter-spacing\": `${\n            StorageUtil.getReaderConfig(\"letterSpacing\")\n              ? `${StorageUtil.getReaderConfig(\"letterSpacing\")}px`\n              : \"\"\n          } !important`,\n          \"text-align\": `${\n            StorageUtil.getReaderConfig(\"textAlign\")\n              ? `${StorageUtil.getReaderConfig(\"textAlign\")}`\n              : \"\"\n          } !important`,\n          \"font-weight\": `${\n            StorageUtil.getReaderConfig(\"isBold\") === \"yes\"\n              ? \"bold !important\"\n              : \"\"\n          }`,\n          \"text-indent\": `${\n            StorageUtil.getReaderConfig(\"isIndent\") === \"yes\" ? \"2rem\" : \"\"\n          }`,\n          \"font-style\": `${\n            StorageUtil.getReaderConfig(\"isItalic\") === \"yes\"\n              ? \"italic !important\"\n              : \"\"\n          }`,\n          \"text-shadow\": `${\n            StorageUtil.getReaderConfig(\"isShadow\") === \"yes\"\n              ? \"2px 2px 2px #cccccc !important\"\n              : \"\"\n          }`,\n          \"text-decoration\": `${\n            StorageUtil.getReaderConfig(\"isUnderline\") === \"yes\"\n              ? \"underline !important\"\n              : \"\"\n          }`,\n          \"margin-bottom\": `${\n            StorageUtil.getReaderConfig(\"paraSpacing\") || 0\n          }px !important; word-wrap: break-word;`,\n        },\n        body: {\n          padding: isScroll ? \"0px 8px !important\" : \"0px !important\",\n        },\n      };\n    }\n  }\n  static addStyle = (url: string) => {\n    const style = document.createElement(\"link\");\n    style.href = url;\n    style.rel = \"stylesheet\";\n    document.head.appendChild(style);\n  };\n\n  static applyTheme() {\n    StorageUtil.getReaderConfig(\"themeColor\") &&\n      StorageUtil.getReaderConfig(\"themeColor\") !== \"default\" &&\n      this.addStyle(\n        \"./assets/styles/\" + StorageUtil.getReaderConfig(\"themeColor\") + \".css\"\n      );\n  }\n}\n\nexport default styleUtil;\n","class TagUtil {\n  static setTags(tagName: string) {\n    let tagArr =\n      localStorage.getItem(\"noteTags\") !== \"{}\" &&\n      localStorage.getItem(\"noteTags\")\n        ? JSON.parse(localStorage.getItem(\"noteTags\") || \"\")\n        : [];\n    const index = tagArr.indexOf(tagName);\n    if (index > -1) {\n      tagArr.splice(index, 1);\n      tagArr.unshift(tagName);\n    } else {\n      tagArr.unshift(tagName);\n    }\n\n    localStorage.setItem(\"noteTags\", JSON.stringify(tagArr));\n  }\n\n  static clear(tagName: string) {\n    let tagArr =\n      localStorage.getItem(\"noteTags\") !== \"{}\" &&\n      localStorage.getItem(\"noteTags\")\n        ? JSON.parse(localStorage.getItem(\"noteTags\") || \"\")\n        : [];\n    const index = tagArr.indexOf(tagName);\n    if (index > -1) {\n      tagArr.splice(index, 1);\n    }\n    localStorage.setItem(\"noteTags\", JSON.stringify(tagArr));\n  }\n  static getAllTags() {\n    let tagArr =\n      localStorage.getItem(\"noteTags\") !== \"{}\" &&\n      localStorage.getItem(\"noteTags\")\n        ? JSON.parse(localStorage.getItem(\"noteTags\") || \"\")\n        : [];\n    return tagArr || [];\n  }\n}\n\nexport default TagUtil;\n","//笔记书摘的标签\nimport React from \"react\";\nimport \"./noteTag.css\";\nimport { NoteTagProps, NoteTagState } from \"./interface\";\nimport TagUtil from \"../../utils/readUtils/tagUtil\";\nimport DeleteIcon from \"../deleteIcon\";\nimport { Trans } from \"react-i18next\";\n\nclass NoteTag extends React.Component<NoteTagProps, NoteTagState> {\n  constructor(props: NoteTagProps) {\n    super(props);\n    this.state = {\n      tagIndex: [],\n      isInput: false,\n      deleteIndex: -1,\n      isShowTags: false,\n    };\n  }\n  componentDidMount() {\n    if (this.props.isReading) {\n      this.setState({ tagIndex: this.tagToIndex(this.props.tag) });\n    }\n  }\n  UNSAFE_componentWillReceiveProps(nextProps: NoteTagProps) {\n    if (\n      this.props.isReading &&\n      nextProps.tag &&\n      nextProps.tag.length > 0 &&\n      this.props.tag !== nextProps.tag\n    ) {\n      this.setState({ tagIndex: this.tagToIndex(nextProps.tag) });\n    }\n  }\n  tagToIndex = (tag: string[]) => {\n    let temp: number[] = [];\n    if (!tag) return [];\n    for (let i = 0; i < TagUtil.getAllTags().length; i++) {\n      if (tag.indexOf(TagUtil.getAllTags()[i]) > -1) {\n        temp.push(i);\n      }\n    }\n    return temp;\n  };\n  indextoTag = (tagIndex: number[]) => {\n    let temp: any = [];\n    for (let i = 0; i < tagIndex.length; i++) {\n      temp.push(TagUtil.getAllTags()[tagIndex[i]]);\n    }\n    return temp;\n  };\n  handleChangeTag = (index: number) => {\n    let temp: number[] = [...this.state.tagIndex];\n    if (this.state.tagIndex.indexOf(index) > -1) {\n      temp = [...this.state.tagIndex];\n      let indexResult = temp.indexOf(index);\n      temp.splice(indexResult, 1);\n      this.setState({ tagIndex: temp });\n      this.props.handleTag(this.indextoTag(temp));\n    } else {\n      temp.push(index);\n      this.setState({ tagIndex: temp });\n      this.props.handleTag(this.indextoTag(temp));\n    }\n  };\n  handleAddTag = (event: any) => {\n    this.setState({ isInput: false });\n    if (!event.target.value) {\n      return;\n    }\n    TagUtil.setTags(event.target.value);\n    this.setState({ tagIndex: [] });\n    this.props.handleTag(this.indextoTag([]));\n  };\n  handleInput = () => {\n    this.setState({ isInput: true }, () => {\n      document.getElementById(\"newTag\")?.focus();\n    });\n  };\n  handleShowTags = (bool: boolean) => {\n    this.setState({ isShowTags: bool }, () => {\n      if (document.querySelector(\".card-list-container\")) {\n        (document.querySelector(\".card-list-container\") as any)?.setAttribute(\n          \"style\",\n          `height:calc(100% - ${\n            (document.querySelector(\".card-list-container\") as any)?.offsetTop\n          }px)`\n        );\n      }\n    });\n  };\n  render() {\n    const renderTag = () => {\n      let noteTags = this.props.isCard ? this.props.tag : TagUtil.getAllTags();\n      return noteTags.map((item: any, index: number) => {\n        return (\n          <li\n            key={item}\n            className={\n              this.state.tagIndex.indexOf(index) > -1 && !this.props.isCard\n                ? \"tag-list-item active-tag \"\n                : \"tag-list-item\"\n            }\n          >\n            <div className=\"delete-tag-container\">\n              {this.state.tagIndex.indexOf(index) > -1 &&\n              !this.props.isReading &&\n              !this.props.isCard ? (\n                <DeleteIcon\n                  {...{\n                    tagName: item,\n                    mode: \"tags\",\n                    index: index,\n                    handleChangeTag: this.handleChangeTag,\n                  }}\n                />\n              ) : null}\n            </div>\n            <div\n              className=\"center\"\n              onClick={() => {\n                this.handleChangeTag(index);\n              }}\n            >\n              <Trans>{item}</Trans>\n            </div>\n          </li>\n        );\n      });\n    };\n    return (\n      <div\n        className=\"note-tag-container\"\n        style={this.props.isReading ? { width: \"1999px\" } : {}}\n      >\n        {this.props.isReading || this.props.isCard ? null : (\n          <div className=\"tag-title\">\n            <Trans>All Tags</Trans>\n            <span\n              className=\"icon-dropdown tag-dropdown-icon\"\n              onClick={() => {\n                this.handleShowTags(!this.state.isShowTags);\n              }}\n              style={\n                !this.state.isShowTags ? {} : { transform: \"rotate(-90deg)\" }\n              }\n            ></span>\n          </div>\n        )}\n\n        {(this.state.isShowTags ||\n          this.props.isReading ||\n          this.props.isCard) && (\n          <ul className=\"tag-container\">\n            {!this.props.isCard && (\n              <li\n                className=\"tag-list-item-new\"\n                onClick={() => {\n                  this.handleInput();\n                }}\n                style={this.state.isInput ? { width: \"80px\" } : {}}\n              >\n                <div className=\"center\">\n                  {this.state.isInput ? (\n                    <input\n                      type=\"text\"\n                      name=\"newTag\"\n                      id=\"newTag\"\n                      onBlur={(event) => {\n                        this.handleAddTag(event);\n                      }}\n                    />\n                  ) : (\n                    <span className=\"icon-add\"></span>\n                  )}\n                </div>\n              </li>\n            )}\n            {renderTag()}\n          </ul>\n        )}\n      </div>\n    );\n  }\n}\nexport default NoteTag;\n","import { connect } from \"react-redux\";\nimport { handleSearchResults, handleSearch } from \"../../store/actions\";\nimport { stateType } from \"../../store\";\nimport { withTranslation } from \"react-i18next\";\nimport NoteTag from \"./component\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    isReading: state.book.isReading,\n    noteKey: state.reader.noteKey,\n  };\n};\nconst actionCreator = {\n  handleSearchResults,\n  handleSearch,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(NoteTag as any));\n","class ReadingTime {\n  static setTime(bookKey: string, time: number) {\n    let json = localStorage.getItem(\"readingTime\");\n    let obj = JSON.parse(json!) || {};\n    obj[bookKey] = time;\n    localStorage.setItem(\"readingTime\", JSON.stringify(obj));\n  }\n\n  static getTime(bookKey: string) {\n    let json = localStorage.getItem(\"readingTime\");\n    let obj = JSON.parse(json!) || {};\n    return obj[bookKey] || 0;\n  }\n  static getAllTime() {\n    let json = localStorage.getItem(\"readingTime\");\n    let obj = JSON.parse(json!) || {};\n    return obj || [];\n  }\n  static clearTime(bookKey: string) {\n    let json = localStorage.getItem(\"readingTime\");\n    let obj = JSON.parse(json!) || {};\n    delete obj[bookKey];\n    localStorage.setItem(\"readingTime\", JSON.stringify(obj));\n  }\n}\n\nexport default ReadingTime;\n","declare var window: any;\nvar pdfjsLib = window[\"pdfjs-dist/build/pdf\"];\nexport const getHightlightCoords = () => {\n  let pageArea = document.getElementById(\"page-area\");\n  if (!pageArea) return;\n  let iframe = pageArea.getElementsByTagName(\"iframe\")[0];\n  if (!iframe) return;\n  let iWin: any = iframe.contentWindow || iframe.contentDocument?.defaultView;\n  var pageIndex = iWin!.PDFViewerApplication.pdfViewer.currentPageNumber - 1;\n  var page = iWin!.PDFViewerApplication.pdfViewer.getPageView(pageIndex);\n  var pageRect = page.canvas.getClientRects()[0];\n  var selectionRects = iWin.getSelection()!.getRangeAt(0).getClientRects();\n  var viewport = page.viewport;\n  let tempRect: { bottom: number; top: number; left: number; right: number }[] =\n    [];\n  for (let i = 0; i < selectionRects.length; i++) {\n    if (i === 0) {\n      tempRect.push({\n        bottom: selectionRects[i].bottom,\n        top: selectionRects[i].top,\n        left: selectionRects[i].left,\n        right: selectionRects[i].right,\n      });\n    } else if (\n      Math.abs(\n        tempRect[tempRect.length - 1].bottom - selectionRects[i].bottom\n      ) < 5\n    ) {\n      if (tempRect[tempRect.length - 1].left > selectionRects[i].left) {\n        tempRect[tempRect.length - 1].left = selectionRects[i].left;\n      }\n      if (tempRect[tempRect.length - 1].right < selectionRects[i].right) {\n        tempRect[tempRect.length - 1].right = selectionRects[i].right;\n      }\n    } else {\n      tempRect.push({\n        bottom: selectionRects[i].bottom,\n        top: selectionRects[i].top,\n        left: selectionRects[i].left,\n        right: selectionRects[i].right,\n      });\n    }\n  }\n  var selected = tempRect.map(function (r: any) {\n    return viewport\n      .convertToPdfPoint(r.left - pageRect.x, r.top - pageRect.y)\n      .concat(\n        viewport.convertToPdfPoint(r.right - pageRect.x, r.bottom - pageRect.y)\n      );\n  });\n  return { page: pageIndex, coords: selected };\n};\nexport const getPDFCover = (file: ArrayBuffer) => {\n  return new Promise<string>((resolve, reject) => {\n    let fileSize = file.byteLength / 1024 / 1024;\n    setTimeout(() => {\n      resolve(\"\");\n    }, Math.ceil(fileSize / 10) * 1000);\n    pdfjsLib\n      .getDocument({ data: file })\n      .promise.then((pdfDoc: any) => {\n        pdfDoc.getPage(1).then((page: any) => {\n          var scale = 1.5;\n          var viewport = page.getViewport({\n            scale: scale,\n          });\n          var canvas: any = document.getElementById(\"the-canvas\");\n          var context = canvas.getContext(\"2d\");\n          canvas.height =\n            viewport.height || viewport.viewBox[3]; /* viewport.height is NaN */\n          canvas.width =\n            viewport.width ||\n            viewport.viewBox[2]; /* viewport.width is also NaN */\n          var task = page.render({\n            canvasContext: context,\n            viewport: viewport,\n          });\n          task.promise.then(async () => {\n            let cover: any = canvas.toDataURL(\"image/jpeg\");\n\n            resolve(cover);\n          });\n        });\n      })\n      .catch((err: any) => {\n        resolve(\"\");\n      });\n  });\n};\n","import React from \"react\";\nimport \"./deleteIcon.css\";\nimport { DeleteIconProps, DeleteIconStates } from \"./interface\";\nimport localforage from \"localforage\";\nimport TagUtil from \"../../utils/readUtils/tagUtil\";\nimport DeletePopup from \"../dialogs/deletePopup\";\nimport toast from \"react-hot-toast\";\nclass DeleteIcon extends React.Component<DeleteIconProps, DeleteIconStates> {\n  constructor(props: DeleteIconProps) {\n    super(props);\n    this.state = {\n      deleteIndex: -1,\n      isOpenDelete: false,\n    };\n  }\n\n  handleDelete = () => {\n    let deleteItems =\n      this.props.mode === \"notes\"\n        ? this.props.notes\n        : this.props.mode === \"tags\"\n        ? TagUtil.getAllTags()\n        : this.props.bookmarks;\n    let deleteFunc =\n      this.props.mode === \"notes\"\n        ? this.props.handleFetchNotes\n        : this.props.handleFetchBookmarks;\n    deleteItems.forEach((item: any, index: number) => {\n      if (this.props.mode === \"tags\") {\n        item === this.props.tagName && TagUtil.clear(item);\n        return;\n      }\n      if (item.key === this.props.itemKey) {\n        deleteItems.splice(index, 1);\n        if (deleteItems.length === 0) {\n          localforage\n            .removeItem(this.props.mode)\n            .then(() => {\n              deleteFunc();\n              toast.success(this.props.t(\"Delete Successfully\"));\n            })\n            .catch(() => {\n              console.log(\"删除失败\");\n            });\n        } else {\n          localforage\n            .setItem(this.props.mode, deleteItems)\n            .then(() => {\n              deleteFunc();\n              toast.success(this.props.t(\"Delete Successfully\"));\n            })\n            .catch(() => {\n              console.log(\"修改失败\");\n            });\n        }\n      }\n    });\n  };\n  handleDeletePopup = (isOpenDelete: boolean) => {\n    this.setState({ isOpenDelete });\n    if (!isOpenDelete) {\n      this.props.handleChangeTag(this.props.index);\n    }\n  };\n  render() {\n    const deletePopupProps = {\n      name: this.props.tagName,\n      title: \"Delete this tag\",\n      description: \"This action will clear and remove this tag\",\n      handleDeletePopup: this.handleDeletePopup,\n      handleDeleteOpearion: this.handleDelete,\n    };\n    return (\n      <>\n        {this.state.isOpenDelete && <DeletePopup {...deletePopupProps} />}\n        <div\n          className=\"delete-digest-button\"\n          onClick={() => {\n            this.props.mode === \"tags\"\n              ? this.handleDeletePopup(true)\n              : this.handleDelete();\n          }}\n        >\n          <span className=\"icon-close delete-digest-icon\"></span>\n        </div>\n      </>\n    );\n  }\n}\n\nexport default DeleteIcon;\n","import { connect } from \"react-redux\";\nimport { stateType } from \"../../store\";\nimport {\n  handleFetchBookmarks,\n  handleFetchNotes,\n  handleShowBookmark,\n} from \"../../store/actions\";\nimport DeleteIcon from \"./component\";\nimport { withTranslation } from \"react-i18next\";\nconst mapStateToProps = (state: stateType) => {\n  return {\n    digests: state.reader.digests,\n    bookmarks: state.reader.bookmarks,\n    notes: state.reader.notes,\n    isReading: state.book.isReading,\n  };\n};\nconst actionCreator = {\n  handleFetchBookmarks,\n  handleFetchNotes,\n  handleShowBookmark,\n};\nexport default connect(\n  mapStateToProps,\n  actionCreator\n)(withTranslation()(DeleteIcon as any) as any);\n"],"sourceRoot":""}